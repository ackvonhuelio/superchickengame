<!DOCTYPE html>
<!--Credit to vexcess for pjs in html script which i copied -->
<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <title>Super Chicken Game</title>
        <style>
            :root {
                --background-color: #000000;
            }

            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0px;
                padding: 0px;
                background-color: var(--background-color);
                display: flex;
                justify-content: center;
                align-items: center;
            }

            #wrapper {
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            canvas {
                position: absolute;
                transform-origin: center;
            }
        </style>
    </head>
    <body id="wrapper">
    <!-- jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <!-- jQuery plugin file -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.1/jquery.timeago.min.js"></script>
    <script id="PJS_code" type="data" data-width="600" data-height="600">

//jshint ignore: start


/*

        TODO

    nada


*/

// decrease if loading crashes
var loadPerFrameGrass = 6;
var loadPerFrameChicken = 1;
// remove grass
var trueDelag = !true;
var delag = trueDelag;
// remove a lot of lerping
var delag2 = false;
// remove arc calculations
var delag3 = false;
// remove animated graphics
var delag4 = false;
// set number of frames in grass animation (max 360)
// (higher = more loading time)
var numGrassFrames = 90;

// default 0.14 (no effect if delag2 is turned on)
var physicsLerpSpeed = 0.14;


var tierTest = false;
var clicked = false;
var held = false;
var notHeldCount = 0;
var scene = 'loadAssets';
var speed = 1;
var doAuto = !true;
var saveCode = [];
var loadedCodes = false;
codes = [
    //{
    ["WKoAngmar,0,0,1#|n300,300,~Teacher chicken,0,3,3,~Soldier chicken,0,1,2,~#~Fishy chicken,0,2,2,~#~#|cChicken insurance,1,3,1,71,356,|cChicken insurance,1,3,1,79,272,|cChicken insurance,1,3,1,86,178,","WKoAngmar,0,1,2#|n300,300,~Teacher chicken,1,4,4,~Soldier chicken,3,4,5,~#~Fishy chicken,0,2,4,~#~Blowdart chicken,0,2,2,|cChicken insurance,1,2,1,71,356,|cChicken insurance,1,2,1,79,272,|cChicken insurance,1,2,1,86,178,","WKoAngmar,0,2,3#|n300,300,~Teacher chicken,1,4,6,~Soldier chicken,3,4,5,~Target chicken,1,6,2,~Fishy chicken,0,2,4,~Explosive chicken,0,2,2,~Blowdart chicken,1,3,3,|cChicken insurance,1,4,1,71,356,|cChicken insurance,1,1,1,79,272,|cChicken insurance,1,1,1,86,178,","WKoAngmar,0,2,4#|n300,300,~Teacher chicken,1,4,8,~Soldier chicken,3,4,5,~Target chicken,2,7,3,~Fishy chicken,0,2,4,~Explosive chicken,0,2,2,~Blowdart chicken,2,4,4,|cChicken insurance,1,6,1,51,349,|cChicken insurance,1,6,1,72,265,","WKoAngmar,0,3,5#|n300,300,~Teacher chicken,1,4,8,~Soldier chicken,4,5,6,~Target chicken,2,7,3,~Chicken repairman,2,4,5,~Explosive chicken,1,3,3,~Blowdart chicken,2,4,4,|cChicken insurance,1,5,1,51,349,|cChicken insurance,1,7,1,72,265,","WKoAngmar,1,3,6#|n300,300,~Teacher chicken,1,4,8,~Soldier chicken,5,6,7,~Target chicken,2,10,5,~Chicken repairman,2,4,5,~Explosive chicken,1,3,3,~Blowdart chicken,3,5,8,|cChicken insurance,4,4,1,51,349,|cChicken insurance,4,8,1,108,257,","WKoAngmar,1,3,7#|n252,414,~Spiky chicken,0,6,4,~Punk chicken,1,6,3,~Target chicken,2,10,5,~Pinata chicken,0,5,3,~Nurse chicken,0,5,2,~Blowdart chicken,3,5,8,|n398,200,~#~#~#~Explosive chicken,0,2,2,~#~#|cChicken insurance,4,3,1,74,395,|cChicken insurance,4,7,1,94,293,|cChicken insurance,1,3,1,183,235,","WKoAngmar,1,4,8#|n252,414,~Spiky chicken,1,7,5,~Punk chicken,1,6,3,~Target chicken,2,10,5,~Pinata chicken,0,5,4,~Nurse chicken,0,5,2,~Blowdart chicken,4,9,11,|n398,200,~#~#~#~Explosive chicken,0,2,2,~Soldier chicken,0,1,2,~#|cChicken insurance,4,5,1,74,395,|cChicken insurance,4,9,1,94,293,|cChicken insurance,1,2,1,183,235,","WKoAngmar,2,4,9#|n252,414,~Nurse chicken,0,5,2,~Punk chicken,1,6,3,~Target chicken,2,10,5,~Pinata chicken,1,6,5,~Nurse chicken,0,5,2,~Blowdart chicken,4,10,12,|n398,200,~Monster chicken,0,6,7,~Scientist chicken,0,3,1,~#~Explosive chicken,0,3,4,~Soldier chicken,1,2,3,~Spiky chicken,2,8,6,|cChicken insurance,4,4,1,132,120,|cChicken insurance,4,8,1,134,206,|cChicken insurance,1,1,1,214,163,","WKoAngmar,2,5,10#|n252,414,~Nurse chicken,0,5,2,~Punk chicken,1,6,3,~Target chicken,2,10,5,~Pinata chicken,1,6,5,~Nurse chicken,0,6,3,~Monster chicken,0,7,8,|n398,200,~Blowdart chicken,4,11,13,~Pope chicken,0,7,3,~Imposter chicken,1,3,4,~Explosive chicken,0,4,6,~Soldier chicken,1,2,3,~Spiky chicken,2,9,7,|cChicken insurance,4,3,1,132,120,|cChicken insurance,4,7,1,134,206,|cGenerator,1,4,2,198,249,|cGenerator,1,4,2,207,140,","WKoAngmar,3,5,11#|n252,414,~Nurse chicken,2,8,5,~Punk chicken,1,11,5,~Target chicken,2,10,5,~Pinata chicken,1,6,5,~Fire chicken,0,7,5,~Monster chicken,0,7,8,|n398,200,~Blowdart chicken,4,11,13,~Rocket chicken,1,4,10,~Imposter chicken,1,3,4,~Explosive chicken,1,5,7,~Soldier chicken,1,2,3,~Spiky chicken,2,9,7,|cChicken insurance,4,2,1,132,120,|cChicken insurance,4,6,1,134,206,|cGenerator,1,3,2,198,249,|cGenerator,1,3,2,207,140,","WKoAngmar,3,6,12#|n252,414,~Nurse chicken,2,10,5,~Punk chicken,1,13,5,~Target chicken,2,23,13,~Pinata chicken,1,8,6,~Fire chicken,0,9,5,~Monster chicken,1,10,9,|n398,200,~Blowdart chicken,4,13,13,~Rocket chicken,1,6,10,~Imposter chicken,1,5,4,~Explosive chicken,1,7,7,~Soldier chicken,1,4,3,~Spiky chicken,2,11,7,|cChicken insurance,4,1,1,132,120,|cChicken insurance,4,5,1,134,206,|cGenerator,1,5,2,198,249,|cGenerator,1,5,2,207,140,","WKoAngmar,4,6,13#|n401,383,~Pinata chicken,2,9,7,~Punk chicken,1,13,5,~Target chicken,2,23,13,~Nurse chicken,2,10,5,~Fire chicken,0,9,5,~Monster chicken,1,10,10,|n399,183,~Blowdart chicken,4,13,13,~Rocket chicken,1,6,10,~Imposter chicken,1,5,4,~Explosive chicken,3,9,9,~Soldier chicken,1,4,3,~Spiky chicken,2,11,7,|cChicken insurance,4,4,1,134,206,|cGenerator,4,4,2,198,249,|cGenerator,4,4,2,207,140,","WKoAngmar,4,7,14#|n401,383,~Pinata chicken,4,11,9,~Punk chicken,1,13,5,~Target chicken,2,23,13,~Nurse chicken,2,13,7,~Fire chicken,1,10,7,~Monster chicken,1,10,10,|n399,183,~Blowdart chicken,4,13,13,~Rocket chicken,1,6,10,~Imposter chicken,1,5,4,~Explosive chicken,3,9,9,~Soldier chicken,1,4,3,~Spiky chicken,2,11,7,|cChicken insurance,4,3,1,134,206,|cGenerator,4,3,2,199,241,|cGenerator,4,3,2,207,140,","WKoAngmar,4,8,15#|n401,383,~Monster chicken,1,10,10,~#~#~Thief chicken,0,6,8,~Fire chicken,1,10,7,~#|n399,183,~Blowdart chicken,4,13,13,~Rocket chicken,1,6,10,~Imposter chicken,1,5,4,~Explosive chicken,3,9,9,~Soldier chicken,1,4,3,~Spiky chicken,2,11,7,|n137,392,~General chicken,0,4,4,~Nurse chicken,0,8,6,~Target chicken,2,23,13,~Nurse chicken,2,13,7,~Punk chicken,1,13,5,~Pinata chicken,4,11,9,|cChicken insurance,4,2,1,94,186,|cWindmill,4,3,2,180,172,","WKoAngmar,4,9,16#|n401,383,~Monster chicken,1,10,10,~#~#~Thief chicken,0,5,8,~Fire chicken,1,10,7,~General chicken,0,4,4,|n399,183,~Blowdart chicken,6,21,21,~Rocket chicken,1,6,10,~Imposter chicken,1,5,4,~Explosive chicken,4,13,13,~Soldier chicken,1,4,3,~Spiky chicken,3,15,11,|n137,392,~Lava chicken,0,9,9,~Nurse chicken,0,7,5,~Target chicken,2,23,13,~Nurse chicken,2,13,7,~Punk chicken,1,13,5,~Pinata chicken,4,11,9,|cChicken insurance,7,1,1,94,186,|cWindmill,4,2,2,180,172,","WKoAngmar,4,10,17#|n401,383,~Monster chicken,1,10,10,~#~#~Thief chicken,0,5,8,~Fire chicken,1,10,7,~General chicken,1,5,5,|n399,183,~Blowdart chicken,6,19,19,~Rocket chicken,1,6,11,~Imposter chicken,1,5,4,~Explosive chicken,6,20,20,~Soldier chicken,1,4,3,~Spiky chicken,3,14,10,|n137,392,~Lava chicken,0,8,8,~Nurse chicken,0,7,5,~Target chicken,3,27,17,~Nurse chicken,2,13,7,~Punk chicken,1,13,5,~Pinata chicken,4,11,9,|cWindmill,4,1,2,180,172,","WKoAngmar,4,11,18#|n401,383,~Monster chicken,1,10,10,~#~Fire chicken,1,10,7,~Thief chicken,0,5,8,~Nurse chicken,0,7,5,~Lava chicken,0,8,8,|n399,183,~Blowdart chicken,7,23,23,~Rocket chicken,1,6,12,~Imposter chicken,2,9,8,~Explosive chicken,6,18,18,~Soldier chicken,1,4,3,~Spiky chicken,3,14,10,|n137,392,~Robo chicken,0,7,7,~General chicken,1,5,5,~Target chicken,3,26,16,~Nurse chicken,2,13,7,~Punk chicken,2,17,9,~Pinata chicken,5,15,13,","WKoAngmar,4,12,19#|n401,383,~Monster chicken,1,10,10,~Target chicken,3,26,16,~Fire chicken,1,10,7,~Thief chicken,1,9,12,~Nurse chicken,1,11,9,~Lava chicken,0,8,8,|n399,183,~Blowdart chicken,7,22,24,~Rocket chicken,1,6,12,~Imposter chicken,2,8,7,~Explosive chicken,6,18,18,~Soldier chicken,2,8,7,~Spiky chicken,3,14,10,|n137,392,~Robo chicken,1,10,10,~General chicken,1,5,5,~Mage chicken,0,7,6,~Nurse chicken,2,13,7,~Punk chicken,2,16,8,~Pinata chicken,5,14,12,","WKoAngmar,4,13,20#|n401,383,~Monster chicken,1,10,10,~Target chicken,3,26,16,~Fire chicken,3,18,15,~Thief chicken,1,8,11,~Nurse chicken,1,10,8,~Lava chicken,0,8,8,|n399,183,~Blowdart chicken,7,22,24,~Rocket chicken,1,6,12,~Imposter chicken,2,8,7,~Explosive chicken,6,18,20,~Soldier chicken,2,7,6,~Spiky chicken,3,14,10,|n137,392,~Robo chicken,2,13,13,~General chicken,2,6,6,~Mage chicken,0,6,5,~Nurse chicken,2,13,7,~Punk chicken,3,20,12,~Pinata chicken,5,14,12,",],

    //}
    ];
$.getScript("https://cdn.jsdelivr.net/gh/ackvonhuelio/chickenGameCodes/saves.js", 
function() {
loadedCodes = true;
}
);

// give the game the dimensions of the screen
var dim = {x:600,y:600};

// track scrolling to fit dimensions
var dimScroll = {x:0,y:0,tx:0,ty:0,appX:0,appY:0};

// adjusted mouse variables
var msX=0;
var msY=0;
var pmsX=0;
var pmsY=0;

textFont(createFont('monospace'));

// silly memory leak stuff
// {

// var window = (function() { return this; })();
// window.Processing.instances[0].PJSCodeInjector.applyInstance = function (constructor) {
//     return function () {
//         return window.Reflect.construct(constructor, arguments);
//     };
// };

// var window = (function() { return this; })();
// if (Object.keys(window.ASTTransforms.rewriteNewExpressions()).length !== 0) {
//     window.ASTTransforms.rewriteNewExpressions = function() { return {}; };
//     Program.restart();
//     throw null;
// }

  //credit to KWC for this patch of the KA memory leak
    Object.constructor.prototype.create = function () {
        var obj = Object.create(this.prototype);
        this.apply(obj, arguments);
        return obj;
    };

// }


// inputs for literally only name selection (even then not needed)
//{

var TAPPED_TIME = 1;
var pushedKey = false;
function Key() {
  this.pressed = false;
  this.tapped = false;
  //how long key will stay tapped
  this.tappedTime = TAPPED_TIME;
}
Key.prototype.press = function() {
  this.tapped = false;
  if (this.pressed === false) {
    this.tapped = true;
    this.tappedTime = TAPPED_TIME;
  }
  this.pressed = true;

};
Key.prototype.unTap = function() {
  this.tapped = false;
  this.tappedTime = 0;
};
Key.prototype.isTapped = function() {

  if (this.tapped === true) {

    this.tapped = false;
    this.tappedTime = 0;
    return true;
  } else {
    return false;
  }
};
Key.prototype.update = function() {
  this.tappedTime--;
};
var keys = {};

function pressed(e) {
  if (e) {
    if (e.pressed) {
      return true;
    }
  }
}

function tapped(e) {
  if (e) {
    if (e.tapped) {
      return true;
    }
  }
}

//var shiftKey = false;
keyPressed = function() {
  if (!keys[keyCode]) {
    keys[keyCode] = new Key();
  }
  keys[keyCode].press();
  pushedKey = key;
};
keyReleased = function() {
  keys[keyCode].pressed = false;
};

function manageKeys() {

  for (var i in keys) {
    if (keys[i].tapped === true) {

      keys[i].update();
      if (keys[i].tappedTime <= 0) {
        keys[i].tapped = false;
      }
    }

  }

}


//}

function chooseFrom(e){
return e[floor(random(0,e.length))];
}
function dimMouse(){
pmsX=pmouseX-dimScroll.x;
pmsY=pmouseY-dimScroll.y;
msX=mouseX-dimScroll.x;
msY=mouseY-dimScroll.y;
}
function strikeThrough(text) {
var ret = '';
ret += '\u0336';
for(var i = 0; i < text.length; i++){
    ret += text[i];
    ret += '\u0336';
}
return ret;
}
function heart(x,y,s,a){

    pushMatrix();
    translate(x,y);
    scale(s);
    stroke(0,0,0);
    fill(255, 23, 23);
    if(a){
    stroke(0,0,0,a);
    fill(255, 23, 23,a);
    }
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111); curveVertex(0,-86); curveVertex(49,-111); curveVertex(93,-96); curveVertex(100,-30); curveVertex(0,84); curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111);
    endShape();

    popMatrix();
}
function heartBg(x,y,s,a){

    pushMatrix();
    translate(x,y);
    scale(s);
    stroke(0,0,0);
    fill(163, 163, 163);
    if(a){
    stroke(0,0,0,a);
    fill(163, 163, 163,a);
    }
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111); curveVertex(0,-86); curveVertex(49,-111); curveVertex(93,-96); curveVertex(100,-30); curveVertex(0,84); curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111);
    endShape();

    popMatrix();
}
function heartOutline(x,y,s,a){

    pushMatrix();
    translate(x,y);
    scale(s);
    stroke(0,0,0);
    noFill();
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111); curveVertex(0,-86); curveVertex(49,-111); curveVertex(93,-96); curveVertex(100,-30); curveVertex(0,84); curveVertex(-100,-30); curveVertex(-93,-96); curveVertex(-49,-111);
    endShape();

    popMatrix();
}
function heartFill(x,y,s,a,m){

    pushMatrix();
    translate(x,y);
    scale(s,s);
    noStroke();
    fill(255, 23, 23);
    if(a){
    fill(255, 23, 23,a);
    }
    var q = 177-(m*177);
    var q2 = 0;
    var q3 = 0;
    var q4 = 0;
    var q5 = 0;
    if(q >= 15){
    q2 = q-15;
    }
    if(q >= 25){
    q3 = q-25;
    }
    if(q >= 81){
    q4 = q-81;
    q5 = (q-81)*0.6;
    }
    if(q >= 140){
    q5 += (q-140)*0.4;
    }
    if(q >= 181){
    q5 -= (q-181)*1.22;
    }
    beginShape();
    curveVertex(-100+q5,-30+q4); 
    curveVertex(-93+q5,-96+q2); 
    curveVertex(-49+q5,-111+q); 
    curveVertex(0,-86+q3); 
    curveVertex(49-q5,-111+q); 
    curveVertex(93-q5,-96+q2); 
    curveVertex(100-q5,-30+q4); 
    curveVertex(0,86); 
    curveVertex(-100+q5,-30+q4); 
    curveVertex(-93+q5,-96+q2); 
    curveVertex(-49+q5,-111+q);
    endShape();

    popMatrix();
}
function dynaHeart(x,y,s,a,m){
heartBg(x,y,s,a);
heartFill(x,y,s,a,m);
heartOutline(x,y,s,a);
}
function trophy(x,y,s,a){
pushMatrix();
translate(x,y);
scale(s);
strokeWeight(2*(1/s));
if(a){
stroke(0,0,0,a);
fill(232, 174, 0, a);
}else{
stroke(0,0,0);
fill(232, 174, 0);
}
ellipse(0,10,6,6);
quad(-10,15,-8,12,8,12,10,15);
strokeWeight(3*(1/s));
arc(0,-10,25,35,0,180);
line(-12,-10,12,-10);
popMatrix();
}
function clock(x,y,s,t){
pushMatrix();
translate(x,y);
scale(s);
strokeWeight(3*(1/s));
stroke(0,0,0);
fill(209, 209, 184);
ellipse(0,0,24,24);
for(var i = 0; i < 12; i++){
strokeWeight(1*(1/s));
var a = 30*i;
line(cos(a)*8,sin(a)*9,cos(a)*12,sin(a)*12);
}
strokeWeight(2*(1/s));
stroke(0,0,0,100);
var a = ((30)*hour()+(6*minute())/60)-90;
line(0,0,cos(a)*5,sin(a)*5);
a = (6*minute())-90;
line(0,0,cos(a)*10,sin(a)*10);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(t,0,4);
popMatrix();
}
function dice(x,y,d){
pushMatrix();
translate(x,y);
strokeWeight(2);
stroke(0,0,0);
fill(194, 194, 194);
rect(-8,-8,15,15,3);
strokeWeight(3);
stroke(0,0,0);
switch(d){
case 1:
point(0,0);
break;
case 2:
point(-2,-2);
point(2,2);
break;
case 3:
point(-3,-3);
point(0,0);
point(3,3);
break;
case 4:
point(-3,-3);
point(-3,3);
point(3,3);
point(3,-3);
break;
case 5:
point(0,0);
point(-3,-3);
point(-3,3);
point(3,3);
point(3,-3);
break;
case 6:
point(-4,-3);
point(0,-3);
point(4,-3);
point(-4,3);
point(0,3);
point(4,3);
break;
}
popMatrix();
}
function attack(x,y,s,a){
    stroke(0,0,0);
    fill(222, 222, 222);
    if(a){
    stroke(0,0,0,a);
    fill(222, 222, 222,a);
    }
    pushMatrix();
    translate(x,y);
    scale(s);
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); curveVertex(49,6); curveVertex(-12,47); curveVertex(-78,6); curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); 
    endShape();
    popMatrix();
}
function egg(x,y,s){
    stroke(0,0,0);
    fill(255, 255, 255);
    pushMatrix();
    translate(x,y);
    scale(s);
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); curveVertex(49,6); curveVertex(-12,47); curveVertex(-78,6); curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); 
    endShape();
    popMatrix();
}
function noColoredEgg(x,y,s){
    pushMatrix();
    translate(x,y);
    scale(s);
    strokeWeight(3*(1/s));
    beginShape();
    curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); curveVertex(49,6); curveVertex(-12,47); curveVertex(-78,6); curveVertex(-72,-74); curveVertex(-20,-136); curveVertex(40,-72); 
    endShape();
    popMatrix();
}
function cnest(x,y){
        pushMatrix();
        translate(x,y);
        strokeWeight(3);
        for(var q = -4; q < 20; q += 3){
            var colVar = 22;
            stroke(204+cos(q*234)*colVar, 151+cos(q*345)*colVar, 71+cos(q*123)*colVar);
            var x = 0;
            var y = 25;
            var d = 20+sin(q*84)*13;
            line(x+cos(q)*d,y+sin(q)*d,x+cos(q+180)*d,y+sin(q+180)*d);
        }
        popMatrix();
}
function coin(x,y,s,t){
pushMatrix();
translate(x,y);
scale(s);
fill(176, 144, 0);
stroke(0,0,0);
strokeWeight(3);
ellipse(0,0,30,30);
noStroke();
fill(255, 208, 0);
ellipse(0,0,22,22);
fill(0,0,0);
textSize(13);
textAlign(CENTER,BASELINE);
text(t,0,4);
popMatrix();
}
function projectile(){}
function getAngle(a,b){
    return atan2(b.y-a.y,b.x-a.x);
}
function throwProj(a,b,h,t){
if(!t){
t = 'egg';
}
var ang = getAngle(a,b);
//println(ang);
var p = new projectile(a.x,a.y,cos(ang)*h,sin(ang)*h,{type:t,g:0,target:b,data:a.stats,owner:a});
p.doRegistering();

}
function boolToEnglish(e){
if(e){
return 'yes';
}
return 'no';
}
function throwAbilityProj(a,b,h,d,t){
if(!t){
t = 'egg';
}
var ang = getAngle(a,b);
//println(ang);
var p = new projectile(a.x,a.y,cos(ang)*h,sin(ang)*h,{type:t,g:0,target:b,data:a.stats,owner:a,damage:d});
}
function feedProj(a){
var p = new projectile(a.x,a.y,0,-4.75,{type:'food',g:0.2,target:a,data:a.stats,owner:a,damage:0});
}
function xpProj(a,amt){
var p = new projectile(a.x,a.y,0,-4.7,{type:'xp',g:0.2,target:a,data:a.stats,owner:a,damage:0, amount:amt||1, customSize:1.4, customLife:200});
}
function chickenFeed(a,b){
throwAbilityProj(a,b,dist(a.x,a.y,b.x,b.y)/50,-1,'food');
}
function temporaryStat(subj,attack,health){
subj.attack += attack;
subj.health += health;
if(!subj.tempStatAttack){
    subj.tempStatAttack = 0;
}
if(!subj.tempStatHealth){
    subj.tempStatHealth = 0;
}
subj.tempStatAttack += attack;
subj.tempStatHealth += health;
}
function updateStats(e){
    e.dHealth = e.health;
    e.dAttack = e.attack;
}
function getProgress(xp){
xp = round(xp);
if(xp >= 5){
return 1;
}else if(xp >= 2){
return (xp-2)*(1/3);
}else{
return xp*0.5;
}
}
function getLevel(xp){
xp = round(xp);
if(xp >= 5){
return 3;
}else if(xp >= 2){
return 2;
}
return 1;
}
function filt(a,func){
var ret = [];
for(var i = 0; i < a.length; i++){
if(func(a[i])){
ret.push(a[i]);
}
}
return ret;
}
function getLeftRight(i){
var ret = [];
var num = i+1;
if(num <= 5 && num !== 3){
ret.push(num);
}
var num = i-1;
if(num >= 0 && num !== 2){
ret.push(num);
}
return ret;
}
function getUpDown(i){
var ret = [];
var num = i-3;
if(num >= 0){
ret.push(num);
}
var num = i+3;
if(num <= 5){
ret.push(num);
}
return ret;
}
function getAllRight(i){
var ret = [];
var num = i+1;
if(num !== 3 && num <= 5){
ret.push(num);
}
var num = i+2;

if(num === 2 || num === 5){

ret.push(num);
}
return ret;
}
function shuffleArray(e) {
  var sra = [];
  var ea = [];
  for (var q = 0; q < e.length; q++) {
    ea.push(e[q]);
  }
  for (var i = 0; i < e.length; i++) {
    var sn = round(random(0, ea.length - 1));
    sra.push(ea[sn]);
    ea.splice(sn, 1);
  }
  return (sra);
}


// pre-defining variables so I can use them in abilities
function eachChickenInTeam(){}
function roll(){}
function doAbilitiesTurn(){}
function chicken(){}
function doAbilitiesFight(){}
function effect(){}
function getRand(){}
function getRandExact(){}
function killChicken(){}
function killContraption(){}
function killFood(){}
function summonCheck(){}
var lastFoodFunc = function(){};
var bgImg;
var shop;
var gold;
var myCoops;
var tutorial;
var power;
var food;
var tier;
var record;
var myContraptions;
var tNames = ['Player'+round(random(0,1000)),'Player'+round(random(0,1000))];
var tRecord = [0,0,1];
var coinAnim;
var gFight;
var shopPage;
var chickens;
var contraptions;
var rollCount;
var lastBought = false;
var lastLeveled = false;
var bonusGold = 0;
var lastSummoned = false;
var lastFed = false;
var teamPic = false;
var saveSpeed = speed;
var todo = [];
var specialImgs = [];
function cleanShop(n){
    for(var i = 0; i < shop[n].num; i++){
if(shop[n].data[i]){
if(shop[n].data[i].IDENTIFIER === 'chicken'){
killChicken(shop[n].data[i]);
}
if(shop[n].data[i].IDENTIFIER === 'contraption'){
killContraption(shop[n].data[i]);
}
if(shop[n].data[i].IDENTIFIER === 'food'){
killFood(shop[n].data[i]);
}
}
}
}
function allExceptForArray(arr, ex){
var ret = [];
for(var i = 0; i < arr.length; i++){
if(!(ex && ex.includes(arr[i]))){
ret.push(arr[i]);
}
}
return ret;
}
function allMyChickensExceptForArray(ex){
var ret = [];
for(var i = 0; i < myCoops.length; i++){
for(var q = 0; q < myCoops[i].c.length; q++){
if(myCoops[i].c[q] && !(ex && ex.includes(myCoops[i].c[q]))){
ret.push(myCoops[i].c[q]);
}
}
}
return ret;
}
function eachAliveInTeam(e){
var options = eachChickenInTeam(e);
var ret = [];
for(var i = 0; i < options.length; i++){
    if(options[i].health > 0){
        ret.push(options[i]);
    }
}
return ret;
}
function eachAliveInTeamThenAll(e){
var options = eachChickenInTeam(e);
var ret = [];
for(var i = 0; i < options.length; i++){
    if(options[i].health > 0){
        ret.push(options[i]);
    }
}
if(ret.length > 0){
return ret;
}else{
return options;
}
}
function eachInTeam(e){
var options = eachChickenInTeam(e);
var ret = [];
for(var i = 0; i < options.length; i++){
    ret.push(options[i]);
}
return ret;
}

// jello chicken special graphics
{
pushMatrix();
translate(300,300);
scale(2);
background(255, 255, 255);
background(255, 255, 255, 0);
stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0, 100);
    beginShape();
    vertex(-9,-5);
    vertex(6,-25);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(13, 255, 0,160);
    ellipse(0,0,50,50);
    fill(227, 0, 0, 100);
    ellipse(22,15,10,15);
    fill(255, 149, 0,220);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
specialImgs.push(get());
popMatrix();
}
// lava chicken special graphics
{
pushMatrix();
translate(300,300);
scale(2);
background(255, 255, 255);
background(255, 255, 255, 0);
 pushMatrix();
    translate(7,-1);
    rotate(69);
    scale(0.9);
    for(var i = 0; i < 3; i++){
    noStroke();
    fill(227, i*80, 0);
    pushMatrix();
    translate(-11,-2+i*2);
    scale(0.6+(3-i)*0.2,0.5+(3-i)*0.2);
    scale(0.8,1.5);
    rotate(-76);
    beginShape();
    vertex(-9,-8);
    vertex(6,-7);
    vertex(-9,-53);
    curveVertex(-12,-29);
    vertex(-19,4);
    vertex(9,437);
    endShape();
    popMatrix();
    }

    stroke(0,0,0);
    strokeWeight(3);
    noFill();
    pushMatrix();
    translate(-11,-2);
    scale(0.6+(3)*0.2,0.5+(3)*0.2);
    scale(0.8,1.5);
    rotate(-76);
    beginShape();
    vertex(-9,-8);
    vertex(6,-7);
    vertex(-9,-53);
    curveVertex(-12,-29);
    vertex(-19,4);
    vertex(9,437);
    endShape();
    popMatrix();

    popMatrix();
    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 115, 0);
    ellipse(0,0,50,50);
    noStroke();
    fill(255, 98, 0);
    ellipse(-2,2,35,35);
    fill(255, 77, 0);
    ellipse(-6,6,20,20);
    fill(59, 18, 18);
    pushMatrix();
    translate(5,11);
    rotate(16);
    ellipse(0,0,7,13);
    popMatrix();
    pushMatrix();
    translate(10,-6);
    rotate(-22);
    ellipse(0,0,5,30);
    fill(255, 98, 0);
    ellipse(0,6,2,10);
    popMatrix();
    stroke(0,0,0);
    strokeWeight(3);
    fill(173, 83, 83);
    ellipse(22,14,7,25);
    fill(168, 97, 42);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(6);
    stroke(0,0,0);
    fill(255, 128, 0);
    ellipse(-8,-4,12,12);
    ellipse(-6,1,8,19);
    noFill();
    noStroke();
    fill(222, 56, 0);
    ellipse(-8,-4,12,12);
    ellipse(-6,1,8,19);
specialImgs.push(get());
popMatrix();
}

var stats = {};
var cam = {x:0,y:0,zoom:0,toZoom:1};
var aCam = {on:false,x:0,y:0,zoom:0};
var sTypes = ['chicken','contraption','food'];

for(var i = 0; i < sTypes.length; i++){
    stats[sTypes[i]] = {};
}

var bases = {
    chicken:function(){
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    },
    contraption:function(){

    },
    food:function(){

    },
};

// animImgStatic = functional anim (like repairman)
// animImg = just a top-layer animated part
// animImgBehind = bottom-layer animated part

var types = {
    chicken:[
    // tier 1 {

    // OMG
    // {
    // name: 'John Cena chicken',
    // attack: 99,
    // health: 99,
    // size:1,
    // discount: 0,
    // tier: 1,
    // bulletLife: 600,
    // noBase:true,
    // ability: function(lvl){
    // return 'u no c me';
    // },
    // startOfBattle: function(t,lvl){
    // t.attack += lvl;
    // t.health += lvl;
    // t.temporaryScale = 1.5;
    // feedProj(t);
    // },
    // img:false,
    // loadImg: function(e){
    // }
    // },

    // basic (rip joe)
    {
    name: 'Basic chicken',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Start of battle: Gain +'+lvl+' attack and +'+lvl+' health';
    },
    startOfBattle: function(t,lvl){
    t.attack += lvl;
    t.health += lvl;
    t.temporaryScale = 1.5;
    feedProj(t);
    },
    img:false,
    loadImg: function(e){
    }
    },
    // blowdart
    {
    name: 'Blowdart chicken',
    attack: 2,
    health: 2,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Start of battle: deal '+lvl+' damage to a random enemy';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachAliveInTeamThenAll(1-t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health -= lvl;
    throwAbilityProj(t,select,20,lvl,'dart');
    }
    },
    img:false,
    loadImg: function(e){
    strokeWeight(5);
    stroke(0,0,0);
    fill(43, 43, 43);
    arc(0,-10,50,40,180,360);
    arc(0,5,50,45,0,200);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    triangle(15,-6,15,14,35,9);
    strokeWeight(3);
    fill(240, 0, 0);
    ellipse(0,-20,44,8);
    fill(240, 0, 0);
    pushMatrix();
    translate(-22,-20);
    rotate(-45);
    translate(22,20);
    ellipse(-24,-19,12,6);
    popMatrix();
    pushMatrix();
    translate(-22,-20);
    rotate(45);
    translate(22,20);
    ellipse(-24,-21,12,6);
    popMatrix();
    fill(0, 130, 7);
    rect(15,10,30,6,3);
    }
    },
    // pork
    {
    name: 'Pork chicken',
    attack: 4,
    health: 1,
    size:1.05,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardWidth: 0,
    ability: function(lvl){
    return 'Trashed: get '+lvl+' gold';
    },
    trashed: function(t,lvl){
    gold += lvl;
    coinAnim.s = 1.4;
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);
stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 135, 225);
    pushMatrix();
    translate(12,-27);
    rotate(10);
    ellipse(0,0,15,23);
    popMatrix();
    pushMatrix();
    translate(-11,-27);
    rotate(-10);
    ellipse(0,0,15,23);
    popMatrix();
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,21,10,15);
    //fill(255, 149, 0);
    fill(255, 79, 211);
    ellipse(27,8,24,18);
    strokeWeight(5);
    point(23,8);
    point(31,8);
    strokeWeight(7);
    point(-8,-3);
    noFill();
    strokeWeight(4);
    stroke(133, 133, 133, 200);
    arc(0,-8,26,20,220,320);
popMatrix();
    },
    },
    // farmer
    {
    name: 'Farmer chicken',
    attack: 1,
    health: 3,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Faint: give a random friend +'+(lvl)+'/+'+(lvl*2);
    },
    faint: function(t,lvl){
    var options = eachAliveInTeamThenAll(t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.attack += lvl*2;
    select.health += lvl;
    feedProj(select);
    }
    var splatter = new effect(t.x,t.y,'ghost',1,100,{type:'Farmer chicken'});
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
translate(-3,-23);
rotate(-8);
stroke(0,0,0);
strokeWeight(3);
fill(204, 166, 104);
ellipse(0,0,60,15);
fill(161, 133, 87);
rect(-16,-20,30,20,5);
popMatrix();
    },
    loadImgBehind: function(e){
    pushMatrix();
translate(0,-15);
rotate(30);
stroke(87, 51, 11);
strokeWeight(5);
line(30,20,30,-45);
line(18,-30,42,-30);
line(18,-30,18,-45);
line(42,-30,42,-45);
popMatrix();
    },
    },
    // teacher
    {
    name: 'Teacher chicken',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Trashed: give chickens IN SHOP PAGE 1 +'+(lvl)+'/+'+(lvl);
    },
    trashed: function(t,lvl){
    for(var i = 0; i < shop[0].data.length; i++){
    // println(shop[0].data[i].IDENTIFIER);
    if(shop[0].data[i].IDENTIFIER === 'chicken'){
    var select = shop[0].data[i];
    select.attack += lvl;
    select.health += lvl;
    feedProj(select);
    }
    }
    },
    img:false,
    loadImg: function(e){


pushMatrix();
translate(0,0);
rotate(0);

strokeWeight(2);
stroke(0,0,0);
fill(90, 232, 223, 100);
pushMatrix();
translate(24,-5);
rotate(-5);
beginShape();
vertex(-5,0);
vertex(15,0);
vertex(10,8);
vertex(0,7);
endShape(CLOSE);
popMatrix();

    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);

strokeWeight(2);
stroke(0,0,0);
fill(90, 232, 223, 100);
pushMatrix();
translate(2,-6);
rotate(5);
beginShape();
vertex(-5,0);
vertex(15,0);
vertex(10,8);
vertex(0,7);
endShape(CLOSE);
popMatrix();

    pushMatrix();
    translate(-20,17);
    rotate(-25);
    scale(0.3);
    strokeWeight(8);
    stroke(0,0,0);
    fill(247, 37, 37);
    ellipse(0,0,60,60);
    stroke(102, 61, 10);
    line(5,-20,20,-35);
    noStroke();
    fill(15, 135, 4);
    ellipse(0,-25,15,24);
    popMatrix();

popMatrix();

    },
    loadImgBehind: function(e){
    pushMatrix();
translate(40,-34);
rotate(30);

stroke(0,0,0);
strokeWeight(2);
fill(212, 184, 112);
rect(0,0,8,48,2);
for(var i = 1; i < 12; i++){
strokeWeight(1);
line(2,i*4,4,i*4);
}

popMatrix();
    },
    },
    // soldier
    {
    name: 'Soldier chicken',
    attack: 2,
    health: 1,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'End turn: give a random friend +'+lvl+' attack';
    },
    endTurn: function(t,lvl){
    var options = allMyChickensExceptForArray([t]);
    if(options.length > 0){
    t.temporaryScale = 1.3;
    var select = chooseFrom(options);
    // t.x = select.x;
    // t.y = select.y;
    select.attack += lvl;
    chickenFeed(t,select);
    }else{
    t.bad = 30;
    t.badMessage = 'No Friends';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){pushMatrix();
translate(-3,-16);
rotate(-8);

noStroke();
fill(0,0,0);
pushMatrix();
rotate(8);
rect(-11,6,13,5,3);
popMatrix();

strokeWeight(3);
noFill();
stroke(145, 145, 145);
arc(0,11,35,61,101,196);
pushMatrix();
translate(0,2.5);
stroke(0,0,0);
fill(25, 92, 24);
arc(0,0,55,50,180,360);
noStroke();
fill(37, 125, 12);
ellipse(10,-14,15,10);
fill(87, 125, 12);
ellipse(1,-8,15,13);
fill(12, 125, 14);
ellipse(-14,-10,12,12);
stroke(0,0,0);
fill(150, 132, 81);
rect(-30,-5,60,8,5);
popMatrix();
noStroke();
fill(145, 145, 145);
rect(-5,37,14,8,5);


popMatrix();},
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // boxer
    {
    name: 'Boxer chicken',
    attack: 3,
    health: 2,
    size:1.02,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Trashed: give two random friends +'+lvl+' health';
    },
    trashed: function(t,lvl){
    var options = allMyChickensExceptForArray([t]);
    if(options.length > 0){
    var select = chooseFrom(options);
    var select2 = false;
    var options2 = allExceptForArray(options,[select]);
    if(options2.length > 0){
    select2 = chooseFrom(options2);
    select2.health += lvl;
    feedProj(select2);
    }
    select.health += lvl;
    feedProj(select);
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
translate(-22,9);
rotate(8);
stroke(0,0,0);
strokeWeight(3);
fill(227, 0, 0);
rect(8,-7,14,10,2);
rect(0,0,20,15,5);
rect(10,-2,20,20,5);
strokeWeight(5);
line(2,2,2,14);
popMatrix();
    },
    loadImgBehind: function(e){
    pushMatrix();
translate(20,-8);
rotate(-38);
stroke(0,0,0);
strokeWeight(3);
fill(227, 0, 0);
rect(10,-2,20,20,5);
rect(0,0,13,15,5);
rect(8,-7,14,10,2);
strokeWeight(5);
line(2,2,2,14);
popMatrix();
    },
    animImg: function(e){
    },
    },
    // old
    {
    name: 'Old chicken',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardWidth: 5,
    noBase:true,
    ability: function(lvl){
    return 'Trashed: give up to 2 contraptions +'+lvl+' durability';
    },
    trashed: function(t,lvl){
    var options = [];
    for(var i = 0; i < myContraptions.length; i++){
        options.push(myContraptions[i]);
    }
    for(var i = 0; i < 2; i++){
        if(options.length > 0){
        var a = floor(random(0,options.length));
        var q = options[a];
        q.health+=lvl;
        q.temporaryScale = 1.3;
        feedProj(q);
        options.splice(a,1);
        }
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();

    stroke(0,0,0);
    strokeWeight(5);
    fill(184, 184, 184);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(184, 184, 184);
    ellipse(23,15,17,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,12,14,35,9);
    strokeWeight(7);
    point(-8,-3);

pushMatrix();
translate(-23,-4);
rotate(8);
scale(1.5);

stroke(0,0,0);
strokeWeight(1.5);
fill(110, 69, 22);
beginShape();
vertex(3,20);
vertex(0,20);
vertex(0,-20);
vertex(1,-24);
vertex(3,-26);
vertex(10,-26);
vertex(15,-23);
vertex(13,-15);
vertex(10,-17);
vertex(11,-21);
vertex(7,-22);
vertex(4,-21);
vertex(3,0);
endShape(CLOSE);
popMatrix();

noFill();
strokeWeight(2);
stroke(115, 115, 115);
arc(-8,0,14,10,30,150);
arc(9,-14,14,10,210,330);

popMatrix();
    },
    loadImgBehind: function(e){

    },
    },
    // jello
    {
    name: 'Jello chicken',
    attack: 1,
    health: 2,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardHeight: 8,
    stretchLimit:20,
    noBase:true,
    ability: function(lvl){
    return 'Bought: give a random friend +'+lvl+' attack and +'+lvl+' health';
    },
    buy: function(t,lvl){
    var options = allMyChickensExceptForArray([t]);
    if(options.length > 0){
    t.temporaryScale = 1.3;
    var select = chooseFrom(options);
    select.health += lvl;
    select.attack += lvl;
    chickenFeed(t,select);
    }
    },
    img:false,
    crucialAnim:true,
    loadImg: function(e){
    },
    loadImgBehind: function(e){
    },
    animImg: function(e){
        pushMatrix();
translate(0,0);
var num = sin(frameCount*1.6)*0.08;
translate(0,25);
scale(1+num,1-num);
translate(0,-25);
scale(0.5);

    image(specialImgs[0],-300,-300);

popMatrix();
    },
    },
    // fishy
    {
    name: 'Fishy chicken',
    attack: 2,
    health: 2,
    size:1,
    discount: 0,
    tier: 1,
    bulletLife: 600,
    plusCardHeight: 8,
    stretchLimit:20,
    noBase:true,
    ability: function(lvl){
    var a = lvl-1;
    if(lvl === 1){
    a = 1;
    }
    return 'Level up: give all friends +'+a+' attack and +'+a+' health';
    },
    levelUp: function(t,lvl){
    var options = allMyChickensExceptForArray([t]);
    t.temporaryScale = 1.3;
    for(var i = 0; i < options.length; i++){
    var select = options[i];
    select.health += (lvl-1);
    select.attack += (lvl-1);
    chickenFeed(t,select);
    }
    },
    img:false,
    loadImg: function(e){

    stroke(0,0,0);
    strokeWeight(5);
    fill(0, 140, 227);
    beginShape();
    vertex(-9,13);
    vertex(6,-21);
    vertex(-9,-44);
    curveVertex(-10,-18);
    vertex(84,-33);
    //vertex(9,246);
    endShape();
    pushMatrix();
    strokeWeight(25);
    translate(-15,-5);
    rotate(10);
    scale(0.2);
    beginShape();
    curveVertex(-119,-65); curveVertex(69,10); curveVertex(-85,127); curveVertex(-52,29); curveVertex(-119,-65); curveVertex(69,10); curveVertex(-85,127); /**/
    endShape();
    popMatrix();
    fill(21, 232, 207);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    strokeWeight(5);
    fill(0, 140, 227);
    triangle(-15,29,-15,10,-2,17);

    },
    loadImgBehind: function(e){
    },
    },
    // }
    // tier 2 {
    // big
    {
    name: 'Big chicken',
    attack: 3,
    health: 4,
    size:1.15,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl,t){
    var a = 's';
    if(t.triggers === 1){
    a = '';
    }
    return 'Targeted: Gain +'+lvl+' health. Works 2 times per battle. ('+(2-t.triggers)+' trigger'+a+' left)';
    },
    targeted: function(t,lvl){
    if(t.triggers < 2){
    t.triggers++;
    t.health += lvl;
    t.temporaryScale = 1.5;
    feedProj(t);
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
    }
    },
    // repairman
    {
    name: 'Chicken repairman',
    attack: 1,
    health: 2,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    plusCardHeight: 10,
    ability: function(lvl){
    return 'End turn: give the nearest contraption +'+lvl+' durability';
    },
    endTurn: function(t,lvl){
    var closest = false;
            for(var i = 0; i < myContraptions.length; i++){
            var q = myContraptions[i];
            if(!closest || dist(q.x,q.y,t.x,t.y)<=closest[1]){
            closest = [q,dist(q.x,q.y,t.x,t.y)];
            }

            }

            if(closest){
                t.temporaryScale = 1.3;
                closest[0].health+=lvl;
                //closest[0].temporaryScale = 1.3;
                feedProj(closest[0]);
            }
    },
    img:false,
    loadImg: function(e){

pushMatrix();
stroke(0,0,0);
strokeWeight(3);
fill(158, 158, 158);
translate(1,11);
rotate(69);
rect(-3.5,5,5,20,4);
strokeWeight(4);
scale(0.5,0.8);
arc(0,0,30,15,-50,230);
fill(255, 255, 255);
arc(0,-4,20,13,0,180);
popMatrix();
pushMatrix();
translate(-10,-15);
rotate(-7);
scale(0.9);
strokeWeight(3);
stroke(84, 84, 84);
fill(163, 163, 163);
rect(-15,-20,45, 20,4);
line(-10,0,52,0);
popMatrix();

    },
    loadImgBehind: function(e){

pushMatrix();
translate(7,0);
rotate(6);
strokeWeight(4);
stroke(0,0,0);
noFill();
rect(15,-5,10,10,1);
strokeWeight(4);
fill(207, 0, 0);
stroke(135, 0, 0);
rect(0,0,40,20,1);
line(0,8,40,8);
popMatrix();
    },
    animImgStatic: function(e){
    if(scene === 'game'){
        if(e.owned){
            var closest = false;
            for(var i = 0; i < myContraptions.length; i++){
            var q = myContraptions[i];
            if(!closest || dist(q.x,q.y,e.x,e.y)<=closest[1]){
            closest = [q,dist(q.x,q.y,e.x,e.y)];
            }

            }

            if(closest){
                strokeWeight(5);
                stroke(0, 255, 238,200);
                line(e.x,e.y,closest[0].x,closest[0].y);
            }
        }
    }
    },
    },
    // business
    {
    name: 'Business chicken',
    attack: 3,
    health: 3,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Start of battle: give a random enemy -'+(lvl*2)+' attack.  Attack cannot go below 1.';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachAliveInTeamThenAll(1-t.teamId);
    options = filt(options,function(item){
    if(item.attack > 1){
    return true;
    }
    return false;
    });
    if(options.length > 0){
    var select = chooseFrom(options);
    select.attack -= lvl*2;
    if(select.attack < 1){
        select.attack = 1;
    }
    throwAbilityProj(t,select,20,0,'special');
    }
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);
stroke(0,0,0);
strokeWeight(2);

fill(145, 145, 145);
noStroke();
stroke(0,0,0);
strokeWeight(2);
pushMatrix();
translate(34,-10);
rotate(-36);
scale(-1,1);
beginShape();
vertex(6,12);
vertex(15,0);
vertex(27,0);
vertex(16,8);
vertex(6,12);
endShape(CLOSE);
popMatrix();
beginShape();
vertex(16,8);
vertex(-3,12);
vertex(15,0);
vertex(27,0);
endShape();
fill(135, 135, 135);
stroke(0,0,0);
strokeWeight(2);
fill(186, 186, 186);
beginShape();
vertex(-25,-4);
vertex(-19,-17);
vertex(-1,-23);
vertex(7,-23);
vertex(18,-16);
vertex(22,-34);
for(var i = 1; i < 11; i++){
vertex(22-i*5,-34+sin(i*155)*2 -sin(i*28-56)*4);
}
vertex(-29,-4);
endShape();
noStroke();
fill(79, 79, 79);

stroke(0,0,0);
strokeWeight(2);
beginShape();
vertex(-12,-10);
vertex(1,-10);
vertex(1,-5);
vertex(-12,-6);
endShape(CLOSE);
// pushMatrix();
// rotate(10);
// translate(-7,-5);
// beginShape();
// vertex(32,-7);
// vertex(15,-13);
// vertex(16,-8);
// endShape();
// popMatrix();
popMatrix();
pushMatrix();
translate(-29,-6);
rotate(56);

stroke(0,0,0);
strokeWeight(5);
noFill();
rect(10,-7,14,10,3);
pushMatrix();
translate(29,-1);
rotate(6);
stroke(0,0,0);
strokeWeight(2);
fill(222, 222, 222);
rect(0,0,10,15,2);
popMatrix();
pushMatrix();
translate(24,1);
rotate(-29);
stroke(0,0,0);
strokeWeight(2);
fill(222, 222, 222);
rect(0,0,10,15,2);
popMatrix();
stroke(0,0,0);
strokeWeight(3);
fill(120, 120, 120);
rect(0,0,34,22,3);

popMatrix();
    },
    loadImgBehind: function(e){

    },
    animImg: function(e){
    pushMatrix();
fill(0,0,0);
noStroke();
translate(15,28);
rotate(-sin(frameCount*e.shakeIntensity+e.id)*15);
ellipse(0,0,10,10);
quad(0,0,5,15,0,23,-5,15);
popMatrix();
    },
    },
    // capitalist
    {
    name: 'Capitalist chicken',
    attack: 1,
    health: 4,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    plusCardWidth: 10,
    ability: function(lvl){
    return 'Start of turn: get '+lvl+' extra gold';
    },
    startOfTurn: function(t,lvl){
    t.temporaryScale = 1.4;
    gold += lvl;
    coinAnim.s = 1.4;
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(-8,-3);
rotate(106);
noStroke();
fill(255, 255, 255,150);
ellipse(0,0,15,15);
strokeWeight(3);
stroke(117, 117, 117);
fill(0, 255, 238,100);
ellipse(0,0,15,15);
strokeWeight(4);
for(var i = 3; i < 8; i++){
point(0+i*3,sin(i*60)*5);
}
fill(36, 36, 36);
noStroke();
pushMatrix();
translate(6,-25);
rotate(-108);
scale(0.1);
beginShape();
    curveVertex(-9,-25); curveVertex(82,-58); curveVertex(-10,6); curveVertex(-119,-85); curveVertex(-9,-25); curveVertex(82,-58); curveVertex(-10,6); /**/
    endShape();
popMatrix();
popMatrix();
pushMatrix();
translate(-4,-22);
rotate(-10);
scale(1);
noStroke();
fill(0,0,0);
ellipse(0,0,45,10);
rect(-14,-30,28,30,6);
textAlign(CENTER,BASELINE);
textSize(20);
fill(221, 255, 0);
for(var i = 0; i < 2; i++){
text('$',-1.25+i*2.5,-7);
}
popMatrix();

    },
    loadImgBehind: function(e){
pushMatrix();
translate(0,0);
rotate(0);
pushMatrix();
translate(30,6);
rotate(-15);
scale(-0.1,0.1);
noStroke();
fill(36, 36, 36);
beginShape();
    curveVertex(-9,-25); curveVertex(82,-58); curveVertex(-10,6); curveVertex(-119,-85); curveVertex(-9,-25); curveVertex(82,-58); curveVertex(-10,6); /**/
    endShape();
popMatrix();
popMatrix();   
    },
    },
    // target
    {
    name: 'Target chicken',
    attack: 1,
    health: 5,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Hurt: gain +'+(lvl*4)+' attack';
    },
    hurt: function(t,lvl){
    t.attack += lvl*4;
    t.attack = round(t.attack);
    t.temporaryScale = 1.5;
    feedProj(t);
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 0, 0);
    ellipse(0,0,50,50);
    strokeWeight(3);
    fill(255, 255, 255);
    ellipse(0,0,30,30);
    fill(255, 0, 0);
    ellipse(0,0,10,10);
    strokeWeight(5);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    fill(0,0,0);
    textAlign(CENTER,CENTER);
    textSize(10);
    //text('LGM',0,0);
    }
    },
    // punk
    {
    name: 'Punk chicken',
    attack: 2,
    health: 5,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    var e = '';
    if(lvl > 1){
    e = 's';
    }
    return 'Attacked: deal 1 damage to each friend to the left and right '+lvl+' time'+e;
    },
    attacked: function(t,lvl){
    var targs = getLeftRight(t.coopPos);
    if(t.coopId){
    for(var i = 0; i < targs.length; i++){
    for(var q = 0; q < lvl; q++){
    var subj = t.coopId.c[targs[i]];
    if(subj){
    subj.health--;
    subj.checkStatUp();
    throwAbilityProj(t,subj,3*q+1,1,'dart');
    }
    }
    }
    }
    },
    img:false,
    noBase:true,
    loadImgBehind:function(e){
    pushMatrix();
translate(37,-37);
rotate(34);

stroke(0,0,0);
strokeWeight(2);
fill(115, 74, 17);
rectMode(LEFT);
rect(0,0,10,56,3);
stroke(69, 69, 69);
strokeWeight(4);
line(7,8,15,7);

popMatrix();
    },
    loadImg: function(e){

    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    fill(230, 230, 230);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    line(-12,-8,-4,-7);
    for(var i = -37; i < 26; i+=6){
    pushMatrix();

    rotate(i);
    strokeWeight(5);
    var num = 12;
    for(var q = 0; q < num; q++){
    stroke(255-q*((30*5)/num), 0, 0);
    line(0,-43+q*((3.5*5)/num),0,-22);
    }
    popMatrix();
    }
    }
    },
    // classy
    {
    name: 'Classy chicken',
    attack: 3,
    health: 3,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Contraption Bought: Gain +'+lvl+' attack and +'+(lvl)+' health';
    },
    contraptionBought: function(t,lvl){
    t.attack += lvl;
    t.health += (lvl);
    t.temporaryScale = 1.5;
    feedProj(t);
    },
    img:false,
    noBase:true,
    loadImgBehind:function(e){
    },
    loadImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);

    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(0, 0, 0);
    noStroke();
    arc(0,10,47,27,-15,168);
    fill(156, 156, 156);
    pushMatrix();
    rotate(-9);
    stroke(255, 255, 255);
    strokeWeight(2);
    triangle(1,26,-4,9.5,6,9.5);
    noStroke();

    fill(0,0,0);
    ellipse(1,13,2,2);
    ellipse(1,17,2,2);
    ellipse(1,21,2,2);
    popMatrix();

    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);

    pushMatrix();
    translate(3,9);
    line(-34,-19,21,-34);
    fill(0,0,0);
    translate(0,0);
    rotate(-19);
    rect(-11,-65,23,34);
    popMatrix();

    pushMatrix();
    translate(-7,18);
    strokeWeight(2);
    stroke(255, 179, 0);
    fill(255, 200, 0);
    ellipse(0,0,7,7);
    strokeWeight(1);
    stroke(0,0,0);
    pushMatrix();
    rotate(-45);
    line(0,0,3,0);
    rotate(-114);
    line(0,0,2,0);
    popMatrix();
    noStroke();
    fill(69, 69, 69);
    rotate(-11);
    rect(-5,1,10,4,2);
    popMatrix();

popMatrix();
    }
    },
    // explosive
    {
    name: 'Explosive chicken',
    attack: 2,
    health: 2,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Faint: deal '+(lvl*2)+' damage to ALL chickens';
    },
    faint: function(t,lvl){
    for(var i = 0; i < 2; i++){
    var all = eachChickenInTeam(i);
    for(var q = 0; q < all.length; q++){
    all[q].health -= lvl*2;
    throwAbilityProj(t,all[q],5,lvl*2,'bomb');
    }
    }
     var splatter = new effect(t.x,t.y,'ghost',1,100,{type:'Explosive chicken'});
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);

    strokeWeight(5);
    fill(138, 138, 138);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);

var a = [[-38,10,-29],[-11,8,68]];
for(var i = 0; i < a.length; i++){
pushMatrix();
translate(a[i][0],a[i][1]);
rotate(a[i][2]);
stroke(0,0,0);
strokeWeight(3);
fill(212, 0, 0);
rect(6,-5,8,20,3);
pushMatrix();
translate(-4,-25);
scale(0.09);
noFill();
stroke(0,0,0);
strokeWeight(30);
bezier(106, 343, 149, 310, 229, 114, 122, 123);
popMatrix();
fill(212, 0, 0);
rect(0,-2,8,20,3);
rect(7,0,8,20,3);
popMatrix();
}

popMatrix();
    },
    loadImgBehind: function(e){
    },
    animImg: function(e){
    pushMatrix();
translate(0,0);
rotate(0);

pushMatrix();
translate(-10,-58);
scale(0.1);
noFill();
stroke(161, 161, 161);
strokeWeight(30);
var n = 3;
bezier(100, 328, 100+cos(frameCount*n)*80, 310, 150+sin(frameCount*n)*80, 114, 100+sin(frameCount*n)*20, 123+cos(frameCount*n)*10);
pushMatrix();
translate(100+sin(frameCount*n)*20, 123+cos(frameCount*n)*10);
rotate(frameCount*n);
strokeWeight(20);
stroke(255, 77, 0);
fill(255, 166, 0);
beginShape();
var n = 5;
for(var i = 0; i < n; i++){
var a = (360/n)*i;
vertex(0+cos(a)*30,0+sin(a)*30);
var a3 = (360/n)*(i+0.5+cos((frameCount*15+a*123))*0.2);
var a2 = 50+cos((frameCount*15+a))*5;
vertex(0+cos(a3)*a2,0+sin(a3)*a2);
}
endShape(CLOSE);
popMatrix();
popMatrix();

popMatrix();
    },
    },
    // fan
    {
    name: 'Fan chicken',
    attack: 3,
    health: 1,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    plusCardHeight: 20,
    ability: function(lvl){
    var a = lvl*50;
    a = round(a);
    return 'Start of battle: set attack and health to '+a+'% of attack and health of the healthiest friend';
    },
    startOfBattle: function(t,lvl){
    var num = 0;
    var from = false;
    var num3 = 0;
    var all = allExceptForArray(eachChickenInTeam(t.teamId),[t]);
    for(var i = 0; i < all.length; i++){
    if(all[i].health > num && all[i] !== t){
    num = all[i].health;
    num3 = all[i].attack;
    from  = all[i];
    }
    }
    if(num && from){
    var num2 = 0.5*lvl;
    t.health = num*num2;
    t.health = round(t.health);
    t.attack = num3*num2;
    t.attack = round(t.attack);
    // from.x = t.x;
    // from.y = t.y;
    chickenFeed(from,t);
    }
    },
    img:false,
    loadImg: function(e){
pushMatrix();
translate(-21,0);
rotate(-22);
stroke(0,0,0);
strokeWeight(2);
line(0,15,0, -27);
fill(222, 0, 0);
beginShape();
vertex(0,-25);
vertex(0,-15);
vertex(-25,-15);
vertex(-15,-20);
vertex(-25,-25);
endShape(CLOSE);
popMatrix();
    },
    loadImgBehind:function(e){

pushMatrix();
fill(240, 0, 4);
noStroke();
//stroke(0,0,0);
translate(59,-24);
rotate(29);
scale(0.4,0.4);
beginShape();
    curveVertex(-111,30); curveVertex(-82,32); curveVertex(-91,45); curveVertex(-103,-45); curveVertex(-83,-45); curveVertex(-73,13); curveVertex(-59,-1); curveVertex(-45,10); curveVertex(-37,-5); curveVertex(-19,6); curveVertex(-8,41); curveVertex(-13,62); curveVertex(-16,84); curveVertex(-51,94); curveVertex(-70,82); curveVertex(-96,78); curveVertex(-111,30); curveVertex(-82,32); curveVertex(-91,45); /**/
    endShape();
popMatrix();
pushMatrix();
noFill();
stroke(255, 255, 255);
strokeWeight(4);
translate(59,-24);
rotate(29);
scale(0.4,0.4);
var a = {
x:-66,
y:5,
};

beginShape();
    curveVertex(-161,30); curveVertex(-83,32); curveVertex(-85,45); curveVertex(-96,-29); curveVertex(-91,-43); curveVertex(-77,25); curveVertex(-59,12); curveVertex(-41,22); curveVertex(-34,11); curveVertex(-27,9); curveVertex(-18,41); curveVertex(-22,62); curveVertex(-23,77); curveVertex(-45,86); curveVertex(-70,85); curveVertex(-84,78); curveVertex(-102,39); curveVertex(-82,36); curveVertex(-91,45); /**/
    endShape();
fill(255, 255, 255);
textSize(30);
textAlign(CENTER,CENTER);
pushMatrix();
rotate(-14);
text('#1',-66,40);
popMatrix();
popMatrix();

    },
    },
    // golden-brown
    {
    name: 'Golden-brown chicken',
    attack: 4,
    health: 2,
    size:1,
    discount: 0,
    tier: 2,
    bulletLife: 600,
    plusCardHeight: 10,
    ability: function(lvl){
    return 'Faint: give adjacent chickens +'+(lvl*2)+' attack and +'+(lvl*2)+' health';
    },
    faint: function(t,lvl){
    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    targs.push(targsa[i]);
    }
    for(var i = 0; i < targsb.length; i++){
    targs.push(targsb[i]);
    }
    if(t.coopId){
    for(var i = 0; i < targs.length; i++){
    var subj = t.coopId.c[targs[i]];
    if(subj){
    subj.attack += lvl*2;
    subj.health += lvl*2;
    feedProj(subj);
    }
    }
    }
    var splatter = new effect(t.x,t.y,'ghost',1,100,{type:'Golden-brown chicken'});
    },
    img:false,
    noBase:true,
    loadImgBehind:function(e){
    },
    loadImg: function(e){
    pushMatrix();
    translate(0,15);
    pushMatrix();
    scale(1,0.5);
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(196, 125, 19);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    popMatrix();
    pushMatrix();
    translate(0,17);
    pushMatrix();
    translate(0,-21);
    scale(0.1);
    strokeWeight(34);
    fill(235, 220, 108, 150);
    stroke(0,0,0);
    beginShape();
    curveVertex(-86,107); curveVertex(-83,3); curveVertex(-132,-45); curveVertex(-1,-58); curveVertex(114,-70); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
    popMatrix();
    //noStroke();
    strokeWeight(2);
    fill(255, 208, 0);
    pushMatrix();
    translate(-2,-27);
    scale(1,0.5);
    rotate(28);
    rect(0,0,10,10,2);
    popMatrix();
    popMatrix();
    popMatrix();
    }
    },
    // }
    // tier 3 {
    // spiky
    {
    name: 'Spiky chicken',
    attack: 3,
    health: 5,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardWidth: 10,
    ability: function(lvl){
    return 'Hurt: deal '+(lvl*2)+' damage to a random enemy';
    },
    hurt: function(t,lvl){
    if(scene === 'fight'){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachAliveInTeam(1-t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health -= lvl*2;
    throwAbilityProj(t,select,20,lvl*2,'dart');
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(0,0,0);
    strokeWeight(5);
    fill(153, 75, 75);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(102, 102, 102);
    ellipse(0,0,50,50);
    var num = 10;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    noStroke();
    fill(171, 171, 171);
    triangle(-5,0,5,0,0,-10);
    fill(219, 219, 219);
    triangle(-5,0,-1,0,0,-10);
    strokeWeight(2);
    stroke(0,0,0);
    noFill();
    triangle(-5,0,5,0,0,-10);
    popMatrix();
    }
    fill(153, 75, 75);
    ellipse(22,15,10,15);
    fill(186, 186, 186);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    line(-12,-10,-1,-7);
    },
    loadImgBehind: function(e){
    },
    },
    // pinata
    {
    name: 'Pinata chicken',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 35,
    ability: function(lvl,t){
    return 'Hurt: give friends above and below +'+(lvl*2)+' attack and +'+(lvl*2)+' health.\nWorks 4 times per turn\n('+(4-t.triggers)+' triggers left)';
    },
    hurt: function(t,lvl){
    if(t.triggers < 4){
    t.triggers++;
    var targs = getUpDown(t.coopPos);
    if(t.coopId){
    for(var i = 0; i < targs.length; i++){
    var subj = t.coopId.c[targs[i]];
    if(subj){
    subj.health+=lvl*2;
    subj.attack+=lvl*2;
    subj.checkStatUp();
    chickenFeed(t,subj);
    }
    }
    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

stroke(0,0,0);
    strokeWeight(5);
    fill(87, 185, 255);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 79, 223);
    rect(-25,-25,50,50,10);
    noStroke();
    fill(0, 216, 227);
    for(var q = 0; q < 5; q++){
    for(var i = 0; i < 8; i++){
    pushMatrix();
    translate(-25+i*7+cos(q*165)*3,-22+q*9);
    rotate(cos(i*97)*20);
    rect(0,0,5,10,1);
    popMatrix();
    }
    }
    stroke(0,0,0);
    fill(0, 216, 227);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);

    },
    loadImgBehind: function(e){
    },
    },
    // cool
    {
    name: 'Cool chicken',
    attack: 1,
    health: 3,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 25,
    ability: function(lvl){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'End turn: give '+lvl+' random friend'+a+' above, below, to the right, or to the left +1 attack and +2 health';
    },
    endTurn: function(t,lvl){
    if(t.coopId){
    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    targs.push(targsa[i]);
    }
    for(var i = 0; i < targsb.length; i++){
    targs.push(targsb[i]);
    }

    targs = filt(targs,function(item){
    if(t.coopId.c[item]){
    return true;
    }
    });

    for(var i = 0; i < lvl; i++){
    if(targs.length){
    var choice = floor(random(0,targs.length));
    var subj = t.coopId.c[targs[choice]];

    if(subj){
    subj.attack += 1;
    subj.health += 2;
    subj.checkStatUp();
    chickenFeed(t,subj);
    }
    targs.splice(choice,1);
    }
    }

    }
    },
    img:false,
        loadImg: function(e){

stroke(0,0,0);
strokeWeight(5);
fill(255, 255, 255);
ellipse(0,0,50,50);
pushMatrix();
translate(-5,-7);

stroke(0,0,0);
strokeWeight(5);
line(7,4,33,1);
line(0,4,-23,1);
strokeWeight(2);
line(3,17,6,24);
line(3,17,-4,15);
noStroke();
stroke(0,0,0);
strokeWeight(3);
fill(33, 33, 33);
var tilt = 5;
arc(6,0,20,28,tilt,180+tilt);
arc(38,-2,20,28,-tilt,180-tilt);
stroke(0, 0, 0);
line(16+32,-4,-4+32,0);
line(16,1,-4,-2);
popMatrix();
fill(255, 149, 0);
stroke(0,0,0);
strokeWeight(5);
triangle(15,-6,15,14,35,9);

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // nerd
    {
    name: 'Nerd chicken',
    attack: 4,
    health: 4,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 5,
    ability: function(lvl){
    return 'Start Of Battle: deal '+(4*lvl)+' damage to lowest health enemy';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachAliveInTeamThenAll(1-t.teamId);
    var lowest = Infinity;
    var select = false;
    for(var i = 0; i < options.length; i++){
        if(abs(options[i].health) < lowest){
            lowest = abs(options[i].health);
            select = options[i];
        }
    }
    if(select){
    select.health -= 4*lvl;
    throwAbilityProj(t,select,20,4*lvl,'dart');
    }
    },
    img:false,
    loadImg: function(e){

stroke(0,0,0);
strokeWeight(5);
fill(255, 255, 255);
//ellipse(0,0,50,50);
pushMatrix();
translate(-5,-7);

stroke(0,0,0);
strokeWeight(5);
line(16,4,33,1);
line(-7,4,-23,1);
strokeWeight(2);

//noStroke();
strokeWeight(3);
fill(186, 186, 186,100);
rectMode(LEFT);
rect(-5,0,18,10,1);
rect(28,-3,15,10,1);
noFill();
stroke(245, 245, 245);
strokeWeight(0.4);
rect(-5,0,18,10,1);
rect(28,-3,15,10,1);
popMatrix();
fill(255, 149, 0);
stroke(0,0,0);
strokeWeight(5);
triangle(15,-6,15,14,35,9);
noStroke();
fill(0,0,0);
beginShape();
vertex(-13,-8);
vertex(-25,0);
vertex(-31,-18);
vertex(-12,-29);
vertex(16,-28);
vertex(32,-10);
vertex(12,-16);
vertex(-9,-16);
endShape(CLOSE);

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // clown
    {
    name: 'Clown chicken',
    attack: 2,
    health: 2,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Friend or self levels up: Give whoever leveled up +'+(2*lvl)+' attack and +'+(2*lvl)+' health';
    },
    friendlyLevelUp: function(t,lvl){
    if(lastLeveled){
    lastLeveled.attack += lvl*2;
    lastLeveled.health += lvl*2;
    chickenFeed(t,lastLeveled);
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

    for(var q = 0; q < 2; q++){
    for(var i = -5; i < 10; i+=1.5){
    pushMatrix();
    translate(0,abs(i*2));
    rotate(i*5);

    if(q === 1){
    noStroke();
    var a = abs(i*(255/2));
    if(a <= 255){
    fill(255, a, 0);
    }else if(a <= 255*2){
    fill(255-(a-255), 255, 0);
    }else if(a <= 255*3){
    fill(0, 255, a-(255*2));
    }else if(a <= 255*4){
    fill(0, 255-(a-(255*3)), 255);
    }else if(a <= 255*5){
    fill(a-(255*4), 0, 255);
    }
    }else{
    fill(0,0,0);
    stroke(0,0,0);
    strokeWeight(5);
    }

    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-57);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,373);
    endShape();
    popMatrix();
    }
    }

    stroke(0,0,0);
    strokeWeight(03);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();

    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 255, 255);
    ellipse(0,0,50,50);

    pushMatrix();
    translate(1,-4);
    noStroke();
    pushMatrix();
    scale(1.3);
    translate(-2,-3);
    fill(217, 217, 217);
    rect(4,7,20,9,10);
    pushMatrix();
    rotate(28);
    ellipse(12,7,20,10);
    popMatrix();
    popMatrix();

    fill(255, 41, 41);
    rect(4,7,20,9,10);
    pushMatrix();
    rotate(28);
    ellipse(12,7,20,10);
    popMatrix();

    popMatrix();
    fill(217, 217, 217);
    ellipse(-8,-3,12,19);

    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    //triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);

stroke(0,0,0);
strokeWeight(5);
fill(255, 0, 0);
ellipse(27,3,20,20);

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // trainer
    {
    name: 'Trainer chicken',
    attack: 3,
    health: 4,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 55,
    ability: function(lvl){
    var a = round(lvl*33.3);
    return 'Start of battle: Give friends to the right '+a+'% of this chicken\'s attack and health\n(This chicken does not loose the stats)';
    },
    startOfBattle: function(t,lvl){
    var targs = getAllRight(t.coopPos);
    if(t.coopId){
    for(var i = 0; i < targs.length; i++){
    var subj = t.coopId.c[targs[i]];
    if(subj){
    var a = round(33.3*lvl)/100;
    subj.health+=round(t.health*a);
    subj.attack+=round(t.attack*a);
    subj.checkStatUp();
    chickenFeed(t,subj);
    }
    }
    }
    },
    img:false,
    loadImg: function(e){

pushMatrix();
scale(1.5);
translate(-18,-20);
rotate(-9);
stroke(0,0,0);
strokeWeight(3);


fill(255, 36, 36);
rect(0,0,30,14,4);
arc(15.5,4,30,15,180,360);

fill(247, 247, 247);
strokeWeight(1);
arc(24,11,15,15,162,360);
fill(255, 36, 36);
noStroke();
arc(24,11,8,8,162,360);

stroke(0,0,0);
strokeWeight(2);
fill(247, 247, 247);
rect(18,10.5,25,4,4);

popMatrix();
noStroke();
fill(255, 255, 255);
ellipse(-10,2,15,15);

fill(0,0,0);
ellipse(-2,1,5,10);
fill(245, 245, 245);
//ellipse(-1,-1,1.5,3);

stroke(0,0,0);
strokeWeight(5);
line(-12,-7,1,-4);
strokeWeight(1);
line(-10,9,-14,4);
line(-11,-8,-14,4);
strokeWeight(2);
line(-12,9,1,7);
line(-12,12,1,8);

pushMatrix();
translate(-27,14);
scale(1.2);
rotate(-27);
strokeWeight(2);
stroke(0,0,0);
fill(245, 245, 245);
ellipse(0,0,20,20);
fill(255, 0, 0);
arc(0,0,20,20,180,360);
strokeWeight(2);
line(-9,0,9,0);
fill(209, 209, 209);
ellipse(0,0,6,6);
popMatrix();
    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // priest
    {
    name: 'Priest chicken',
    attack: 3,
    health: 4,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 20,
    ability: function(lvl){
    var a = round(lvl*50);
    return 'Trashed: give left-most chicken in SHOP PAGE 1 '+a+'% of this\' attack and health';
    },
    trashed: function(t,lvl){
    for(var i = 0; i < shop[0].data.length; i++){
    // println(shop[0].data[i].IDENTIFIER);
    if(shop[0].data[i].IDENTIFIER === 'chicken'){
    var select = shop[0].data[i];
    var a = lvl*0.5;
    select.attack += round(t.attack*a);
    select.health += round(t.health*a);
    feedProj(select);
    i = shop[0].data.length;
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 177, 177);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(0,0,0);
    noStroke();
    arc(0,10,47,27,-15,168);
    fill(255, 255, 255);
    pushMatrix();
    rotate(-10);
    rect(-2,8,5,8,2);
    popMatrix();

    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);

    pushMatrix();
    translate(-21,6);
    scale(1.3);
    rotate(-14);
    strokeWeight(1.5);
    stroke(0,0,0);
    fill(110, 89, 55);
    beginShape();
    vertex(-2,-5);
    vertex(2,-5);
    vertex(2,0);
    vertex(7,0);
    vertex(7,4);
    vertex(2,4);
    vertex(2,14);
    vertex(-2,14);
    vertex(-2,4);
    vertex(-7,4);
    vertex(-7,0);
    vertex(-2,0);
    vertex(-2,-5);
    vertex(2,-5);
    endShape(CLOSE);
    popMatrix();

    },
    loadImgBehind: function(e){
pushMatrix();
translate(27,-16);
rotate(5);
strokeWeight(3);
stroke(0,0,0);
fill(115, 11, 11);
rect(0,0,20,26,5);
noStroke();
fill(201, 201, 201);
rect(0,1,20,26,5);
strokeWeight(3);
stroke(0,0,0);
fill(115, 11, 11);
rect(-3,3,20,26,5);
strokeWeight(3);
stroke(235, 166, 5);
line(7,10,7,23);
line(3,15,11,15);
popMatrix();
    },
    animImgStatic: function(e){
    },
    },
    // fat
    {
    name: 'Fat chicken',
    attack: 3,
    health: 5,
    size:1.05,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 10,
    ability: function(lvl){
    return 'Eats food: gain +'+(lvl*2)+' attack and +'+(lvl*2)+' health';
    },
    eatFood: function(t,lvl){
    t.attack += lvl*2;
    t.health += lvl*2;
    feedProj(t);
    t.temporaryScale = 1.3;
    },
    img:false,
    noBase:true,
    loadImg: function(e){

    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(13,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-23,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,65,50);

    fill(0,0,0);
    stroke(0,0,0);
    ellipse(16,11,10,24);
    ellipse(24,10,9,15);
    fill(227, 0, 0);
    noStroke();
    ellipse(16,11,10,24);
    ellipse(24,10,9,15);
    fill(0, 255, 234,180);
    ellipse(24,21,5,22);

    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(12,-6,9,14,35,9);
    strokeWeight(7);
    point(-22,-3);
    point(35,-15);

    noFill();
    strokeWeight(3);
    arc(-3,13,30,10,86,162);

    pushMatrix();
    translate(-48,27);
    rotate(-72);
    strokeWeight(2);
    stroke(0,0,0);
    fill(255, 184, 31);
    triangle(28,32,9,14,27,12);

    strokeWeight(1);
    fill(181, 16, 16);
    ellipse(17,15,5,5);
    ellipse(24,19,5,5);
    ellipse(23,26,5,5);

    pushMatrix();
    translate(6.5,10);
    rotate(-7);
    strokeWeight(2);
    stroke(0,0,0);
    fill(168, 82, 28);
    rect(0,0,21,4,2);
    popMatrix();
    popMatrix();

    },
    loadImgBehind: function(e){

    pushMatrix();
    translate(9,-7);
    rotate(-19);
    strokeWeight(2);
    stroke(0,0,0);
    fill(255, 184, 31);
    triangle(28,32,9,14,27,12);

    strokeWeight(1);
    fill(181, 16, 16);
    ellipse(17,15,5,5);
    ellipse(24,19,5,5);
    ellipse(23,26,5,5);

    pushMatrix();
    translate(6.5,10);
    rotate(-7);
    strokeWeight(2);
    stroke(0,0,0);
    fill(168, 82, 28);
    rect(0,0,21,4,2);
    popMatrix();
    popMatrix();
    },
    animImgStatic: function(e){
    },
    },
    // imposter
    {
    name: 'Imposter chicken',
    attack: 3,
    health: 2,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Faint: summon a 1/1 level '+lvl+' explosive chicken';
    },
    faint: function(t,lvl){
    if((t.coopPos||t.coopPos === 0)){
    var a = new chicken(300,300,stats.chicken['Explosive chicken']);
    if(lvl === 3){
    a.xp = 5;
    }else if(lvl === 2){
    a.xp = 2;
    }else{
    a.xp = 0;
    }
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = 1;
    a.health = 1;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[t.coopPos] = a;
    summonCheck(a);
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){


    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(171, 58, 75);
    rect(-36,-19,26,31,7);
    fill(245, 24, 57);
    rect(-25,-25,50,50,23);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(163, 163, 163);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(5);
    fill(0, 225, 255);
    rect(-9,-11,37,15,5);

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // butler
    {
    name: 'Butler chicken',
    attack: 1,
    health: 3,
    size:1,
    discount: 0,
    tier: 3,
    bulletLife: 600,
    plusCardHeight: 5,
    ability: function(lvl){
    return 'Chicken friend or self eats food: give it +'+(lvl*2)+' health';
    },
    chickenFriendEatsFood: function(t,lvl){
    if(lastFed){
    lastFed.health += lvl*2;
    chickenFeed(t,lastFed);
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(0, 0, 0);
    noStroke();
    arc(0,10,47,27,-15,168);
    fill(224, 224, 224);
    pushMatrix();
    rotate(-9);
    stroke(82, 82, 82);
    strokeWeight(2);
    triangle(1,26,-4,9.5,6,9.5);
    noStroke();
    fill(51, 51, 51);
    triangle(1,13,7,16,7,10);
    triangle(1,13,-5,16,-5,10);
    fill(0,0,0);
    ellipse(1,13,4,4);
    ellipse(1,17,2,2);
    ellipse(1,21,2,2);
    popMatrix();

    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    },
    loadImgBehind: function(e){
    },
    animImg: function(e){
    pushMatrix();
    translate(-17,20);
    rotate(cos(frameCount*1.23)*5-6);

    pushMatrix();
    translate(-24,-6);
    scale(0.8);
    rotate(-43);
    strokeWeight(2);
    stroke(0,0,0);
    fill(255, 184, 31);
    triangle(28,32,9,14,27,12);

    strokeWeight(1);
    fill(181, 16, 16);
    ellipse(17,15,5,5);
    ellipse(24,19,5,5);
    ellipse(23,26,5,5);

    pushMatrix();
    translate(6.5,10);
    rotate(-7);
    strokeWeight(2);
    stroke(0,0,0);
    fill(168, 82, 28);
    rect(0,0,21,4,2);
    popMatrix();
    popMatrix();

    strokeWeight(2);
    stroke(191, 191, 191);
    fill(189, 189, 189,150);
    arc(0,0,35,40,180,360);
    fill(74, 74, 74);
    ellipse(0,-22,5,5);
    strokeWeight(5);
    stroke(99, 99, 99);
    line(-20,0,20,0);

    popMatrix();
    },
    },

    // }
    // tier 4 {
    // librarian
    {
    name: 'Librarian chicken',
    attack: 2,
    health: 5,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 80,
    ability: function(lvl){
    var percent = round(lvl*33.2);
    return 'Start of battle: faint a random adjacent chicken and gain '+percent+'% of its attack and health (unless health is negative). Summon it with 1 health after fainting.';
    },
    startOfBattle: function(t,lvl){
    if(t.coopPos || t.coopPos === 0){

    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    if(t.coopId.c[targsa[i]] && t.coopId.c[targsa[i]].health > 0){
    targs.push(targsa[i]);
    }
    }
    for(var i = 0; i < targsb.length; i++){
    if(t.coopId.c[targsb[i]] && t.coopId.c[targsb[i]].health > 0){
    targs.push(targsb[i]);
    }
    }
    if(targs.length > 0){
    var i = targs[floor(random(0,targs.length))];
    var subj = t.coopId.c[i];
    if(subj){
    var a = 0.33*lvl;
    if(subj.health > 0){
    t.health+=round(subj.health*a);
    }
    t.attack+=round(subj.attack*a);
    t.spitSave = {
        name:subj.stats.name,
        health: 1,
        attack: subj.attack,
        xp:subj.xp,
    };

    chickenFeed(subj,t);
    subj.health = -99;
    updateStats(subj);
    subj.checkStatUp();
    subj.invis = true;
    }
    }
    }
    //ee
    },
    faint: function(t,lvl){
    if((t.coopPos||t.coopPos === 0) && t.spitSave){
    var a = new chicken(300,300,stats.chicken[t.spitSave.name]);
    a.xp = t.spitSave.xp;
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = t.spitSave.attack;
    a.health = t.spitSave.health;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[t.coopPos] = a;
    summonCheck(a);
    }
    },
    img:false,
    loadImg: function(e){

    stroke(158, 158, 158);
    strokeWeight(2);
    fill(0, 255, 213,50);
    rect(-16,-10,15,11,3);
    line(-16,-8,-26,-10);

    },
    loadImgBehind: function(e){
    },
    animImg: function(e){
    var a2 = 0;
var a3 = ceil(e.health/33)+4;
for(var i = a3; i > -1; i--){
pushMatrix();
var a = 2;
var h = sin(i*112233)*2+6;
var h2 = sin(i*860)*2+10;
a2 += h*2-1;
translate(16+(a3-i)*sin(frameCount)*1.5,23-a2+cos(frameCount*1.5)*3);
scale(1.5);
rotate((a3-i)*sin(frameCount)*3);
stroke(0,0,0);
strokeWeight(1);
fill(220+sin(i*1234)*10);

rect(-h2-1,0,h2*2,h,3);
fill(125+sin(i*1234)*20, 76+sin(i*1234)*20, 52+sin(i*1234)*20);
beginShape();
vertex(h2,0);
vertex(h2,a);
vertex(-h2,a);
vertex(-h2,h);
vertex(h2,h);
vertex(h2,h+a);
vertex(-h2+2-a,h+a);
vertex(-h2-a,h-1+a);
vertex(-h2-a,1);
vertex(-h2+2-a,0);
endShape(CLOSE);
popMatrix();
}
    },
    },
    // stinky
    {
    name: 'Stinky chicken',
    attack: 3,
    health: 5,
    size:0.9,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight:20,
    ability: function(lvl){
    var a = lvl*33;
    a = round(a);
    return 'Start of battle: remove '+a+'% of health from the healthiest enemy, rounded down';
    },
    startOfBattle: function(t,lvl){
    var num = 0;
    var from = false;

    var all = eachChickenInTeam(1-t.teamId);
    for(var i = 0; i < all.length; i++){
    if(all[i].health > num){
    num = all[i].health;
    from  = all[i];
    }
    }
    if(num && from){
    var num2 = floor(from.health*(0.33*lvl));
    from.health -= num2;
    throwAbilityProj(t,from,10,num2,'special');
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(181, 181, 181);
    pushMatrix();
    translate(-106,-72);
    beginShape();
    vertex(111,32);
    bezierVertex(124,77,175,90,110,103);
    bezierVertex(53,96,62,77,107,35);
    endShape();
    popMatrix();
    noFill();
    stroke(173, 173, 173);
    pushMatrix();
    translate(-6,-40);
    rotate(27);
    ellipse(0,0,20,10);
    popMatrix();
    pushMatrix();
    translate(10,-40);
    rotate(-34);
    ellipse(0,0,20,10);
    popMatrix();
    stroke(0,0,0);
    arc(-6,16,30,10,39,187);
    stroke(209, 209, 209);
    arc(12,-23,10,24,134,175);
    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    },
    loadImgBehind:function(e){

    },
    animImg:function(e){

pushMatrix();
translate(0+cos(frameCount)*40,-30+sin(frameCount*1.2)*6);
noStroke();
fill(143, 143, 143,150);
ellipse(0,-2,2,5);
fill(0,0,0);
ellipse(0,0,6,4);
fill(143, 143, 143,150);
ellipse(0,2,2,5);
popMatrix();
pushMatrix();
translate(0+cos(frameCount*1.2+270)*35,-25+sin(frameCount*1.4+70)*6);
noStroke();
fill(143, 143, 143,150);
ellipse(0,-2,2,5);
fill(0,0,0);
ellipse(0,0,6,4);
fill(143, 143, 143,150);
ellipse(0,2,2,5);
popMatrix();
    },
    },
    // artist
    {
    name: 'Chicken artist',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 30,
    ability: function(lvl){
    return 'End turn: give up to 3 random level 2 and 3 friends +'+lvl+' attack and +'+lvl+' health';
    },
    endTurn: function(t,lvl){
    var options = filt(allMyChickensExceptForArray([t]),function(e){
    if(e.lvl >= 2){
    return true;
    }
    return false;
    });
    if(options.length > 0){
    for(var i = 0; i < 3; i++){
        if(options.length > 0){
            var select = chooseFrom(options);
            select.attack += lvl;
            select.health += lvl;
            chickenFeed(t,select);
            var index = options.indexOf(select);
            if(index >= 0){
            options.splice(index,1);
            }
        }
    }
    }else{
    t.bad = 30;
    t.badMessage = 'No Friends';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
translate(5,42);
scale(0.3);
rotate(7);
strokeWeight(11);
stroke(0,0,0);
fill(214, 208, 184);
beginShape();
    curveVertex(-154,-57);
    curveVertex(-133,-103);
    curveVertex(-85,-124);
    curveVertex(-54,-103);
    curveVertex(-64,-76);
    curveVertex(-55,-59);
    curveVertex(-32,-69);
    curveVertex(-22,-51);
    curveVertex(-58,-26);
    curveVertex(-120,-16);
    curveVertex(-154,-57);
    curveVertex(-133,-103); 
    curveVertex(-85,-124);
endShape();
fill(255,255,255);
ellipse(-87,-97,23,18);
noStroke();
    var a2 = 6;
    for(var i = 1; i < a2+1; i++){
    var a = (i-1)*((255*6)/a2);
    var r = i*38 + 4;
    if(a <= 255){
    fill(255, a, 0);
    }else if(a <= 255*2){
    fill(255-(a-255), 255, 0);
    }else if(a <= 255*3){
    fill(0, 255, a-(255*2));
    }else if(a <= 255*4){
    fill(0, 255-(a-(255*3)), 255);
    }else if(a <= 255*5){
    fill(a-(255*4), 0, 255);
    }
    ellipse(-104+cos(r)*30,-61+sin(r)*30,16+sin(i*133)*4,16+sin(i*319)*4);
    }
    fill(163, 163, 163);
    ellipse(-100,-62,27,18);

popMatrix();

    },
    loadImgBehind: function(e){
    pushMatrix();
translate(18,15);
rotate(36);

noStroke();
fill(189, 176, 136);
pushMatrix();
translate(0,-10);
rotate(90);
scale(0.13);
beginShape();
vertex(-405,180);
curveVertex(-190,2);
vertex(-290,2);
endShape(CLOSE);
beginShape();
vertex(-405,-180);
curveVertex(-190,-2);
vertex(-290,-2);
endShape(CLOSE);
popMatrix();

strokeWeight(4);
stroke(117, 67, 17);
line(0,0,0,-30);
strokeWeight(5);
stroke(150, 150, 150);
line(0,-29,0,-33);

noStroke();
fill(49, 118, 222);
pushMatrix();
translate(1,-43);
rotate(71);
ellipse(0,0,7,3);
popMatrix();



popMatrix();
    },
    animImgStatic: function(e){
    },
    },
    // steampunk
    {
    name: 'Steampunk chicken',
    attack: 4,
    health: 4,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 15,
    ability: function(lvl){
    return 'Start of turn: gain +'+lvl+'/+'+lvl+' for each friendly contraption, up to a maximum of +'+(lvl*3)+'/+'+(lvl*3);
    },
    startOfTurn: function(t,lvl){
    var num = myContraptions.length*lvl;
    if(num > lvl*3){
    num = lvl*3;
    }
    t.attack += num;
    t.health += num;
    feedProj(t);
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    // behind
    for(var i = 0; i < 3; i++){
    strokeWeight(2);
    stroke(0,0,0);
    pushMatrix();
    translate(12+i*10,-38+i*8);
    rotate(80+i*20);
    fill(107, 107, 107);
    rect(-11,2,20,6,2);
    fill(156, 156, 156);
    rect(2,0,12,10,2);
    strokeWeight(1);
    stroke(166, 134, 53);
    line(6,3,10,3);
    line(6,3,6,5);
    stroke(0,0,0);
    point(-8,5);
    point(-5,5);
    point(-2,5);
    point(1,5);
    popMatrix();
    }
    // behind

    stroke(0,0,0);
    strokeWeight(5);
    fill(122, 86, 43);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    noStroke();
    fill(158, 145, 121);
    ellipse(0,0,50,50);

    // engravings
    strokeWeight(2);
    stroke(189, 132, 0);
    line(-15,-19,-5,0);
    line(-15,18,-5,0);
    line(-15,18,18,0);
    stroke(110, 110, 110);
    strokeWeight(6);
    line(3,1,3,-16);
    strokeWeight(4);
    stroke(0, 145, 145);
    line(3,1,3,-8);
    stroke(242, 242, 242,50);
    line(3,1,3,-16);

    noFill();
    stroke(0,0,0);
    strokeWeight(5);
    ellipse(0,0,50,50);

    strokeWeight(3);
    fill(173, 130, 66);
    rect(17,8,10,15,2);
    strokeWeight(2);
    point(21,20);
    point(24,20);
    point(21,17);
    point(24,17);
    point(24,14);


stroke(0,0,0);
strokeWeight(2);
fill(150, 112, 15);
ellipse(-8,-3,10,10);
noStroke();
fill(201, 160, 56);
ellipse(-7,-4,4,4);
stroke(0,0,0);
strokeWeight(1);
fill(120, 222, 212);
ellipse(-4,0,4,4);
fill(94, 94, 94);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    // front

    fill(156, 156, 156);
    strokeWeight(2);
    stroke(0,0,0);
    pushMatrix();
    translate(7,8);
    rotate(-11);
    line(-5,5,10,5);
    rect(2,0,12,10,2);
    rect(-6,0,4,10,2);
    strokeWeight(1);
    stroke(166, 134, 53);
    line(6,3,10,3);
    line(6,3,6,5);
    popMatrix();

// forehead gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(217, 217, 217);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(4);
}
translate(13,-18);
ellipse(0,0,8,8);
for(var i = 0; i < 360; i += 360/5){
    pushMatrix();
    rotate(i);
    rect(0,-1,6,2);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// under eye gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(145, 145, 145);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(4);
}
translate(-10,10);
ellipse(0,0,6,6);
for(var i = 0; i < 360; i += 360/5){
    pushMatrix();
    rotate(i);
    rect(0,-1,5,2);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// behind eye gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(209, 153, 0);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(2);
}
translate(-2,-7);
ellipse(0,0,4,4);
for(var i = 0; i < 360; i += 360/6){
    pushMatrix();
    rotate(i);
    rect(0,-0.5,3,1);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// clock
stroke(0,0,0);
strokeWeight(2);
fill(201, 158, 48);
ellipse(-22,-6,12,12);
point(-22,-6);
var a = 45;
strokeWeight(1);
line(-22,-6,-22+cos(a)*4,-6+sin(a)*4);


    // front

    },
    // animated images were too laggy
    animImgBehindTOLAGGY: function(e){
    for(var i = 0; i < 3; i++){
    strokeWeight(2);
    stroke(0,0,0);
    pushMatrix();
    translate(12+i*10,-38+i*8);
    rotate(80+i*20);
    translate(sin(frameCount*4+i*120)*1.5,-0);
    fill(107, 107, 107);
    rect(-11,2,20,6,2);
    fill(156, 156, 156);
    rect(2,0,12,10,2);
    strokeWeight(1);
    stroke(166, 134, 53);
    line(6,3,10,3);
    line(6,3,6,5);
    stroke(0,0,0);
    point(-8,5);
    point(-5,5);
    point(-2,5);
    point(1,5);
    popMatrix();
    }
    },
    animImgTOLAGGY: function(e){

    fill(156, 156, 156);
    strokeWeight(2);
    stroke(0,0,0);
    pushMatrix();
    translate(7+sin(frameCount),8);
    rotate(-11);
    line(-5,5,10,5);
    rect(2,0,12,10,2);
    rect(-6,0,4,10,2);
    strokeWeight(1);
    stroke(166, 134, 53);
    line(6,3,10,3);
    line(6,3,6,5);
    popMatrix();

// forehead gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(217, 217, 217);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(4);
}
translate(13,-18);
ellipse(0,0,8,8);
for(var i = 0; i < 360; i += 360/5){
    pushMatrix();
    rotate(i+frameCount);
    rect(0,-1,6,2);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// under eye gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(145, 145, 145);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(4);
}
translate(-10,10);
ellipse(0,0,6,6);
for(var i = 0; i < 360; i += 360/5){
    pushMatrix();
    rotate(i+frameCount/1.5);
    rect(0,-1,5,2);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// behind eye gear
for(var q = 0; q < 2; q++){
pushMatrix();
if(q === 1){
noStroke();
fill(209, 153, 0);
}else{
stroke(0,0,0);
fill(0,0,0);
strokeWeight(2);
}
translate(-2,-7);
ellipse(0,0,4,4);
for(var i = 0; i < 360; i += 360/6){
    pushMatrix();
    rotate(i+sin(frameCount/2)*90);
    rect(0,-0.5,3,1);
    popMatrix();
}
stroke(92, 92, 92);
strokeWeight(3);
point(0,0);
popMatrix();
}

// clock
stroke(0,0,0);
strokeWeight(2);
fill(201, 158, 48);
ellipse(-22,-6,12,12);
point(-22,-6);
var a = round(frameCount/60)*20;
strokeWeight(1);
line(-22,-6,-22+cos(a)*4,-6+sin(a)*4);

    },
    },
    // petite
    {
    name: 'Petite chicken',
    attack: 1,
    health: 1,
    size:0.9,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Faint: summon a '+(lvl*10)+'/'+(lvl*10)+' level '+lvl+' big chicken';
    },
    faint: function(t,lvl){
    if((t.coopPos||t.coopPos === 0)){
    var a = new chicken(300,300,stats.chicken['Big chicken']);
    if(lvl === 3){
    a.xp = 5;
    }else if(lvl === 2){
    a.xp = 2;
    }else{
    a.xp = 0;
    }
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = 10*lvl;
    a.health = 10*lvl;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[t.coopPos] = a;
    summonCheck(a);
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    pushMatrix();
    scale(0.8);
    translate(0,15);
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    popMatrix();
    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // hazmat
    {
    name: 'Hazmat chicken',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 15,
    ability: function(lvl){
    var a = 'y';
    if(lvl > 1){
        a = 'ies';
    }
    return 'Start of battle: deal damage equal to all friendly levels, added up, to '+lvl+' random enem'+a;
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var num = 0;
    var a = eachInTeam(t.teamId);
    for(var i = 0; i < a.length; i++){
    num += getLevel(a[i].xp);
    }
    var options = eachAliveInTeamThenAll(1-t.teamId);
    for(var i = 0; i < lvl; i++){
    if(options.length > 0){
    var a2 = floor(random(0,options.length));
    var select = options[a2];
    select.health -= round(num);
    throwAbilityProj(t,select,10,round(num),'bomb');
    options.splice(a2,1);
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
   stroke(0,0,0);
    strokeWeight(5);
    fill(112, 112, 112);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(209, 222, 64);
    ellipse(0,0,50,50);
    fill(97, 97, 97);
    //ellipse(22,15,10,15);

    stroke(0,0,0);
    strokeWeight(7);
    point(-7,-3);

    stroke(0,0,0);
    strokeWeight(3);
    fill(191, 191, 191,220);
    pushMatrix();
    translate(-14,-10);
    rotate(4);
    rect(0,0,39,12,2);
    popMatrix();

    stroke(0,0,0);
    strokeWeight(3);
    fill(41, 41, 41);
    pushMatrix();
    translate(14,-4);
    rotate(12);
    rect(0,0,20,16,2);
    popMatrix();
    fill(112, 112, 112);
    pushMatrix();
    translate(18,12);
    ellipse(0,0,15,15);
    popMatrix();

    pushMatrix();
    translate(-8,13);
    noFill();
    stroke(0,0,0);
    strokeWeight(1);
    ellipse(0,0,10,10);
    fill(0,0,0);
    noStroke();
    arc(0,0,8,8,60,120);
    arc(0,0,8,8,180,240);
    arc(0,0,8,8,300,360);
    stroke(209, 222, 64);
    strokeWeight(3);
    point(0,0);
    stroke(0, 0, 0);
    strokeWeight(2);
    point(0,0);
    popMatrix();


    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // diver
    {
    name: 'Diver chicken',
    attack: 5,
    health: 5,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Start of turn: gain +'+lvl+' gold for each empty adjacent spot';
    },
    startOfTurn: function(t,lvl){
    var num = 0;
    if(t.coopPos || t.coopPos === 0){
    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    if(!t.coopId.c[targsa[i]]){
    num++;
    }
    }
    for(var i = 0; i < targsb.length; i++){
    if(!t.coopId.c[targsb[i]]){
    num++;
    }
    }
    if(num){
    t.temporaryScale = 1.4;
    gold += num*lvl;
    coinAnim.s = 1.4;
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
   pushMatrix();
   scale(0.87);

    stroke(0,0,0);
    strokeWeight(5);
    fill(163, 163, 163);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-6,-60);
    curveVertex(-10,-37);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(10,-6,10,14,30,9);
    strokeWeight(7);
    point(-8,-3);

    noStroke();
    fill(0, 255, 242,150);
    ellipse(0,0,40,40);

    strokeWeight(8);
    stroke(0, 0, 0);
    noFill();
    ellipse(0,0,62,62);
    ellipse(0,0,38,38);

    strokeWeight(12);
    stroke(219, 143, 13);
    noFill();
    ellipse(0,0,50,50);


    for(var i = 18; i < 360; i+=360/5){
        strokeWeight(3);
        stroke(0,0,0);
        fill(94, 94, 94);
        var a = 24;
        ellipse(cos(i)*a,sin(i)*a,8,8);
    }

    strokeWeight(5);
    stroke(209, 161, 58);
    fill(149, 197, 201);
    ellipse(-32,0,11,32);
    ellipse(32,0,11,32);
    strokeWeight(4);
    stroke(0,0,0);
    fill(149, 197, 201);
    ellipse(-34,0,11,32);
    ellipse(34,0,11,32);
    strokeWeight(2);
    line(-38,-10,-30,0);
    line(-38,0,-30,10);
    line(38,10,30,0);
    line(38,0,30,-10);

    strokeWeight(4);
    stroke(0, 0, 0);
    fill(128, 121, 107);
    rect(-15,-38,28,10,3);
    noFill();
    strokeWeight(9);
    stroke(0, 0, 0);
    arc(0,-34,12,14,180,360);
    strokeWeight(5);
    stroke(189, 189, 189);
    arc(0,-34,12,14,180,360);

    popMatrix();
    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // influencer
    {
    name: 'Influencer chicken',
    attack: 4,
    health: 5,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 15,
    ability: function(lvl){
    return 'End turn: gain +'+lvl+'/+'+lvl+' for each empty space in the same coop, up to a maximum of +'+(lvl*3)+'/+'+(lvl*3);
    },
    endTurn: function(t,lvl){
    var num = 0;
    if(t.coopPos || t.coopPos === 0){
    for(var i = 0; i < t.coopId.c.length; i++){
    if(!t.coopId.c[i]){
    num++;
    }
    }
    if(num){
    num *= lvl;
    if(num > lvl*3){
    num = lvl*3;
    }
    t.attack += num;
    t.health += num;
    feedProj(t);
    }
    }

    },
    img:false,
    noBase:true,
    loadImg: function(e){

pushMatrix();
translate(13,17);
rotate(-58);
stroke(125, 125, 125);
strokeWeight(4);
line(10,3,41,3);
strokeWeight(3);
line(10,3,52,3);
strokeWeight(2);
line(10,3,65,3);
line(69,-8,65,3);
stroke(71, 71, 71);
strokeWeight(4);
line(68,-13,63,0);
strokeWeight(2);
stroke(181, 181, 181);
point(69,-11);
stroke(0,0,0);
strokeWeight(2);
fill(156, 108, 50);
rect(9,0,20,5,2);
popMatrix();


    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 0, 225);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(255, 0, 225);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    noStroke();
    fill(255, 150, 253);
    triangle(-8,-5,-8,-1,-17,0);

    stroke(0,0,0);
    strokeWeight(7);
    point(-8,-3);

pushMatrix();
translate(-29,18);
rotate(-17);
scale(0.7);

pushMatrix();
translate(-0.5,-0.5);
stroke(0,0,0);
strokeWeight(5);
fill(255, 51, 109);
rect(0,-21,20,8,3);
rect(1,-29,18,9,5);
fill(235, 235, 235);
rect(0,-7,20,8,3);
rect(0,-14,20,8,3);
rect(6,-32,8,5,3);
fill(148, 148, 148);
rect(5,-34,10,5,2);
fill(0, 247, 255);
rect(0,0,20,8,3);
rect(0,7,20,8,3);
popMatrix();

noStroke();
fill(255, 51, 109);
rect(0,-21,20,8,3);
rect(1,-29,18,9,5);
fill(235, 235, 235);
rect(0,-7,20,8,3);
rect(0,-14,20,8,3);
rect(6,-32,8,5,3);
fill(148, 148, 148);
rect(5,-34,10,5,2);
fill(0, 247, 255);
rect(0,0,20,8,3);
rect(0,7,20,8,3);

pushMatrix();
translate(15,-21);
rotate(90);
scale(0.5);
for(var i = 0; i < 2; i++){
if(i === 0){
    fill(0,0,0);
    strokeWeight(4);
    stroke(0,0,0);
}else{
    noStroke();
    fill(235, 235, 235);
}
rect(1,0,4,18);
arc(5,5,15,10,-95,95);
rect(14,0,4,18);
rect(17,0,8,4);
rect(17,7,8,4);
rect(17,14,8,4);
//arc(33,10,12,20,160,380);
//rect(27,10,4,8);
//rect(35,10,4,8);
triangle(27,18,39,18,33,3);
rect(41,0,4,18);
quad(44,12,50,18,56,18,44,7);
quad(46,12,55,0,50,0,44,7);

strokeWeight(2);
stroke(0,0,0);
line(6,3,6,7);
noStroke();
fill(0,0,0);
triangle(31,18,35,18,33,12);
}
popMatrix();


popMatrix();


    },
    loadImgBehind: function(e){
    },
    animImg: function(e){
        noStroke();
fill(224, 242, 58,(sin(frameCount*(1+abs(sin(e.id))))-0.9)*(100/0.1));
triangle(38,-44,25,-43,38,-30);
    },
    },
    // nurse
    {
    name: 'Nurse chicken',
    attack: 2,
    health: 5,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 40,
    ability: function(lvl,t){
    return 'Hurt: give all friends in the same coop +'+lvl+' attack and +'+lvl+' health\nWorks 4 times per turn\n('+(4-t.triggers)+' triggers left)';
    },
    hurt: function(t,lvl){
    if(t.triggers < 4){
    t.triggers++;
    if(t.coopId){
    for(var i = 0; i < t.coopId.c.length; i++){
    if(i !== t.coopPos){
    var subj = t.coopId.c[i];
    if(subj){
    subj.health+=lvl;
    subj.attack+=lvl;
    subj.checkStatUp();
    chickenFeed(t,subj);
    }
    }
    }
    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(-5,-37);
rotate(-7);

stroke(0,0,0);
strokeWeight(3);
fill(235, 235, 235);
beginShape();
vertex(0,0);
curveVertex(0,-5);
curveVertex(20,5);
vertex(22,9);
curveVertex(12,21);
curveVertex(-12,21);
vertex(-22,9);
curveVertex(-20,5);
curveVertex(0,-5);
endShape(CLOSE);
stroke(0,0,0);
strokeWeight(4);
pushMatrix();
translate(-0.5,-0.5);
fill(0,0,0);
rect(-3,2,6,16,2);
rect(-8,7,16,6,2);
popMatrix();
noStroke();
fill(255, 41, 41);
rect(-3,2,6,16,2);
rect(-8,7,16,6,2);

popMatrix();



pushMatrix();
translate(-23,19);
rotate(-116);

noStroke();
fill(194, 194, 194,150);
rect(1,0,24,10,2);

fill(0, 255, 38,150);
rect(13,0,12,10,2);


stroke(171, 171, 171);
strokeWeight(2);
line(-11,5,13,5);
line(-11,2,-11,8);
stroke(128, 128, 128);
strokeWeight(3);
line(13,2,13,9);

fill(194, 194, 194,50);
stroke(0,0,0);
strokeWeight(2);
rect(1,0,24,10,2);
line(26,5,38,5);
strokeWeight(1);
for(var i = 6; i < 24; i+= 5){
line(i,1,i,4);
}

popMatrix();

    },
    loadImgBehind: function(e){
    },
    },
    // scientist
    {
    name: 'Scientist chicken',
    attack: 1,
    health: 3,
    size:1,
    discount: 0,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 15,
    ability: function(lvl){
    return 'End turn: give a random level 1, 2, and 3 friend +'+lvl+'/+'+lvl;
    },
    endTurn: function(t,lvl){
    var options = filt(allMyChickensExceptForArray([t]),function(e){
    if(e.lvl === 1){
    return true;
    }
    return false;
    });
    if(options.length > 0){
            var select = chooseFrom(options);
            select.attack += lvl;
            select.health += lvl;
            chickenFeed(t,select);
    }
    var options = filt(allMyChickensExceptForArray([t]),function(e){
    if(e.lvl === 2){
    return true;
    }
    return false;
    });
    if(options.length > 0){
            var select = chooseFrom(options);
            select.attack += lvl;
            select.health += lvl;
            chickenFeed(t,select);
    }
    var options = filt(allMyChickensExceptForArray([t]),function(e){
    if(e.lvl === 3){
    return true;
    }
    return false;
    });
    if(options.length > 0){
            var select = chooseFrom(options);
            select.attack += lvl;
            select.health += lvl;
            chickenFeed(t,select);
    }
    },
    img:false,
    loadImg: function(e){

pushMatrix();
translate(0,0);
scale(1,0.8);
rotate(0);
stroke(0,0,0);
strokeWeight(2);
fill(82, 82, 82);
beginShape();
vertex(-13,-22);
vertex(-25,0);
vertex(-31,-18);
vertex(-29,-35);
vertex(-21,-34);
vertex(-20,-51);
vertex(-17,-42);
vertex(-4,-53);
vertex(-9,-39);
vertex(9,-64);
vertex(8,-50);
vertex(17,-69);
vertex(19,-56);
vertex(10,-35);
vertex(23,-60);
vertex(19,-39);
vertex(23,-51);
vertex(26,-29);
vertex(20,-15);
vertex(12,-19);
vertex(-9,-18);
endShape(CLOSE);
noStroke();
fill(255, 255, 255);
beginShape();
vertex(11,-50);
vertex(16,-62);
vertex(16,-56);
vertex(8,-39);
vertex(-10,-20);
endShape(CLOSE);
popMatrix();

stroke(0,0,0);
fill(0,0,0);
strokeWeight(6);
ellipse(-8,-3,13,13);
strokeWeight(2);
line(-8,-6,14,-5);
stroke(181, 117, 13);
strokeWeight(3);
fill(0, 230, 150);
ellipse(-8,-3,13,13);

stroke(0,0,0);
fill(0,0,0);
strokeWeight(4);
ellipse(-5,-1,5,5);
strokeWeight(2);
line(-5,-1,8,-5);
stroke(153, 97, 6);
strokeWeight(2);
fill(112, 245, 234);
ellipse(-5,-1,5,5);

pushMatrix();
translate(-24,10);
rotate(-12);

stroke(0,0,0);
fill(20, 250, 66);
strokeWeight(3);

beginShape();
vertex(0,48);
curveVertex(0,0);
curveVertex(10,15);
curveVertex(-10,15);
curveVertex(0,0);
endShape(CLOSE);
fill(207, 207, 207);
pushMatrix();
translate(-0.5,-0.5);
rect(-3,-7,6,8,1);
popMatrix();
ellipse(0,-7,8,3);

popMatrix();

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // }
    // tier 5 {
    // mage
    {
    name: 'Mage chicken',
    attack: 3,
    health: 4,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 20,
    ability: function(lvl){
    return 'Faint or Start of turn: summon a random tier 1 '+(lvl*4)+'/'+(lvl*4)+' level 1 chicken in each adjacent space';
    },
    faint: function(t,lvl){
    if((t.coopPos||t.coopPos === 0)){

    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    if(!t.coopId.c[targsa[i]]){
    targs.push(targsa[i]);
    }
    }
    for(var i = 0; i < targsb.length; i++){
    if(!t.coopId.c[targsb[i]]){
    targs.push(targsb[i]);
    }
    }
    for(var i = 0; i < targs.length; i++){
    var a = getRand(1,'chicken',300,300);
    if(lvl === 3){
    a.xp = 5;
    }else if(lvl === 2){
    a.xp = 2;
    }else{
    a.xp = 0;
    }
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = 4*lvl;
    a.health = 4*lvl;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[targs[i]] = a;
    summonCheck(a);
    }
    }
    },
    startOfTurn: function(t,lvl){
    if((t.coopPos||t.coopPos === 0)){

    var targsa = getLeftRight(t.coopPos);
    var targsb = getUpDown(t.coopPos);
    var targs = [];
    for(var i = 0; i < targsa.length; i++){
    if(!t.coopId.c[targsa[i]]){
    targs.push(targsa[i]);
    }
    }
    for(var i = 0; i < targsb.length; i++){
    if(!t.coopId.c[targsb[i]]){
    targs.push(targsb[i]);
    }
    }
    for(var i = 0; i < targs.length; i++){
    var a = getRand(1,'chicken',300,300);
    if(lvl === 3){
    a.xp = 5;
    }else if(lvl === 2){
    a.xp = 2;
    }else{
    a.xp = 0;
    }
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = 4*lvl;
    a.health = 4*lvl;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[targs[i]] = a;
    summonCheck(a);
    }
    }
    },
    img:false,
    noBase:false,
    loadImg: function(e){
    pushMatrix();
translate(-16,-57);
rotate(-15);
scale(1.2);

stroke(0,0,0);
strokeWeight(3);
fill(60, 120, 176);
triangle(0,-12,15,30,-15,30);
noStroke();
fill(236, 245, 171);
pushMatrix();
translate(6,23);
rotate(0);
beginShape();
for(var i = 0; i < 5; i++){
vertex(0+cos(i*(360/5))*4,0+sin(i*(360/5))*4);
vertex(0+cos(i*(360/5)+36)*2,0+sin(i*(360/5)+36)*2);
}
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(0,6);
rotate(-24);
beginShape();
for(var i = 0; i < 5; i++){
vertex(0+cos(i*(360/5))*4,0+sin(i*(360/5))*4);
vertex(0+cos(i*(360/5)+36)*2,0+sin(i*(360/5)+36)*2);
}
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(-5,11);
rotate(12);
scale(0.6,0.7);
beginShape();
vertex(0,0);
curveVertex(0,0);
curveVertex(12,10);
curveVertex(0,20);
curveVertex(6,10);
vertex(0,0);
endShape(CLOSE);
popMatrix();
stroke(194, 194, 194);
fill(247, 247, 247);
arc(0,30,40,11,0,180);
line(-20,30,20,30);
popMatrix();
stroke(0,0,0);
strokeWeight(2);
fill(176, 176, 176);
beginShape();
vertex(13,16);
vertex(31,12);
vertex(31,30);
vertex(27,28);
vertex(26,34);
vertex(23,27);
vertex(20,32);
vertex(15,23);
endShape(CLOSE);

pushMatrix();
translate(-36,3);
rotate(-7);
strokeWeight(3);
stroke(0,0,0);
fill(115, 94, 11);
rect(0,0,20,26,5);
noStroke();
fill(201, 201, 201);
rect(0,1,20,26,5);
strokeWeight(3);
stroke(0,0,0);
fill(115, 94, 11);
rect(-3,3,20,26,5);
strokeWeight(2);
stroke(235, 166, 5);
fill(247, 255, 0);
pushMatrix();
translate(7.5,16);
rotate(-8);
beginShape();
for(var i = 0; i < 6; i++){
vertex(0+cos(i*(360/5))*4,0+sin(i*(360/5))*4);
vertex(0+cos(i*(360/5)+36)*2,0+sin(i*(360/5)+36)*2);
}
endShape(CLOSE);
popMatrix();

popMatrix();
    },
    loadImgBehind: function(e){
    pushMatrix();
translate(39,-25);
rotate(46);

stroke(110, 67, 6);
strokeWeight(5);
line(0,-5,0,10);
line(4,30,0,10);
line(4,30,3,56);

stroke(0,0,0);
strokeWeight(2);
fill(186, 186, 186);
arc(0,-11,22,22,35,145);
noStroke();
fill(251, 0, 255);
ellipse(0,-11,16,16);
fill(204, 6, 201);
ellipse(5,-11,6,10);

noFill();
stroke(0,0,0);
strokeWeight(2);
ellipse(0,-11,16,16);


popMatrix();

    },
    animImgStatic: function(e){
    },
    },
    // general
    {
    name: 'General chicken',
    attack: 4,
    health: 4,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 30,
    ability: function(lvl){
    return 'Friend summoned or bought: give it +'+(lvl*2)+'/+'+(lvl*2)+' permanently and +'+(lvl)+'/+'+(lvl)+' for one turn';
    },
    chickenSummoned: function(t,lvl){
    if(todo[0][2] && !todo[0][2].killed){
    todo[0][2].health += lvl*2;
    todo[0][2].attack += lvl*2;
    temporaryStat(todo[0][2],lvl,lvl);
    chickenFeed(t,todo[0][2]);
    }
    },
    chickenBought: function(t,lvl){
    if(lastBought){
    lastBought.attack += lvl*2;
    lastBought.health += lvl*2;
    temporaryStat(lastBought,lvl,lvl);
    chickenFeed(t,lastBought);
    }
    },

    img:false,
    noBase:true,
    loadImg: function(e){

stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(25, 94, 20);
    noStroke();
    arc(0,10,47,27,-15,168);
    fill(224, 224, 224);
    pushMatrix();
    rotate(-9);
    stroke(0, 0, 0);
    strokeWeight(1);
    triangle(1,17,-4,10.5,6,10.5);
    noStroke();
    fill(60, 140, 54);
    beginShape();
    vertex(1,10.5);
    vertex(3,14);
    vertex(1,17);
    vertex(-1,14);
    endShape(CLOSE);
    stroke(0, 0, 0);
    strokeWeight(1);
    noFill();
    triangle(1,17,-4,10.5,6,10.5);
    line(1,17,4,17);
    line(4,17,3,26);
    noStroke();
    fill(133, 120, 4);
    ellipse(1,19,2,2);
    ellipse(1,22,2,2);

    fill(245, 24, 24);
    rect(-15,11.5,2,4);
    fill(255, 255, 255);
    rect(-13,11.5,2,4);

    fill(212, 219, 4);
    ellipse(-7.5,14,2,3);
    triangle(-7.5,14,-10,13,-9,15);
    triangle(-7.5,14,-5,13,-6,15);

    popMatrix();

    noFill();
    stroke(0,0,0);
    strokeWeight(5);
    ellipse(0,0,50,50);

    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);


strokeWeight(4);
stroke(0,0,0);
line(-12,-6,-4,-6);

pushMatrix();
translate(-2,-24);
scale(1.1);
rotate(-6);



stroke(0,0,0);
strokeWeight(3);


fill(56, 110, 58);
ellipse(0,-2,46,24);

noStroke();
fill(166, 144, 73);
beginShape();
vertex(0,-10);
vertex(5,-5);
vertex(0,-3);
vertex(-5,-5);
endShape(CLOSE);
beginShape();
vertex(2,-10);
vertex(7,-5);
vertex(5,-2);
vertex(10,-5);
endShape(CLOSE);
beginShape();
vertex(-2,-10);
vertex(-7,-5);
vertex(-5,-2);
vertex(-10,-5);
endShape(CLOSE);


fill(105, 97, 52);
strokeWeight(2);
stroke(0,0,0);
arc(0,8,32,16,180,360);

noStroke();
fill(184, 179, 162);
ellipse(0,2.5,2,2);
ellipse(6,3,2,2);
ellipse(-6,3,2,2);

fill(41, 92, 74);
strokeWeight(2);
stroke(0,0,0);
ellipse(0,8,32,5);

popMatrix();

pushMatrix();
translate(-17,12);
scale(1);
rotate(-7);
strokeWeight(3);
stroke(209, 175, 4);
fill(237, 199, 9);
line(3,0,-10,0);
rect(-13,0,10,5,1);
popMatrix();
    },
    loadImgBehind: function(e){
pushMatrix();
translate(23,4);
scale(-1,1);
rotate(7);
strokeWeight(3);
stroke(209, 175, 4);
fill(237, 199, 9);
line(3,0,-10,0);
rect(-13,0,10,5,1);
popMatrix();
    },
    animImgStatic: function(e){
    },
    },
    // rocket
    {
    name: 'Rocket chicken',
    attack: 8,
    health: 3,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    ability: function(lvl){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'Start of battle: deal '+(8)+' damage to a random enemy, '+lvl+' time'+a;
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    for(var i = 0; i < lvl; i++){
    var options = eachAliveInTeamThenAll(1-t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health -= 8;
    select.checkStatUp();
    throwAbilityProj(t,select,5,8,'missile');
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
     pushMatrix();
    translate(5,0);
    rotate(-20);
    scale(0.9);
    noStroke();




    stroke(0,0,0);
    strokeWeight(3);
    fill(227, 0, 0);
    ellipse(11,-17,16,15);

    strokeWeight(5);
    fill(219, 219, 219);
    rect(-30,-17,52,34,7);
    strokeWeight(3);
    fill(148, 148, 148);
    rect(-29,-25,35,10,2);
    rect(-29,15,35,10,2);
    strokeWeight(2);
    fill(77, 77, 77);
    quad(-29,15,-29,25,-35,27,-35,13);
    quad(-29,-25,-29,-15,-35,-13,-35,-27);

    strokeWeight(3);
    fill(227, 0, 0);
    ellipse(27,9,6,15);

    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(36,1,22,-13,22,14);
    strokeWeight(7);
    point(6,-3);
    popMatrix();
    },
    animImgBehind: function(e){
        pushMatrix();
    translate(5,0);
    rotate(-20);
    scale(0.9);
    noStroke();
    for(var i = 0; i < 3; i++){
    fill(227, i*80, 0);
    pushMatrix();
    translate(-14+sin(frameCount*3+(3-i)*60)*2,-2);
    scale(0.6+(3-i)*0.2,0.5+(3-i)*0.2);
    scale(0.8,1.5);
    rotate(-76);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    popMatrix();
    }
    popMatrix();
    }
    },
    // robo
    {
    name: 'Robo chicken',
    attack: 4,
    health: 4,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 35,
    ability: function(lvl){
    return 'Faint: summon up to 3 basic chickens with '+round(lvl*33.3)+'% of this chicken\'s attack and 1 health in empty spots in the same coop';
    },
    faint: function(t,lvl){
    var empty = [];
    if(t.coopPos || t.coopPos === 0){
    for(var i = 0; i < t.coopId.c.length; i++){
    if(!t.coopId.c[i]){
    empty.push(i);
    }
    }

    for(var i = 0; i < 3; i++){
        if(empty.length > 0){
            var num = floor(random(0,empty.length));
            var a2 = empty[num];

    var a = new chicken(300,300,stats.chicken['Basic chicken']);
    a.xp = 0;
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = ceil(t.attack*(round(lvl*33.3)/100));
    a.health = 1;
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[a2] = a;
    summonCheck(a);

            empty.splice(num,1);
        }
    }

    }

    },
    img:false,
    noBase:true,
    loadImg: function(e){
    pushMatrix();
    rotate(7);
    translate(0,8);
    scale(0.8);
    var a = [[13,0],[-13,0],[0,-21]];
    for(var i = 0; i < 3; i++){
    pushMatrix();
    translate(a[i][0],a[i][1]);
    rotate(0);
    scale(0.5);
    stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 255, 255);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    popMatrix();
    }
    popMatrix();
    stroke(0,0,0);
    strokeWeight(5);
    fill(92, 92, 92);
    beginShape();
    vertex(-9,-5);
    vertex(6,-26);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-18);
    vertex(9,246);
    endShape();
    fill(150, 150, 150,100);
    ellipse(0,0,50,50);
    fill(70, 94, 135);
    ellipse(22,15,10,15);
    fill(70, 94, 135);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(2);
    ellipse(-8,-3,15,15);
    strokeWeight(7);
    stroke(0, 132, 255);
    point(-8,-3);
    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // vault-chicken
    {
    name: 'Vault-chicken',
    attack: 2,
    health: 6,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 30,
    ability: function(lvl, t){
    return 'Targeted: gain +'+lvl+' gold next turn.\nWorks 4 times per turn\n('+(4-t.triggers)+' triggers left)';
    },
    targeted: function(t,lvl){
        if(t.triggers < 4){
        t.temporaryScale = 1.4;
        t.triggers++;
        if(t.teamId === 0){
            bonusGold += lvl;
        }
        }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
        }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();

    noStroke();
    fill(235, 235, 235);
    ellipse(0,0,50,50);
    fill(7, 79, 168);
    arc(0,10,47,27,-15,165);
    fill(224, 224, 224);
    pushMatrix();
    rotate(-9);
    stroke(214, 200, 7);
    strokeWeight(3);
    line(-20,10,20,10);
    strokeWeight(7);
    line(4,12,4,22);
    strokeWeight(1);
    line(-7,14,-7,18);
    line(-7,14,-9,15);
    line(-9,18,-5,18);
    strokeWeight(3);
    stroke(107, 78, 6);
    line(-10,21,22,21);
    strokeWeight(6);
    stroke(184, 184, 184);
    line(2,22,6,22);

    popMatrix();

    noFill();
    stroke(0,0,0);
    strokeWeight(5);
    ellipse(0,0,50,50);

    stroke(0,0,0);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);
    },
    loadImgBehind: function(e){
// uhh i took the hand from someone nikos pip boy graphic cuz im lazy
        pushMatrix();
translate(86,-78);
scale(0.4);
scale(-1,1);
strokeWeight(5);
stroke(0,0,0);
fill(227, 199, 57);
beginShape();
curveVertex(138,180);
curveVertex(138,180);
curveVertex(150,186);
curveVertex(156,203);
curveVertex(146,216);
curveVertex(138,217);
curveVertex(125,215);
curveVertex(125,215);
endShape();
fill(235, 235, 235);
beginShape();
curveVertex(110,208);
curveVertex(110,208);
curveVertex(114,213);
curveVertex(125,216);
curveVertex(133,214);
curveVertex(140,207);
curveVertex(142,199);
curveVertex(139,189);
curveVertex(138,189);
endShape();
beginShape();
curveVertex(137,198);
curveVertex(138,198);
curveVertex(142,191);
curveVertex(142,182);
curveVertex(135,175);
curveVertex(131,172);
curveVertex(128,167);
curveVertex(129,161);
curveVertex(131,156);
curveVertex(131,152);
curveVertex(127,149);
curveVertex(121,150);
curveVertex(116,157);
curveVertex(115,165);
curveVertex(117,172);
curveVertex(121,178);
curveVertex(121,178);
endShape();
beginShape();
curveVertex(129,190);
curveVertex(129,190);
curveVertex(132,189);
curveVertex(132,183);
curveVertex(127,179);
curveVertex(114,176);
curveVertex(105,179);
curveVertex(103,184);
curveVertex(104,186);
curveVertex(107,189);
curveVertex(107,189);
endShape();
beginShape();
curveVertex(129,203);
curveVertex(129,203);
curveVertex(133,201);
curveVertex(134,198);
curveVertex(133,194);
curveVertex(125,190);
curveVertex(115,189);
curveVertex(108,190);
curveVertex(105,193);
curveVertex(105,198);
curveVertex(108,200);
curveVertex(108,200);
endShape();
beginShape();
curveVertex(129,203);
curveVertex(133,207);
curveVertex(130,202);
curveVertex(112,201);
curveVertex(109,202);
curveVertex(108,204);
curveVertex(109,207);
curveVertex(114,211);
curveVertex(121,212);
curveVertex(129,211);
curveVertex(132,208);
curveVertex(132,208);
endShape();
popMatrix();

    },
    animImgStatic: function(e){
    },
    },
    // monster
    {
    name: 'Monster chicken',
    attack: 7,
    health: 6,
    size:1.1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'Attacked: gain +'+(4*lvl)+' attack and +'+(3*lvl)+' health';
    },
    attacked: function(t,lvl){
        t.health += lvl*3;
        t.attack += lvl*4;
        feedProj(t);
    },
    img:false,
    noBase:true,
    loadImg: function(e){stroke(0,0,0);
    strokeWeight(5);
    fill(112, 112, 112);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(175, 0, 184);
    ellipse(0,0,52,50);

    pushMatrix();
    translate(-7,-4);
    fill(227, 0, 0);
    ellipse(19,22,8,9);

    noStroke();
    fill(222, 222, 222);
    triangle(29,13,25,8,27,2);
    triangle(33,10,30,2,35,2);
    triangle(35,13,25,18,32,18);

    fill(224, 185, 130);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,10,15,19,27,17);
    triangle(15,-9,15,10,35,0);
    popMatrix();

    strokeWeight(10);
    stroke(0, 0, 0);
    point(-8,-3);
    var a = 16;
    for(var i = 1; i < a; i+=2){
    strokeWeight(10+i);
    stroke(0, 0, 0,255/10);
    point(-8,-3);
    }
    strokeWeight(6);
    stroke(219, 51, 51);
    point(-8,-3);

    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },
    // chef
    {
    name: 'Chef chicken',
    attack: 4,
    health: 6,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 8,
    ability: function(lvl){
    return 'Bought: replace shop page 2 with '+(1+lvl)+' free foods tier 5 and under';
    },
    buy: function(t,lvl){
    shop[1].frozens = [];
    cleanShop(1);
    shop[1].data = [];
    shopPage = 1;
    for(var i = 0; i < lvl+1; i++){
        var a = getRand(5,'food',t.x,t.y);
        a.price = 0;
        shop[1].data.push(a);
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
translate(-1,-18);
rotate(-13);


stroke(0,0,0);
strokeWeight(4);
fill(222, 222, 222);
    var a = 30;
for(var i = 0; i < 4; i++){
    beginShape();
    vertex(-20,5);
    curveVertex(20-i*(a/4),5);
    curveVertex(0+cos(330-i*a)*40,-20+sin(330-i*a)*10);
    curveVertex(0+cos(330-(i+1)*a)*40,-20+sin(330-(i+1)*a)*10+i*3);
    vertex(-20,5);
    endShape(CLOSE);
}


stroke(0,0,0);
strokeWeight(4);
fill(255, 76, 133);
rect(-23,0,46,10,2);

popMatrix();


pushMatrix();
translate(-32,-15);
rotate(-24);


stroke(138, 138, 138);
strokeWeight(2);
noFill();


for(var i = 45; i < 360; i+=60){
var a = cos(i)*36;
bezier(0,23,-a,-35,a,-35,0,23);
}


stroke(0,0,0);
strokeWeight(2);
fill(125, 85, 29);
pushMatrix();
translate(-0.5,1.3);
rect(-3,17,6,24,2);
popMatrix();

popMatrix();
    },
    loadImgBehind: function(e){
    },
    animImg: function(e){

    },
    },
    // thief
    {
    name: 'Thief chicken',
    attack: 5,
    health: 3,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    var a = '';
    var a2 = '';
    if(lvl > 1){
        a = 's';
        a2 = lvl + ' ';
    }
    return 'Start of turn: make the '+a2+'leftmost chicken'+a+' in shop page 1 free';
    },
    startOfTurn: function(t,lvl){
    shopPage = 0;
    var add = 0;
    for(var i = 0; i < lvl; i++){
        if(shop[0].data[i+add]){
        if(shop[0].data[i+add] && shop[0].data[i+add].price > 0){
        shop[0].data[i+add].price = 0;
        shop[0].data[i+add].temporaryScale = 1.4;
        }else{
        i--;
        add++;
        }
        }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
        stroke(0,0,0);
    strokeWeight(5);
    fill(140, 140, 140);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(43, 43, 43);
    ellipse(0,0,50,50);
    strokeWeight(5);
    stroke(0,0,0);
    fill(43, 43, 43);
    arc(0,-15,39,33,180,360);
    strokeWeight(2);
    noFill();
    stroke(74, 74, 74);
    arc(0,0,30,50,135,235);
    arc(0,0,10,50,135,235);
    arc(0,0,13,50,90-45-101,51);
    arc(0,0,37,50,90-45-101,51);
    stroke(0,0,0);
    strokeWeight(5);
    fill(255,255,255);
    ellipse(-6,-3,28,14);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    point(-8,-3);



    pushMatrix();
    translate(-33,-7);
    rotate(-35);
    scale(0.8);

    stroke(0,0,0);
    strokeWeight(6);
    fill(0, 0, 0);
    rect(0,-10,4,43);
    triangle(0,35,2.5,36,-2,41);
    noFill();
    stroke(0, 0, 0);
    strokeWeight(10);
    arc(6,-10,8,13,180,295);
    stroke(0,0,0);
    strokeWeight(6);
    fill(0, 0, 0);
    beginShape();
    vertex(7,-14);
    vertex(9,-17.5);
    vertex(13,-15.5);
    vertex(9,-15);
    vertex(11,-12.5);
    endShape(CLOSE);

    noStroke();
    fill(171, 160, 0);
    rect(0,-10,4,45);
    triangle(0,34,4,35,-4,45);
    noFill();
    stroke(171, 160, 0);
    strokeWeight(4);
    arc(6,-10,8,13,180,295);
    noStroke();
    fill(171, 160, 0);
    beginShape();
    vertex(7,-14);
    vertex(9,-17.5);
    vertex(15,-15);
    vertex(9,-15);
    vertex(13,-11);
    endShape(CLOSE);

    popMatrix();


    },
    loadImgBehind: function(e){
        pushMatrix();
    translate(28,11);
    rotate(24);
    scale(-1,1);

    noStroke();
    fill(146, 252, 252);
    beginShape();
    vertex(-20,-16);
    vertex(0,0);
    vertex(20,-16);
    vertex(12,-25);
    vertex(-12,-25);
    endShape(CLOSE);
    fill(0, 250, 250);
    beginShape();
    vertex(-20,-16);
    vertex(0,0);
    vertex(40/6,-16);
    vertex(-40/6,-16);
    vertex(-12,-25);
    endShape(CLOSE);
    fill(6, 207, 207);
    beginShape();
    vertex(-20,-16);
    vertex(0,0);
    vertex(-40/6,-16);
    endShape(CLOSE);


    stroke(0,0,0);
    strokeWeight(3);
    noFill();
    beginShape();
    vertex(-20,-16);
    vertex(0,0);
    vertex(20,-16);
    vertex(12,-25);
    vertex(-12,-25);
    endShape(CLOSE);
    line(-20,-16,20,-16);
    line(-12,-25,-40/6,-16);
    line(12,-25,40/6,-16);
    line(0,0,-40/6,-16);
    line(0,0,40/6,-16);

    popMatrix();
    },
    animImg: function(e){

    },
    },
    // pope
    {
    name: 'Pope chicken',
    attack: 3,
    health: 7,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'End turn: give a friend from each tier +'+lvl+' attack and +'+lvl+' health';
    },
    endTurn: function(t,lvl){
    var i = 0;
    var a = function(e){
    if(e.stats.tier === i){
        return true;
    }
    return false;
    };
    for(i = 1; i < 7; i++){
    var options = allMyChickensExceptForArray([t]);
    options = filt(options,a);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health += lvl;
    select.attack += lvl;
    chickenFeed(t,select);
    }
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(-6,-33);
    rotate(-8);
    var a = 1.2;
    scale(a,0.9);


    noStroke();
    fill(235, 235, 235);
    beginShape();
    vertex(0,47);
    curveVertex(15,20);
    vertex(24,-10);
    vertex(0,-30);
    vertex(-24,-10);
    curveVertex(-15,20);
    endShape(CLOSE);

    strokeWeight(2);
    stroke(0,0,0);
    fill(194, 162, 81);
    beginShape();
    vertex(5,20);
    vertex(-5,20);
    vertex(-5,-28);
    vertex(0,-30);
    vertex(5,-28);
    endShape(CLOSE);

    strokeWeight(2);
    stroke(0,0,0);
    fill(189, 157, 68);
    beginShape();
    vertex(15,20);
    vertex(-15,20);
    vertex(-20,10);
    vertex(20,10);
    endShape(CLOSE);

    for(var i = -13; i <= 13; i+=13){
        pushMatrix();
        scale(1/a,1);
        strokeWeight(2);
        stroke(0,0,0);
        fill(227, 227, 227);
        ellipse(i,15,5,5);
        popMatrix();
    }

    stroke(0,0,0);
    strokeWeight(4);
    noFill();
    beginShape();
    vertex(0,47);
    curveVertex(15,19);
    vertex(24,-10);
    vertex(0,-30);
    vertex(-24,-10);
    curveVertex(-15,19);
    endShape(CLOSE);

    popMatrix();

    pushMatrix();
    translate(-38,-27);
    rotate(-31);

    stroke(186, 165, 89);
    strokeWeight(4);
    line(0,32,0,70);

    stroke(0,0,0);
    strokeWeight(2);
    fill(186, 165, 89);
    ellipse(0,32,10,10);

    stroke(0,0,0);
    strokeWeight(2);
    fill(237, 184, 86);
    quad(-2,0,2,0,5,-20,-5,-20);
    quad(0,-2,0,2,-15,4,-15,-4);
    quad(0,-2,0,2,15,4,15,-4);
    quad(-2,0,2,0,4,30,-4,30);
    ellipse(0,0,8,8);

    popMatrix();
    },
    loadImgBehind: function(e){
    pushMatrix();
translate(27,-27);
rotate(17);
strokeWeight(3);
stroke(0,0,0);
fill(125, 125, 125);
rect(0,0,20,26,5);
noStroke();
fill(201, 201, 201);
rect(0,1,20,26,5);
strokeWeight(3);
stroke(0,0,0);
fill(125, 125, 125);
rect(-3,3,20,26,5);
strokeWeight(3);
stroke(235, 166, 5);
line(7,10,7,23);
line(3,15,11,15);
popMatrix();
    },
    animImg: function(e){

    },
    },
    // game dev
    {
    name: 'Dev chicken',
    attack: 3,
    health: 6,
    size:1,
    discount: 0,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 40,
    ability: function(lvl){
    return 'End turn: summon a level '+lvl+' chicken to the right from the current tier with attack and health equal to the turn number';
    },
    endTurn: function(t,lvl){
    if((t.coopPos||t.coopPos === 0)){

    var targs = [];
    if(t.coopPos !== 2 && t.coopPos !== 5){
        if(!t.coopId.c[t.coopPos + 1]){
            targs.push(t.coopPos + 1);
        }
    }

    for(var i = 0; i < targs.length; i++){

    var a = getRandExact(tier,'chicken',300,300);
    if(lvl === 3){
    a.xp = 5;
    }else if(lvl === 2){
    a.xp = 2;
    }else{
    a.xp = 0;
    }
    a.teamId = t.teamId;
    a.coopPos = t.coopPos;
    a.coopId = t.coopId;
    a.x = a.coopId.x;
    a.y = a.coopId.y-300;
    a.attack = record[2];
    a.health = record[2];
    updateStats(a);
    a.checkStatUp();
    t.coopId.c[targs[i]] = a;
    summonCheck(a);
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

stroke(0,0,0);
    strokeWeight(2);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(6,-25);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-19);
    vertex(9,246);
    endShape();
    strokeWeight(5);
    fill(181, 181, 181);
    ellipse(0,0,50,50);
pushMatrix();
translate(-290,-293);
translate(300,300);
scale(0.1);
translate(-300,-300);
noStroke();

var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a5 = 206;
var a6 = 117;
fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape();
beginShape();
vertex(0, 400);
vertex(80, 400);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape();

var a7 = 215;
beginShape();
vertex(0, 200);
vertex(0, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape();
var a8 = 319;
beginShape();
vertex(400, 200);
vertex(400, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape();
//rect(0, 200,400, 80);

fill(50,50,50);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
vertex(400, 400);
vertex(320, 400);
endShape();
popMatrix();

    stroke(0,0,0);
    strokeWeight(5);

    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(46, 142, 166);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    //point(-8,-3);
stroke(0,0,0);
strokeWeight(5);

pushMatrix();
translate(-5,-7);

stroke(0,0,0);
strokeWeight(5);
line(17,4,28,3);
line(-6,4,-23,1);

stroke(0,0,0);
strokeWeight(2);
fill(145, 145, 145,200);
var tilt = 0;
ellipse(6,5,20,20);
ellipse(38,3,20,20);
popMatrix();
fill(255, 149, 0);
stroke(0,0,0);
strokeWeight(5);
triangle(15,-6,15,14,35,9);
    },
    loadImgBehind: function(e){
    },
    animImgStatic: function(e){
    },
    },

    // }
    // tier 6 {
    // Golden
    {
    name: 'Golden chicken',
    attack: 5,
    health: 5,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardWidth: 0,
    ability: function(lvl){
    return 'Start of turn: get '+lvl+' extra gold for each lvl 3 chicken';
    },
    startOfTurn: function(t,lvl){
    var num = 0;
    var a = allMyChickensExceptForArray([]);
    for(var i = 0; i < a.length; i++){
        if(a[i].lvl === 3){
            num++;
        }
    }

    t.temporaryScale = 1.4;
    gold += lvl*num;
    gold = round(gold);
    if(num > 0){
    coinAnim.s = 1.4;
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(71, 55, 6);
    strokeWeight(5);
    fill(171, 124, 5);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(240, 174, 8);
    ellipse(0,0,50,50);
    fill(171, 124, 5);
    ellipse(22,15,10,15);
    fill(255, 208, 0);
    stroke(71, 55, 6);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    fill(43, 255, 195);
    strokeWeight(3);
    ellipse(-8,-3,10,10);
    },
    loadImgBehind: function(e){
    },
    },
    // Fire
    {
    name: 'Fire chicken',
    attack: 5,
    health: 7,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardWidth: 0,
    ability: function(lvl){
    return 'Attacked: deal '+(lvl*2)+' damage to all enemies';
    },
    attacked: function(t,lvl){
    var all = eachChickenInTeam(1-t.teamId);
    for(var i = 0; i < all.length; i++){
    all[i].health -= lvl*2;
    all[i].checkStatUp();
    throwAbilityProj(t,all[i],14,lvl*2,'fireball');
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);


    pushMatrix();
    translate(0,25);
    scale(1,0.9);
    translate(0,-25);

    pushMatrix();

    stroke(0,0,0);
    strokeWeight(9);
    fill(0, 0, 0);
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(28,-16);
    vertex(21,-13);
    vertex(20.4,-28);
    vertex(16,-21);
    vertex(12,-44);
    vertex(10,-35);
    vertex(-10,-58);
    vertex(-7,-35);
    vertex(-33,-51);
    vertex(-22,-27);
    vertex(-42,-31);
    vertex(-25,-12);
    vertex(-37,-15);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();

    for(var i = 0; i < 3; i++){
    pushMatrix();

    translate(2,0);
    scale(1-i*0.3);
    translate(-2,0);

    noStroke();
    if(i === 0){
    fill(255, 191, 0);
    }else if(i === 1){
    fill(255, 115, 0);
    }else if(i === 2){
    fill(255, 77, 0);
    }
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(28,-16);
    vertex(21,-13);
    vertex(21,-30);
    vertex(16,-21);
    vertex(12,-49);
    vertex(10,-35);
    vertex(-10,-58);
    vertex(-7,-35);
    vertex(-33,-51);
    vertex(-22,-27);
    vertex(-42,-31);
    vertex(-25,-12);
    vertex(-37,-15);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();
    }
    popMatrix();

    fill(33, 0, 0);
    ellipse(22,15,10,15);
    fill(46, 27, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    noStroke();
    fill(0,0,0);
    arc(-8,-3,14,14,15,195);


popMatrix();


    },
    animImg: function(e){

pushMatrix();
translate(0,0);
rotate(0);

pushMatrix();
    translate(0,25);
    scale(1,0.9);
    scale(0.9);
    translate(0,-25);



    for(var i = 0; i < 3; i++){
    pushMatrix();

    translate(2,0);
    scale(1-i*0.3);
    translate(-2,0);
    rotate(cos(frameCount*1.2+i*60)*(i+1)*5);
    noStroke();
    if(i === 0){
    fill(255, 136, 0);
    }else if(i === 1){
    fill(255, 115, 0);
    }else if(i === 2){
    fill(255, 77, 0);
    }
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(28,-16);
    vertex(21,-13);
    vertex(21,-30);
    vertex(16,-21);
    vertex(12,-49);
    vertex(10,-35);
    vertex(-10,-58);
    vertex(-7,-35);
    vertex(-33,-51);
    vertex(-22,-27);
    vertex(-42,-31);
    vertex(-25,-12);
    vertex(-37,-15);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();
    }
    popMatrix();

    fill(33, 0, 0);
    ellipse(22,15,10,15);
    fill(46, 27, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    noStroke();
    fill(0,0,0);
    arc(-8,-3,14,14,15,195);

popMatrix();

    },
    loadImgBehind: function(e){
    },
    },
    // Water
    {
    name: 'Water chicken',
    attack: 5,
    health: 10,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 25,
    stretchLimit:1000,
    ability: function(lvl,t){
    return 'Attacked: give all friends +'+(lvl*2)+' health.\nWorks 2 times per turn\n('+(2-t.triggers)+' triggers left)';
    },
    attacked: function(t,lvl){
    if(t.triggers < 2){
        t.triggers++;
        t.temporaryScale = 1.3;
    var all = eachChickenInTeam(t.teamId);
    for(var i = 0; i < all.length; i++){
    if(all[i] !== t){
    all[i].health += lvl*2;
    all[i].checkStatUp();
    chickenFeed(t,all[i]);
    }
    }
    }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
        stroke(0,0,0);
    strokeWeight(5);
    fill(168, 168, 168);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-6,-41);
    curveVertex(-10,-29);
    vertex(-21,-14);
    vertex(9,246);
    endShape();

    noStroke();
    fill(224, 187, 85);
    ellipse(0,18,31,8);

    fill(9, 184, 0);
    ellipse(13,2,6,3);
    ellipse(7,6,6,3);
    ellipse(13,10,6,3);
    ellipse(7,14,6,3);

    ellipse(-9,-8,6,3);
    ellipse(-15,-3,6,3);
    ellipse(-9,2,6,3);
    ellipse(-15,7,6,3);
    ellipse(-9,12,6,3);

    stroke(9, 184, 0);
    strokeWeight(3);
    line(10,16,10,-1);
    line(-12,16,-12,-12);

    stroke(0,0,0);
    strokeWeight(5);
    fill(127, 188, 235,150);
    ellipse(0,0,50,45);
    strokeWeight(4);
    fill(201, 223, 240);
    ellipse(0,-21,30,7);



    fill(247, 190, 111);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(19,-5,19,11,35,5);
    strokeWeight(7);
    point(-8,-3);
    },
    animImgBehind: function(e){

    pushMatrix();
translate(cos(frameCount+e.id)*13,sin(frameCount*2+e.id)*4);
scale(sin(frameCount+e.id),1);
rotate(0);

fill(255, 140, 0);
stroke(0,0,0);
strokeWeight(2);
triangle(5,0,10,2,10,-2);
ellipse(0,0,12,6);
strokeWeight(2);
point(-2,0);


popMatrix();

    },
    loadImgBehind: function(e){
    },
    },
    // Electro
    {
    name: 'Electro chicken',
    attack: 4,
    health: 9,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 25,
    ability: function(lvl,t){
    return 'Friend summoned or bought: give it +'+(lvl)+' XP.\nWorks 2 times per turn\n('+(2-t.triggers)+' triggers left)';
    },
    chickenSummoned: function(t,lvl){
    if(t.triggers < 2){
    if(todo[0][2] && !todo[0][2].killed){
         t.triggers++;
    todo[0][2].xp+=lvl;
    todo[0][2].checkStatUp();
    xpProj(todo[0][2],lvl);
    }
    }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
    }
    },
    chickenBought: function(t,lvl){
    if(t.triggers < 2){
    if(lastBought){
        t.triggers++;
    lastBought.xp+=lvl;
    lastBought.checkStatUp();
    xpProj(lastBought,lvl);
    }
    }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
    }
    },

    img:false,
    noBase:true,
    loadImg: function(e){
       pushMatrix();
    translate(0,25);
    scale(1,0.9);
    translate(0,-25);

    pushMatrix();

    stroke(0, 0, 0);
    strokeWeight(9);
    fill(0, 0, 0);
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(33,-16);
    vertex(21,-13);

    vertex(23,-35);
    vertex(10,-22);
    vertex(-10,-48);
    vertex(-12,-21);

    vertex(-36,-31);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();

    for(var i = 0; i < 3; i++){
    pushMatrix();

    translate(2,0);
    scale(1-i*0.3);
    translate(-2,0);

    noStroke();
    if(i === 0){
    fill(247, 255, 0);
    }else if(i === 1){
    fill(245, 212, 0);
    }else if(i === 2){
    fill(217, 199, 3);
    }
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(33,-16);
    vertex(21,-13);

    vertex(23,-35);
    vertex(10,-22);
    vertex(-10,-48);
    vertex(-12,-21);

    vertex(-36,-31);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();
    }

    popMatrix();

    fill(255, 193, 94);
    ellipse(22,15,10,15);
    fill(0, 230, 255);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);

    strokeWeight(2);
    fill(0, 230, 255);
    rect(-16,-6,13,7,2);
    },
    animImg: function(e){
    if(!e.electroAnim){
    e.electroAnim = [];
    }
    if(!e.electroAnim2){
    e.electroAnim2 = [];
    }
    var a = e.electroAnim;
    var a2 = e.electroAnim2;
    stroke(0, 230, 255);
strokeWeight(3);


for(var i = 1; i < a.length; i++){
    line(a[i].x,a[i].y,a[i-1].x,a[i-1].y);
}
if(!a[0]){
a = [{x:-9,y:-4,r:-45}];
}
if(a.length < 8){
if(frameCount/4 === round(frameCount/4)){
var r = a[a.length-1].r + random(-120,120);
var d = random(5,10);
a.push({x:a[a.length-1].x+cos(r)*d,y:a[a.length-1].y+sin(r)*d,r:r});
}
}else{
a = [{x:-9,y:-4,r:-45}];
}


for(var i = 1; i < a2.length; i++){
    line(a2[i].x,a2[i].y,a2[i-1].x,a2[i-1].y);
}
if(!a2[0]){
a2 = [{x:-9,y:-4,r:135}];
}
if(a2.length < 8){
if(frameCount/3 === round(frameCount/3)){
var r = a2[a2.length-1].r + random(-120,120);
var d = random(5,10);
a2.push({x:a2[a2.length-1].x+cos(r)*d,y:a2[a2.length-1].y+sin(r)*d,r:r});
}
}else{
a2 = [{x:-9,y:-4,r:135}];
}
e.electroAnim = a;
e.electroAnim2 = a2;
    },
    animImgStatic: function(e){
    },
    },
    // Steel
    {
    name: 'Steel chicken',
    attack: 7,
    health: 8,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 10,
    ability: function(lvl){
    return 'End turn: give up to 3 random contraptions +'+lvl+' durability';
    },
    endTurn: function(t,lvl){
    var options = [];
    for(var i = 0; i < myContraptions.length; i++){
        options.push(myContraptions[i]);
    }
    for(var i = 0; i < 3; i++){
        if(options.length > 0){
        var choice = floor(random(0,options.length));
        var a = options[choice];
        if(a){
            a.health+=lvl;
            a.temporaryScale = 1.3;
            feedProj(a);
        }
        options.splice(choice,1);
        }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
        stroke(0,0,0);
    strokeWeight(2);
    pushMatrix();
    translate(-15,-44);
    rotate(75);
    fill(196, 196, 196);
    rect(0,0,50,8);
    fill(145, 145, 145);
    ellipse(0,4,6,8);
    popMatrix();
    pushMatrix();
    translate(-9,-56);
    rotate(75);
    fill(196, 196, 196);
    rect(0,0,50,8);
    fill(145, 145, 145);
    ellipse(0,4,6,8);
    popMatrix();
    pushMatrix();
    translate(3,-44);
    rotate(75);
    fill(196, 196, 196);
    rect(0,0,50,8);
    fill(145, 145, 145);
    ellipse(0,4,6,8);
    popMatrix();

    stroke(0,0,0);
    strokeWeight(5);
    fill(176, 176, 176);
    ellipse(0,0,50,50);
    noStroke();
    fill(102, 102, 102);
    ellipse(0,0,20,20);

    // var num = 7;
    // for(var i = 0; i < 360; i+=360/num){
    // pushMatrix();
    // rotate(i);
    // translate(0,-25);
    // stroke(0,0,0);
    // strokeWeight(3);
    // fill(173, 173, 173);
    // rect(-5,-11,10,10);
    // popMatrix();
    // }
    stroke(0,0,0);
    strokeWeight(5);
    fill(247, 213, 121);
    ellipse(22,15,10,15);
    fill(186, 186, 186);
    triangle(15,-6,15,14,35,9);


    strokeWeight(3);
    fill(245, 208, 122);
    ellipse(-8,-3,14,14);
    stroke(227, 167, 28);
    strokeWeight(8);
    point(-8,-3);
    },
    animImg: function(e){
    if(!e.steelAnim){
        e.steelAnim = 0;
    }
    if(!e.steelAnim2){
        e.steelAnim2 = 0;
    }
    stroke(0,0,0);
    strokeWeight(5);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    if(sin(frameCount*4) > 0){
        e.steelAnim2 = 0;
        e.steelAnim = lerp(e.steelAnim,360/num/2,0.1);
    }else{
        if(e.steelAnim2 === 0){
            e.steelAnim = -360/num/2;
        }
        e.steelAnim2 = 1;
        e.steelAnim = lerp(e.steelAnim,0,0.1);
    }
    rotate(i+e.steelAnim+13);
    translate(0,-25);
    stroke(0,0,0);
    strokeWeight(3);
    fill(173, 173, 173);
    rect(-5,-11,10,10);
    popMatrix();
    }
    fill(247, 213, 121);
    ellipse(22,15,10,15);
    fill(186, 186, 186);
    triangle(15,-6,15,14,35,9);
    },
    loadImgBehind: function(e){

    },
    },
    // Earth
    {
    name: 'Earth chicken',
    attack: 4,
    health: 9,
    size:1.1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    return 'End turn: gain +'+(3*lvl)+'/+'+(3*lvl);
    },
    endTurn: function(t,lvl){
    t.health += lvl*3;
    t.attack += lvl*3;
    t.checkStatUp();
    feedProj(t);
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(0,0,0);
    strokeWeight(5);

    fill(120, 170, 255);
    ellipse(0,0,50,50);

    noStroke();
    strokeWeight(2);
    stroke(13, 191, 10);
    fill(21, 219, 38);
    beginShape();
    vertex(-19,13);
    vertex(-17,8);
    vertex(-22,1);
    vertex(-23,-9);
    vertex(-16,-20);
    vertex(2,-25);
    vertex(-4,-12);
    vertex(-5,-6);
    vertex(-3,2);
    vertex(-6,2);
    vertex(-8,-4);
    vertex(-13,-3);
    vertex(-19,-4);
    vertex(-18,1);
    vertex(-13,11);
    vertex(-2,11);
    vertex(0,14);
    vertex(5,17);
    vertex(1,25);
    vertex(-16,20);
    endShape(CLOSE);
    beginShape();
    vertex(26,0);
    vertex(20,15);
    vertex(18,17);
    vertex(19,10);
    vertex(10,9);
    vertex(9,4);
    vertex(13,-4);
    vertex(24,-5);
    endShape(CLOSE);
    beginShape();
    vertex(17,-20);
    vertex(23,-11);
    vertex(17,-9);
    vertex(14,-6);
    vertex(10,-9);
    vertex(11,-14);
    vertex(16,-14);
    endShape(CLOSE);
    beginShape();
    vertex(5,-25);
    vertex(14,-21);
    vertex(10,-17);
    vertex(3,-19);
    endShape(CLOSE);
    noFill();
    stroke(0,0,0);
    strokeWeight(5);
    ellipse(0,0,50,50);


    fill(255, 195, 64);
    triangle(19,-6,19,14,35,9);
    stroke(0,0,0);
    strokeWeight(7);
    point(-8,-3);
    },
    // animImg: function(e){
    // pushMatrix();
    // rotate(90+cos(frameCount*0.3+e.id)*20);
    // translate(cos(frameCount)*15,sin(frameCount)*40);
    // if(cos(frameCount) >= 0){
    // strokeWeight(2);
    // stroke(0,0,0);
    // fill(201, 201, 201);
    // ellipse(0,0,12,12);

    // rotate(frameCount*1.2);
    // noStroke();
    // fill(163, 163, 163);
    // ellipse(-3,0,5,5);
    // ellipse(2,3,3,3);
    // ellipse(3,-2,3,3);

    // strokeWeight(2);
    // stroke(0,0,0);
    // noFill();
    // ellipse(0,0,12,12);
    // }
    // popMatrix();
    // },
    animImgBehind: function(e){
        stroke(255, 153, 0);
    strokeWeight(3);
    fill(255, 213, 0);
    pushMatrix();
    translate(-12,-25+cos(frameCount)*5);

    rotate(frameCount*0.4);
    for(var i = 0; i < 360; i += 60){
        line(0,0,cos(i)*15,sin(i)*15);
    }
    ellipse(0,0,20,20);
    popMatrix();
    // pushMatrix();
    // rotate(90+cos(frameCount*0.3+e.id)*20);
    // translate(cos(frameCount)*15,sin(frameCount)*40);
    // if(cos(frameCount) < 0){
    // strokeWeight(2);
    // stroke(0,0,0);
    // fill(201, 201, 201);
    // ellipse(0,0,12,12);

    // rotate(frameCount*1.2);
    // noStroke();
    // fill(163, 163, 163);
    // ellipse(-3,0,5,5);
    // ellipse(2,3,3,3);
    // ellipse(3,-2,3,3);

    // strokeWeight(2);
    // stroke(0,0,0);
    // noFill();
    // ellipse(0,0,12,12);
    // }
    // popMatrix();
    },
    loadImgBehind: function(e){

    },
    },
    // Lava
    {
    name: 'Lava chicken',
    attack: 6,
    health: 6,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 60,
    ability: function(lvl,t){
    return 'Attacked: deal 1 damage to each friend and gain +'+(lvl*2)+'/+'+(lvl*2)+' for each friend hurt this way.\nWorks 6 times per turn\n('+(6-t.triggers)+' triggers left)';
    },
    attacked: function(t,lvl){
    if(t.triggers < 6){
        t.triggers++;
    var num = 0;
    var all = eachChickenInTeam(t.teamId);
    for(var i = 0; i < all.length; i++){
    if(all[i] !== t){
    all[i].health -= 1;
    all[i].checkStatUp();
    throwAbilityProj(t,all[i],5,1,'fireball');
    num++;
    }
    }
    t.attack += num*lvl*2;
    t.health += num*lvl*2;
    t.checkStatUp();
    feedProj(t);
    }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
    }
    },
    img:false,
    noBase:true,
    crucialAnim:true,
    loadImg: function(e){
    },
    animImg: function(e){
    pushMatrix();
translate(0,0);
var num = sin(frameCount*1.2)*0.1;
translate(0,25);
scale(1+num,1-num);
translate(0,-25);
scale(0.5);

    image(specialImgs[1],-300,-300);

popMatrix();
    },
    loadImgBehind: function(e){
    },
    },
    // Light
    {
    name: 'Light chicken',
    attack: 7,
    health: 7,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl){
    var a = '';
    if(lvl > 1){
        a = 's';
    }
    return 'End turn: level up '+lvl+' random contraption'+a;
    },
    endTurn: function(t,lvl){
    var options = [];
    for(var i = 0; i < myContraptions.length; i++){
        if(getLevel(myContraptions[i].xp)<3){
        options.push(myContraptions[i]);
        }
    }
    for(var i = 0; i < lvl; i++){
        if(options.length > 0){
        var choice = floor(random(0,options.length));
        var a = options[choice];
        if(a){
            a.xp += 3;
            a.temporaryScale = 1.3;
            xpProj(a,3);
        }
        options.splice(choice,1);
        }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 255, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 252, 204);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 191, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    stroke(255, 225, 0);
    point(-8,-3);

    var num = 4;
    for(var i = 0; i < 160; i += 160/num){
    pushMatrix();
    rotate(i-60);
    translate(0,-34);
    rotate(0);
    scale(0.3);
    stroke(28, 227, 190, 100);
    strokeWeight(5);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(4,-26);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);
    popMatrix();
    }
    },
    animImg: function(e){
    noStroke();
    fill(255, 208, 0, 70);
    var a = sin(frameCount)*10+70;
    ellipse(0,0,a,a);
    },
    loadImgBehind: function(e){
    },
    },
    // Plant
    {
    name: 'Plant chicken',
    attack: 3,
    health: 6,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight: 70,
    ability: function(lvl,t){
    var a = 'copy';
    if(lvl > 1){
        a = 'copies';
    }
    return 'Chicken friend or self eats food: give it '+lvl+' '+a+' of the food.\nWorks 2 times per turn\n('+(2-t.triggers)+' triggers left)\nThe copies do not trigger any abilities';
    },
    chickenFriendEatsFood: function(t,lvl){
    if(t.triggers < 2){
    if(lastFed){
        t.triggers++;
    for(var i = 0; i < lvl; i++){
    lastFoodFunc(t,lastFed);
    }
    //chickenFeed(t,lastFed);
    }
    }else{
        t.bad = 30;
        t.badMessage = 'Out of triggers';
        t.temporaryRot = -20;
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    pushMatrix();
    translate(-4,-5);
    scale(1,0.8);
     stroke(0,0,0);
    strokeWeight(5);
    fill(227, 0, 0);
    pushMatrix();
    translate(-1,5);
    rotate(63);
    translate(-70,0);
    scale(0.8,1);
fill(66, 184, 96);
strokeWeight(5);
stroke(66, 184, 96);
line(107,0,32,0);

stroke(0,0,0);
beginShape();
vertex(-60,207);
curveVertex(110,0);
vertex(30,0);
endShape(CLOSE);
beginShape();
vertex(-60,-207);
curveVertex(110,0);
vertex(30,0);
endShape(CLOSE);
stroke(40, 110, 10);

strokeWeight(3.5);
line(55,0,101,0);
var a = 91;
line(a,0,a,6);
var a = 64;
line(a,0,a,6);
var a = 76;
line(a,-8,a,0);
    popMatrix();

    noFill();
    strokeWeight(5);
    stroke(34, 89, 0);
    arc(0,23,15,20,3,71);
    fill(227, 0, 0);
    //ellipse(22,15,10,15);
    fill(255, 149, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    popMatrix();

    point(-16,-4);
    },
    animImgBehind: function(e){
        pushMatrix();
    translate(0,21);
     rotate(-sin(frameCount*e.shakeIntensity+e.id)*e.shakeRad);
    fill(115, 52, 0);
    stroke(0,0,0);
    strokeWeight(3);
    ellipse(0,0,41,10);
    popMatrix();
    },
    animImgStatic: function(e){
    },
    },
    // Ice
    {
    name: 'Ice chicken',
    attack: 10,
    health: 6,
    size:1,
    discount: 0,
    tier: 6,
    bulletLife: 600,
    plusCardHeight:10,
    ability: function(lvl){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'Start of battle: deal 50% of attack damage to a random enemy, '+lvl+' time'+a;
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    for(var i = 0; i < lvl; i++){
    var options = eachAliveInTeamThenAll(1-t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health -= round(t.attack*0.5);
    select.checkStatUp();
    throwAbilityProj(t,select,20,round(t.attack*0.5),'iceball');
    }
    }
    },
    img:false,
    noBase:true,
    loadImg: function(e){
    pushMatrix();
    translate(0,25);
    scale(1,0.9);
    translate(0,-25);

    pushMatrix();

    stroke(0,0,0);
    strokeWeight(9);
    fill(0, 0, 0);
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(28,-16);
    vertex(21,-13);
    vertex(21,-30);
    vertex(16,-22);
    vertex(12,-41);
    vertex(6,-29);
    vertex(-3,-49);
    vertex(-7,-35);
    vertex(-23,-44);
    vertex(-19,-27);
    vertex(-34,-31);
    vertex(-22,-12);
    vertex(-31,-11);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();

    for(var i = 0; i < 3; i++){
    pushMatrix();

    translate(2,0);
    scale(1-i*0.3);
    translate(-2,0);

    noStroke();
    if(i === 0){
    fill(119, 252, 232);
    }else if(i === 1){
    fill(82, 232, 255);
    }else if(i === 2){
    fill(36, 171, 255);
    }
    ellipse(0,0,50,50);
    beginShape();
    vertex(25,0);
    vertex(28,-16);
    vertex(21,-13);
    vertex(21,-30);
    vertex(16,-22);
    vertex(12,-41);
    vertex(6,-29);
    vertex(-3,-49);
    vertex(-7,-35);
    vertex(-23,-44);
    vertex(-19,-27);
    vertex(-34,-31);
    vertex(-22,-12);
    vertex(-31,-11);
    vertex(-25,0);
    endShape(CLOSE);
    popMatrix();
    }
    popMatrix();

    fill(0, 67, 89);
    ellipse(22,15,10,15);
    fill(101, 210, 212);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(2);

    fill(242, 243, 255);
    arc(-8,-3,14,14,160,380);
    line(-8,-3,-8+cos(155)*7,-3+sin(155)*7);
    line(-8,-3,-8+cos(385)*7,-3+sin(385)*7);

    }
    },
    // }
    ],
    contraption:[
    // tier 1 {
    // egg tumbler
    {
    name: 'Egg tumbler',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    radius:25,
    tier: 1,
    bulletLife: 600,
    ability: function(lvl, t){
    return 'Click & Hold Me: roll all shops. Works '+lvl+' times per turn. ('+(lvl-t.triggers)+' triggers left)';
    },
    clickAndHold: function(t,lvl){
    if(t.triggers < lvl){
    t.triggers++;
    for(var i = 0; i < shop.length; i++){
    roll(i,false);
    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
    strokeWeight(5);
    stroke(0,0,0);

    fill(79, 49, 0);
    rect(-20,-20,40,40,5);
    egg(2.5,6,0.13);
    },
    animImg: function(e){
    strokeWeight(5);
    stroke(0,0,0);
    var p = 0;
    if(e.heldTimer){
        p=pow(e.heldTimer*2,1.5);
    }
    var h = cos(frameCount+e.id+p)*10;
    line(-19,0,-25,0);
    line(-25,h,-25,0);
    line(-25,h,-28,h);
    fill(201, 2, 2);
    strokeWeight(3);
    ellipse(-32,h,8,8);
    },
    },
    // chicken insurance
    {
    name: 'Chicken insurance',
    attack: 1,
    health: 3,
    size:1,
    discount: 1,
    radius:30,
    tier: 1,
    bulletLife: 600,
    plusCardHeight: 30,
    ability: function(lvl,t){
    var a = 's';
    if(t.triggers === 0){
    a = '';
    }
    return 'Chicken Bought: gain '+lvl+' gold.\nWorks 1 time per turn ('+(1-t.triggers)+' trigger'+a+' left)';
    },
    chickenBought: function(t,lvl){
    if(t.triggers < 1){
    t.triggers++;
    t.temporaryScale = 1.4;
    gold += lvl;
    coinAnim.s = 1.4;
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
    strokeWeight(4);
    stroke(0,0,0);
    fill(232, 232, 232);
    var num = 2;
    for(var i = num; i > -1; i--){
    rect(-20+(10/num)*i,-20+(5/num)*i,30,35,5);
    }
    strokeWeight(3);
    stroke(92, 92, 92);
    for(var i = 0; i < 3; i++){
    line(-12,-10+i*8,2,-10+i*8);
    }
    }
    },
    // }
    // tier 2 {
    // dart launcher
    {
    name: 'Dart launcher',
    attack: 2,
    health: 3,
    size:1,
    discount: -1,
    radius:30,
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Start of battle: deal '+(lvl*3)+' damage to a random enemy';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachAliveInTeamThenAll(1-t.teamId);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health -= lvl*3;
    throwAbilityProj(t,select,20,lvl*3,'dart');
    }
    },
    img:false,
    loadImg: function(e){
    strokeWeight(5);
    stroke(0,0,0);
    fill(153, 153, 153);
    rect(-20,-20,40,40,5);
    fill(0,0,0);
    noStroke();
    ellipse(15,0,15,15);
    stroke(0,0,0);
    strokeWeight(2);
    fill(0, 130, 7);
    rect(13,-3,20,6,3);
    }
    },
    // scarecrow
    {
    name: 'Scarecrow',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    radius:40,
    tier: 2,
    bulletLife: 600,
    plusCardHeight:10,
    ability: function(lvl){
    return 'Start of battle: remove '+lvl+' attack from all enemies\n(attack cannot go below 0)';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var options = eachInTeam(1-t.teamId);
    for(var i = 0; i < options.length; i++){
    var select = options[i];
    select.attack -= lvl;
    if(select.attack < 1){
    select.attack = 1;
    }
    throwAbilityProj(t,select,20,0,'special');
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(0,-18);
    stroke(0, 0, 0);
    strokeWeight(9);
    line(0,-20,0,44);
    line(-30,0,30,0);
    stroke(128, 79, 0);
    strokeWeight(6);
    line(0,-20,0,44);
    line(-30,0,30,0);

    stroke(0,0,0);
    strokeWeight(2);

    pushMatrix();
    translate(-8,25);
    rotate(30);
    for(var i = -20; i < 20; i+=8){
    pushMatrix();
    rotate(i);
    stroke(217+sin(i*1234)*20, 195, 139);
    line(0,0,0,16);
    popMatrix();
    }
    stroke(0,0,0);
    fill(0, 216, 227);
    rect(-5,-10,10,20,3);

    popMatrix();
    pushMatrix();
    translate(8,25);
    rotate(-30);
    for(var i = -20; i < 20; i+=8){
    pushMatrix();
    rotate(i);
    stroke(217+sin(i*234)*20, 195, 139);
    line(0,0,0,16);
    popMatrix();
    }
    stroke(0,0,0);
    fill(0, 216, 227);
    rect(-5,-10,10,20,3);

    popMatrix();


    pushMatrix();
    translate(-17,1);
    rotate(73);
    for(var i = -20; i < 20; i+=8){
    pushMatrix();
    rotate(i);
    stroke(217+sin(i*124)*20, 195, 139);
    line(0,0,0,18);
    popMatrix();
    }
    stroke(0,0,0);
    fill(199, 109, 109);
    rect(-5,-10,10,20,3);
    popMatrix();

    pushMatrix();
    translate(17,1);
    rotate(-73);
    for(var i = -20; i < 20; i+=8){
    pushMatrix();
    rotate(i);
    stroke(217+sin(i*344)*20, 195, 139);
    line(0,0,0,18);
    popMatrix();
    }
    stroke(0,0,0);
    fill(199, 109, 109);
    rect(-5,-10,10,20,3);
    popMatrix();
    fill(199, 109, 109);
    rect(-10,-12,20,30,10);


    strokeWeight(2);
    fill(0, 216, 227);
    rect(-6,-8,3,20,2);
    rect(3,-8,3,20,2);
    strokeWeight(2);
    rect(-10,8,20,10,10);

    fill(212, 212, 212);
    ellipse(0,-16,20,20);

    stroke(230, 0, 0);
    strokeWeight(4);
    point(-4,-16);
    point(4,-16);
    strokeWeight(2);
    line(-6,-21,-2,-19);
    line(6,-21,2,-19);
    noFill();
    arc(0,-10,10,6,200,340);

    stroke(0,0,0);
    strokeWeight(2);
    pushMatrix();
    translate(-1,-27);
    rotate(-5);
    fill(199, 178, 104);
    rect(-15,0,30,5,10);
    arc(0,2,15,18,180,360);
    stroke(18, 181, 0);
    strokeWeight(3);
    line(-8,2,8,2);
    popMatrix();
    popMatrix();
    },
    // animImg: function(e){
    // pushMatrix();
    // translate(0,-8);
    // scale(0.8);
    // var a2 = 0;
    // if(sin(frameCount/5) > 0.5){

    // if(!e.sayAnim){
    // var a4 = ['Me gusta KFC','GRRR','RAHHH','Be scared!','Juicy chickens\nyum yum','Chickens live\n5-10 years!'];

    // var q = floor(random(0,a4.length));
    // e.sayAnim = a4[q];
    // }
    // a2 = (sin(frameCount/5)-0.5)*18;
    // var a3 = a2*(255/9);
    // fill(196, 196, 196,a3);
    // stroke(0,0,0,a3);
    // strokeWeight(2);
    // rect(-30,0,60,30,2);
    // if(a3>0.2){
    // triangle(20,0,10,0,9,-6);
    // }
    // fill(0,0,0,a3);
    // textSize(5);
    // textAlign(CENTER,CENTER);
    // text(e.sayAnim,0,15);
    // }else{
    //     e.sayAnim = false;
    // }
    // stroke(230, 0, 0);
    // strokeWeight(2);
    // noFill();
    // arc(0,-10,10,6-a2,200,340);
    // popMatrix();
    // },
    },
    // }
    // tier 3 {
    // cookie jar
    {
    name: 'Cookie jar',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    radius:25,
    tier: 3,
    bulletLife: 600,
    plusCardHeight:35,
    ability: function(lvl, t){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'Click & Hold Me: give a random friend +1 attack and +1 health. Works '+lvl+' time'+a+' per turn.\n('+(lvl-t.triggers)+' triggers left)';
    },
    clickAndHold: function(t,lvl){
    if(t.triggers < lvl){
    t.triggers++;
    var options = allMyChickensExceptForArray([]);
    if(options.length > 0){
    var select = chooseFrom(options);
    select.health += 1;
    select.attack += 1;
    chickenFeed(t,select);
    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    crucialAnim:true,
    loadImg: function(e){
    },
    animImgBehind: function(e){



    var p = 0;
    if(e.heldTimer){
        p=pow(e.heldTimer*2,1.5);
    }
    var h = cos(frameCount+e.id+p)*10;
    var h2 = cos((frameCount+e.id+p)*2)*3+1;

    var pos = [
        {
        x:-7,
        y:15,
        r:-5,
        },
        {
        x:9,
        y:10,
        r:0+180,
        },
        {
        x:7,
        y:14,
        r:20,
        },
        {
        x:-8,
        y:7,
        r:15+180,
        },
        {
        x:8,
        y:2,
        r:-30,
        },
        ];
    for(var i = 0; i < pos.length; i++){
    pushMatrix();
    translate(pos[i].x,pos[i].y);
    translate(0,-abs(sin(p*cos(i*123))*5));
    rotate(pos[i].r);
    stroke(0,0,0);
    strokeWeight(3);
    fill(138, 86, 33);
    ellipse(0,0,20,10);
    strokeWeight(3);
    point(-8,-2);
    point(-3,2);
    point(-1,-2);
    point(5,-1);
    popMatrix();
    }

    strokeWeight(5);
    stroke(0,0,0);
    fill(161, 161, 161,80);
    rect(-20,-20,40,40,5);
    //egg(2.5,6,0.13);


    strokeWeight(5);
    stroke(0,0,0);
    pushMatrix();
    translate(0,-h2);
    translate(0,-20);
    rotate(h);
    translate(0,20);

    stroke(0,0,0);
    strokeWeight(5);
    fill(119, 199, 174);
    arc(0,-20,40,30,180,360);
    line(-20,-20,20,-20);
    fill(0, 53, 56);
    ellipse(0,-35,10,10);
    popMatrix();

    },
    },
    // windmill
    {
    name: 'Windmill',
    attack: 2,
    health: 3,
    size:1,
    discount: 0,
    radius:45,
    tier: 3,
    bulletLife: 600,
    ability: function(lvl){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'Start of battle: deal 1 damage to all chickens '+(lvl)+' time'+a;
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;

    for(var i = 0; i < 2; i++){
    var all = eachChickenInTeam(i);
    for(var q = 0; q < all.length; q++){
    for(var q2 = 0; q2 < lvl; q2++){
    all[q].health -= 1;
    all[q].checkStatUp();
    }
    throwAbilityProj(t,all[q],12,lvl+1,'dart');
    }
    }

    },
    img:false,
    crucialAnim:true,
    loadImg: function(e){
    pushMatrix();
    translate(0,-17);
    stroke(0, 0, 0);
    strokeWeight(7);
    line(-10,40,0,-10);
    line(10,40,0,-10);
    line(-3,10,5,16);
    line(-7,29,5,16);
    stroke(176, 138, 67);
    strokeWeight(4);
    line(-10,40,0,-10);
    line(10,40,0,-10);
    line(-3,10,5,16);
    line(-7,29,5,16);

    stroke(186, 186, 186);
    noFill();
    strokeWeight(2);
    line(-9,-10,9,-10);
    line(0,-19,0,-1);
    line(18,-5,10,-7);
    strokeWeight(3);
    ellipse(0,-10,20,20);
     pushMatrix();
    translate(11,-7);
    rotate(107);
    stroke(0,0,0);
    strokeWeight(2);
    fill(252, 133, 133);
    quad(-2,-5,2,-5,4,-20,-4,-20);
    popMatrix();
    popMatrix();
    },
    animImg: function(e){
    pushMatrix();
    translate(0,-17);
    for(var i = 0; i < 360; i+= 360/5){
    pushMatrix();
    translate(0,-10);
    rotate(i+frameCount/1.4);
    stroke(0,0,0);
    strokeWeight(2);
    fill(212, 0, 0);
    quad(-2,-5,2,-5,4,-20,-4,-20);
    popMatrix();
    }
    popMatrix();
    },
    },
    //}
    // tier 4 {
    // smoothie machine
    {
    name: 'Smoothie machine',
    attack: 1,
    health: 3,
    size:1.2,
    discount: 0,
    radius:30,
    tier: 4,
    bulletLife: 600,
    plusCardHeight: 0,
    ability: function(lvl,t){
    return 'Chicken Bought: give it +'+lvl+' attack and +'+(lvl)+' health';
    },
    chickenBought: function(t,lvl){
    if(lastBought){
    lastBought.attack += lvl;
    lastBought.health += lvl;
    chickenFeed(t,lastBought);
    }
    },
    img:false,
    animImgBehind: function(e){
    noStroke();
    var num = 30;
    var a = cos(frameCount);
    var a2 = sin(frameCount*1.5)*num;

    fill(255+a2-num, 0, 242+a2-num);
    arc(0,-7,23,24,0+a*10,180+a*10);

    },
    loadImg: function(e){
    strokeWeight(6);
    stroke(122, 122, 122);
    line(0,7,0,10);
    noStroke();
    fill(84, 84, 84);

    beginShape();
    vertex(-13,-15);
    vertex(-5,-10);
    vertex(5,-10);
    vertex(13,-15);
    vertex(9,-22);
    vertex(-10,-22);
    endShape(CLOSE);

    strokeWeight(3);
    stroke(0,0,0);
    fill(122, 122, 122);
    arc(0,20,26,20,180,360);
    line(-13,20,13,20);
    fill(179, 179, 179, 150);
    arc(0,-15,26,40,0,180);
    line(-13,-15,13,-15);
    line(-17,-12,-13,-12);
    line(-17,-12,-16,-3);
    line(-16,-3,-10,0);
    fill(0,0,0);
    noStroke();
    triangle(0,-15,22,-15,13,-11);
    stroke(82, 82, 82);
    strokeWeight(1);
    fill(255, 20, 20);
    ellipse(-5,15,8,8);
    fill(23, 199, 0);
    ellipse(5,15,8,8);
    }
    },
    // hot sauce pump
    {
    name: 'Hot sauce pump',
    attack: 2,
    health: 3,
    size:1,
    discount: -1,
    radius:40,
    tier: 4,
    bulletLife: 600,
    plusCardHeight:0,
    ability: function(lvl, t){
    var a = '';
    if(lvl > 1){
    a = 's';
    }
    return 'Chicken friend eats food: give it +'+(2*lvl)+' attack and deal 1 damage to it';
    },
    chickenFriendEatsFood: function(t,lvl){
    if(lastFed){
    lastFed.attack += lvl*2;
    lastFed.health -= 1;
    chickenFeed(t,lastFed);
    }
    },
    img:false,
    loadImg: function(e){
        pushMatrix();
    translate(-34,3);
    strokeWeight(3);
    stroke(102, 102, 102);
    line(30,6,22,6);
    line(30,15,22,15);

    stroke(0,0,0);
    fill(252, 175, 98,220);
    rect(0,0,20,20,6);
    stroke(191, 191, 191);

    stroke(0, 0, 0);
    strokeWeight(7);
    line(10,-3,10,-31);
    line(40,-31,10,-31);
    line(39,-31,39,0);
    line(11,-3,11,-30);
    line(40,-30,11,-30);
    line(40,-30,40,0);

    stroke(191, 191, 191);
    strokeWeight(4);
    line(10,-3,10,-31);
    line(40,-31,10,-31);
    line(39,-31,39,0);
    stroke(156, 156, 156);
    line(11,-3,11,-30);
    line(40,-30,11,-30);
    line(40,-30,40,0);

    stroke(0,0,0);
    strokeWeight(3);
    fill(255, 0, 0);
    rect(7,-4,6,5,6);
    noStroke();
    for(var i = 0; i < 3; i++){
    pushMatrix();
    translate(10,13);
    rotate(13);
    scale(1-i*(0.3));
    if(i === 0){
    fill(227, 0, 0);
    }else if(i === 1){
    fill(227, 140, 0);
    }else if(i === 2){
    fill(227, 193, 0);
    }
    ellipse(0,0,8,8);
    triangle(-4,0,-2,-9,4,0);
    triangle(-1,0,3,-7,4,0);
    popMatrix();
    }

    stroke(0,0,0);
    strokeWeight(3);
    fill(217, 237, 0);
    arc(57,-10,20,34,180,360);
    fill(173, 173, 173);
    rect(30,-10,40,30,4);
    strokeWeight(2);
    fill(245, 245, 245);
    ellipse(50,10,30,10);

    pushMatrix();
    translate(57,-17);
    noFill();
    stroke(0,0,0);
    strokeWeight(1);
    ellipse(0,0,10,10);
    fill(0,0,0);
    noStroke();
    arc(0,0,8,8,60,120);
    arc(0,0,8,8,180,240);
    arc(0,0,8,8,300,360);
    stroke(209, 222, 64);
    strokeWeight(3);
    point(0,0);
    stroke(0, 0, 0);
    strokeWeight(2);
    point(0,0);
    popMatrix();

    pushMatrix();
    scale(0.8);
    translate(35,10);
    rotate(-43);
    strokeWeight(2);
    stroke(0,0,0);
    fill(255, 184, 31);
    triangle(28,32,9,14,27,12);

    strokeWeight(1);
    fill(181, 16, 16);
    ellipse(17,15,5,5);
    ellipse(24,19,5,5);
    ellipse(23,26,5,5);

    pushMatrix();
    translate(6.5,10);
    rotate(-7);
    strokeWeight(2);
    stroke(0,0,0);
    fill(168, 82, 28);
    rect(0,0,21,4,2);
    popMatrix();
    popMatrix();

    strokeWeight(2);
    stroke(0,0,0);
    fill(0, 219, 219,100);
    rect(34,-4,32,20,4);
    fill(255, 46, 46);
    ellipse(38,-7,6,6);
    fill(48, 255, 107);
    ellipse(47,-7,6,6);
    fill(255, 48, 238);
    rect(53,-9,10,4,2);


    popMatrix();
    },
    animImgBehind: function(e){
         pushMatrix();
    translate(-34,3);
    strokeWeight(4);
    stroke(0, 0, 0,200);
    point(10+cos(frameCount*3)*6,10+sin(frameCount)*6);
    point(10+sin(frameCount*2.5)*6,10+cos(frameCount)*6);
    popMatrix();
    },
    },
    // }
    // tier 5 {
    // rocket launcher
    {
    name: 'Rocket launcher',
    attack: 2,
    health: 3,
    size:1,
    discount: -1,
    radius:40,
    tier: 5,
    bulletLife: 600,
    ability: function(lvl){
    return 'Start of battle: deal '+(lvl*8)+' damage to the healthiest enemy';
    },
    startOfBattle: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    var num = 0;
    var from = false;

    var all = eachChickenInTeam(1-t.teamId);
    for(var i = 0; i < all.length; i++){
    if(all[i].health > num){
    num = all[i].health;
    from  = all[i];
    }
    }
    if(num && from){

    from.health -= lvl*8;
    throwAbilityProj(t,from,7,lvl*8,'missile');
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    scale(5/4);
    translate(0,-23);
    pushMatrix();
    rotate(30);
    for(var q = 0; q < 3; q++){
    pushMatrix();
    translate(30-q*15,0);
    scale(0.15);
    rotate(-90);
    //{

stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(n)*30;
if(cos(n) <= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}
stroke(0,0,0);
fill(235, 235, 235);
strokeWeight(10);
rect(-190,-30,306,60,5);
noStroke();
var h = 30;
for(var i = 0; i < 6; i++){
var n = i*(360/6);
var r = sin(n)*30;
if(cos(n+h) >= 0){
if(i/2 === round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(14+30,r,25,cos(n+h)*h,5);
if(i/2 !== round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(25,r,25,cos(n+h)*h,5);
}
}
stroke(0,0,0);
noFill();
strokeWeight(10);
rect(-190,-30,306,60,5);
fill(255,0,21);
triangle(200,0,100,-50,100,50);
fill(212, 212, 212,120);
noStroke();
pushMatrix();
translate(135,-19);
rotate(25);
ellipse(0,0,57,9);
popMatrix();
stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(n)*30;
if(abs(r) < 0.0001){
r = 0.0001;
}
if(cos(n) >= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}
strokeWeight(7);
rect(-194,-35,10,70,5);
rect(-22,-35,10,70,5);
// }
    popMatrix();
    }
    pushMatrix();
    stroke(84, 84, 84);
    strokeWeight(3);
    line(-10,11,38,28);
    line(-10,28,38,11);
    stroke(0,0,0);
    strokeWeight(3);
    fill(209, 209, 209);
    rect(-12,4,52,8,4);
    fill(92, 92, 92);
    rect(-12,25,52,5,4);
    strokeWeight(2);
    fill(179, 179, 179);
    ellipse(5,31,10,5);
    popMatrix();
    popMatrix();
    stroke(0, 0, 0);
    strokeWeight(4);
    line(-20,26,-20,46);
    strokeWeight(4);
    line(-24,22,-24,46);
    stroke(92, 92, 92);
    strokeWeight(2);
    line(-22,20,-22,46);
    stroke(102, 102, 102);
    strokeWeight(3);
    fill(148, 140, 129);
    rect(-28,35,49,13,10);
    stroke(0, 0, 0);
    strokeWeight(2);
    fill(207, 207, 207);
    ellipse(-3,42,12,12);
    ellipse(-21,42,12,12);
    ellipse(15,42,12,12);
    line(-12,39,-12,45);
    line(6,39,6,45);
    strokeWeight(4);
    point(-3,42);
    point(-21,42);
    point(15,42);
    popMatrix();
    }
    },
    // generator
    {
    name: 'Generator',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    radius:35,
    tier: 5,
    bulletLife: 600,
    plusCardHeight: 25,
    ability: function(lvl){
    return 'Start of turn: gain '+(lvl*2)+' merge power. If the merge bar is out of order, instead gain +'+(lvl)+' gold';
    },
    startOfTurn: function(t,lvl){
    t.temporaryScale = 1.3;
    t.temporaryRot = -20;
    if(myCoops.length < 3){
    power += lvl*2;
    power = round(power);
    }else{
    gold += lvl;
    gold = round(gold);
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    scale(0.7);
    stroke(0,0,0);
    strokeWeight(4);
    line(24,30,24,42);
    fill(207, 207, 207);
    rect(-45,-30,90,60,3);
    fill(82, 82, 82);
    ellipse(-40,30,24,24);
    rect(16,38,15,4,3);
    beginShape();
    vertex(18,-53);
    vertex(18,-30);
    vertex(30,-30);
    vertex(30,-50);
    vertex(40,-50);
    vertex(40,-60);
    vertex(27,-60);
    //vertex(21,-57);
    endShape();
    arc(27,-53,18,14,180,270);

    fill(201, 201, 201);
    ellipse(-40,30,10,10);
    fill(130, 232, 255);
    rect(-20,15,56,15,2);
    rect(-45,-20,48,25,2);
    rect(20,-20,25,25,2);
    rect(12,-40,24,10,2);

    strokeWeight(2);
    for(var i = 0; i < 4; i++){
        var a = (i+1)*56/5;
        line(-20+a,20,-20+a,26);
    }
    fill(0, 255, 9);
    ellipse(-34,-12,7,7);
    fill(255, 32, 28);
    ellipse(-34,-2,7,7);
    fill(70, 175, 250);
    rect(-23,-15,17,15,2);

    stroke(0,0,0);
    fill(255, 234, 0);
    pushMatrix();
    translate(34,-9);
    scale(0.66);
    beginShape();
    vertex(0,-10);
    vertex(-7,2);
    vertex(-1,7);
    vertex(0,15);
    vertex(6,5);
    vertex(1,0);
    endShape(CLOSE);
    popMatrix();
    popMatrix();
    },
    animImg: function(e){
    pushMatrix();
    scale(0.7);
    noFill();
    strokeWeight(2);
    stroke(251, 0, 255);
    arc(-17,-7,6,sin(frameCount)*4,195,360);
    arc(-11,-7,6,-sin(frameCount)*4,180,345);
    popMatrix();
    },
    },
    // }
    // tier 6 {
    // cloning machine
    {
    name: 'Cloning machine',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    radius:40,
    tier: 6,
    bulletLife: 600,
    plusCardHeight:75,
    ability: function(lvl, t){
    var a = '';
    if(lvl > 1){
        a = 's';
    }
    return 'Click & Hold Me: replace shop page 1 with '+(lvl)+' chicken'+a+' with the same name as a random chicken on your team. \nWorks 1 time per turn.\n('+(1-t.triggers)+' triggers left)';
    },
    clickAndHold: function(t,lvl){
    if(t.triggers < 1){
    t.triggers++;
    var options = allMyChickensExceptForArray([]);
    if(options.length > 0){
    var select = chooseFrom(options);

    shop[0].frozens = [];
    cleanShop(0);
    shop[0].data = [];
    shopPage = 0;
    for(var i = 0; i < lvl; i++){
        var a = new chicken(t.x,t.y,stats.chicken[select.name]);
        shop[0].data.push(a);
    }

    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
        pushMatrix();
        scale(0.9);
    pushMatrix();
    translate(-3,0);
    scale(0.5);
    stroke(28, 227, 190, 100);
    strokeWeight(5);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(4,-26);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);
    strokeWeight(10);
    point(-8,-3);
    popMatrix();

    noStroke();
    fill(87, 213, 255,100);
    rect(-20,-38,40,68);

    stroke(0,0,0);
    strokeWeight(3);
    fill(230, 230, 230);
    arc(0,30,40,20,180,360);
    line(-20,30,20,30);
    arc(0,-40,40,20,0,180);
    line(-20,-40,20,-40);
    noFill();
    strokeWeight(6);
    stroke(0, 0, 0);
    arc(20,-5,30,70,-90,90);
    arc(-20,-5,30,70,90,270);
    strokeWeight(3);
    stroke(255, 213, 0);
    arc(20,-5,30,70,-90,90);
    arc(-20,-5,30,70,90,270);

    strokeWeight(2);
    fill(0, 255, 13);
    ellipse(0,-35,5,5);
    fill(225, 255, 0);
    ellipse(0,25,5,5);
    popMatrix();

    },
    animImgBehind: function(e){
    pushMatrix();
    scale(0.9);
    pushMatrix();
    translate(-3,0);
    scale(0.5);
    scale(1,1.2+cos(frameCount)*0.2);
    stroke(28, 227, 190, 100);
    strokeWeight(5);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(4,-26);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);
    strokeWeight(10);
    point(-8,-3);
    popMatrix();
    var p = 0;
    if(e.heldTimer){
        p=pow(e.heldTimer*2,1.3);
    }
    var a = cos(frameCount+p)*4;
    noStroke();
    fill(87, 213, 255,100);
    rect(-a/2+sin(frameCount+p)*18,-38,a,68);

    popMatrix();
    },
    },
    // advent calendar
    {
    name: 'Advent calendar',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    radius:25,
    tier: 6,
    bulletLife: 600,
    plusCardHeight:35,
    ability: function(lvl, t){
    var a = '';
    if(lvl > 1){
        a = 's';
    }
    return 'Click & Hold Me: replace shop page 2 with '+lvl+' chocolate'+a+'.\nWorks 1 time per turn.\n('+(1-t.triggers)+' triggers left)';
    },
    clickAndHold: function(t,lvl){
    if(t.triggers < 1){
    t.triggers++;

    shop[1].frozens = [];
    cleanShop(1);
    shop[1].data = [];
    shopPage = 1;
    for(var i = 0; i < lvl; i++){
        var a = new foodItem(t.x,t.y,stats.food.Chocolate);
        shop[1].data.push(a);
    }
    }else{
    t.bad = 30;
    t.badMessage = 'Out of triggers';
    t.temporaryRot = -20;
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(-19.5,-19.5);
    stroke(0, 0, 0);
    strokeWeight(2);
    fill(92, 64, 21);
    rect(17,-10,5,10);
    strokeWeight(4);
    fill(0,0,0);
    triangle(19.5,-17,14,-9,25,-9);
    triangle(19.5,-22,15,-14,24,-14);

    noStroke();
    fill(3, 171, 42);
    triangle(19.5,-17,14,-9,25,-9);
    triangle(19.5,-22,15,-14,24,-14);
    fill(255, 0, 0);
    ellipse(18,-18,2,2);
    ellipse(22,-16,2,2);
    ellipse(19,-13.5,2,2);
    ellipse(23,-11,2,2);
    ellipse(16,-10,2,2);

    pushMatrix();
    strokeWeight(1);
    stroke(0,0,0);
    fill(255, 255, 0);
    translate(19.5,-25);
    beginShape();
    for(var i = 55; i < 360+360/5; i += 360/5){
    vertex(cos(i)*4,sin(i)*4);
    vertex(cos(i+360/10)*2,sin(i+360/10)*2);   
    }
    endShape(CLOSE);
    popMatrix();

    stroke(0, 0, 0);
    strokeWeight(3);
    fill(219, 46, 46);
    rect(-3,-3,45,45,1);



    stroke(240, 221, 168);
    strokeWeight(1);
    fill(196, 78, 78);
    for(var i = 0; i < 5; i++){
        for(var q = 0; q < 5; q++){
            rect(i*8,q*8,7,7,1);
        }
    }
    fill(255, 230, 0);
    textAlign(CENTER,CENTER);
    textSize(3);
    stroke(0,0,0);
    strokeWeight(2);
    for(var i = 0; i < 5; i++){
        for(var q = 0; q < 5; q++){
            text('~~',i*8+3,q*8+4);
            point(i*8+6,q*8+4);
        }
    }

    popMatrix();
    },
    animImgBehind: function(e){
    },
    },
    // }
    ],
    food:[
    // tier 1 {
    // apple
    {
    name: 'Apple',
    attack: 2,
    health: 4,
    size:0.7,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +1 attack and +2 health permanently';
    },
    applied: function(t,subj){
    subj.attack += 1;
    subj.health += 2;
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    strokeWeight(8);
    stroke(0,0,0);
    fill(247, 37, 37);
    ellipse(0,0,60,60);
    stroke(102, 61, 10);
    line(5,-20,20,-35);
    noStroke();
    fill(15, 135, 4);
    ellipse(0,-25,15,24);
    }
    },
    // oil
    {
    name: 'Oil',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'contraptions',
    targets: function(){
    return myContraptions;
    },
    tier: 1,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a contraption +3 durability';
    },
    applied: function(t,subj){
    subj.health += 3;
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    rotate(-20);
    strokeWeight(4);
    stroke(0, 0, 0);
    fill(128, 128, 128);
    rect(-15,-25,30,50,10);
    fill(77, 77, 77);
    ellipse(0.5,-20,30,10);
    noFill();
    strokeWeight(2);
    for(var i = 0; i < 2; i++){
    arc(0,i*(25/2)-6,30,10,0,180);
    }
    popMatrix();
    }
    },
    // testing
    // {
    // name: 'poke',
    // attack: 2,
    // health: 4,
    // size:1,
    // discount: 0,
    // targetString: 'chickens',
    // targets: function(){
    // return allMyChickensExceptForArray([]);
    // },
    // tier: 1,
    // bulletLife: 600,
    // ability: function(lvl){
    // return 'deal 1 damage (this is an item for playtesting)';
    // },
    // applied: function(t,subj){
    // subj.health -= 1;
    // feedProj(subj);
    // },
    // img:false,
    // loadImg: function(e){
    // pushMatrix();
    // rotate(-20);
    // strokeWeight(4);
    // stroke(0, 0, 0);
    // fill(128, 128, 128);
    // rect(-15,-25,30,50,10);
    // fill(77, 77, 77);
    // ellipse(0.5,-20,30,10);
    // noFill();
    // strokeWeight(2);
    // for(var i = 0; i < 2; i++){
    // arc(0,i*(25/2)-6,30,10,0,180);
    // }
    // popMatrix();
    // }
    // },
    // }
    // tier 2 {
    // sandwich
    {
    name: 'Sandwich',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +4 attack and +4 health for one turn';
    },
    applied: function(t,subj){
    temporaryStat(subj,4,4);
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    strokeWeight(4);
    stroke(0,0,0);
    fill(186, 153, 93);
    quad(-25,-5,5,-13,25,5,-5,13);
    noStroke();
    pushMatrix();
    translate(-4,-3);
    fill(20, 168, 35);
    quad(-25,-5,5,-13,25,5,-5,13);
    translate(5,-2);
    fill(224, 49, 64);
    quad(-25,-5,5,-13,25,5,-5,13);
    popMatrix();
    strokeWeight(4);
    stroke(0,0,0);
    fill(186, 153, 93);
    quad(-25,-15,5,-23,25,-5,-5,3);
    }
    },
    // baguette
    {
    name: strikeThrough('French Bread')+' Baguette',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 2,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +4 health';
    },
    applied: function(t,subj){
    subj.health += 4;
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(0,10);
    rotate(-45);
    translate(0,-10);
    strokeWeight(4);
    stroke(0,0,0);
    fill(186, 153, 93);
    rect(-30,-5,74,15,10);
    strokeWeight(4);
    stroke(69, 47, 12);
    var max = 7;
    for(var i = 1; i < max; i++){
    var x = (7)+i*10-(max/2)*10;
    line(x-2,6,x+2,0);
    }
    popMatrix();
    }
    },
    // }
    // tier 3 {
    // battery
    {
    name: 'Battery',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'contraptions',
    targets: function(){
    var a = [];
    for(var i = 0; i < myContraptions.length; i++){
    if(getLevel(myContraptions[i].xp)>=3){
    a.push(myContraptions[i]);
    }
    }
    return allExceptForArray(myContraptions,a);
    },
    tier: 3,
    bulletLife: 600,
    ability: function(lvl){
    return 'Level up a contraption';
    },
    applied: function(t,subj){
    subj.xp += 3;
    xpProj(subj,3);
    //var splatter = new effect(subj.x,subj.y,'xp splatter',1.4,200,{amount:3});
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    rotate(-20);
    strokeWeight(4);
    stroke(0, 0, 0);
    fill(98, 227, 18);
    rect(-15,-25,30,50,10);
    fill(19, 89, 11);
    ellipse(0.5,-20,30,10);
    fill(0,0,0);
    noStroke();
    ellipse(0,-23,15,10);
    stroke(0,0,0);
    strokeWeight(3);
    fill(255, 234, 0);
    pushMatrix();
    translate(0,2);
    beginShape();
    vertex(0,-10);
    vertex(-7,-2);
    vertex(-1,7);
    vertex(0,15);
    vertex(7,5);
    vertex(2,-2);
    endShape(CLOSE);
    popMatrix();
    popMatrix();
    }
    },
    // orange
    {
    name: 'Orange',
    attack: 2,
    health: 4,
    size:0.7,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 3,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +2 attack and +3 health permanently';
    },
    applied: function(t,subj){
    subj.attack += 2;
    subj.health += 3;
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    strokeWeight(8);
    stroke(0,0,0);
    fill(240, 129, 19);
    ellipse(0,0,60,60);
    stroke(102, 61, 10);
    line(5,-20,20,-35);
    noStroke();
    fill(15, 135, 4);
    ellipse(0,-25,15,24);
    }
    },
    // }
    // tier 4 {
    // chocolate
    {
    name: 'Chocolate',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return filt(allMyChickensExceptForArray([]),function(e){
    if(getLevel(e.xp) >= 3){
    return false;
    }
    return true;
    });
    },
    tier: 4,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +1 xp';
    },
    applied: function(t,subj){
    subj.xp += 1;
    xpProj(subj);
    //var splatter = new effect(subj.x,subj.y,'xp splatter',1.4,200,{amount:3});
    },
    img:false,
    loadImg: function(e){
        pushMatrix();

    rotate(52);
    scale(1.2);
    translate(-8,-19);
    stroke(0, 0, 0);
    fill(99, 47, 4);
    strokeWeight(3);
    rect(1,-3,19,30,4);
    stroke(46, 25, 1);
    strokeWeight(2);
    noFill();
    rect(4,1,5,5,2);
    rect(12,1,5,5,2);
    rect(4,9,5,5,2);
    rect(12,9,5,5,2);
    strokeWeight(3);
    stroke(0,0,0);
    fill(252, 41, 41);
    quad(1,12,21,20,21,38,1,38);
    stroke(0, 0, 0);
    strokeWeight(7);
    line(0,14,21,20);
    stroke(255,255,255);
    strokeWeight(3);
    line(0,14,21,20);
    popMatrix();
    }
    },
    // melon
    {
    name: 'Melon',
    attack: 2,
    health: 4,
    size:0.7,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 4,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +2 attack and +5 health permanently';
    },
    applied: function(t,subj){
    subj.attack += 2;
    subj.health += 5;
    feedProj(subj);
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    scale(1.4);
    strokeWeight(8);
    stroke(0,0,0);
    fill(154, 232, 146);
    ellipse(0,0,60,60);

    for(var i = 1; i < 3; i++){
    noFill();
    strokeWeight(2);
    stroke(13, 143, 28);
    ellipse(0,0,60-i*23,60);
    }


    noFill();
    strokeWeight(8);
    stroke(0,0,0);
    ellipse(0,0,60,60);

    stroke(102, 61, 10);
    line(5,-20,20,-35);
    noStroke();
    fill(15, 135, 4);
    ellipse(0,-25,15,24);
    popMatrix();
    }
    },
    // }
    // tier 5 {
    // grapes
    {
    name: 'Grapes',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 5,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +1 attack and +1 health. Also give each other chicken +2 health.';
    },
    applied: function(t,subj){
    subj.attack += 1;
    subj.health += 1;
    feedProj(subj);
    var all = allMyChickensExceptForArray([subj]);
    for(var i = 0; i < all.length; i++){
        all[i].health += 2;
        feedProj(all[i]);
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(6,0);
    scale(0.6);
    rotate(-25);
    stroke(64, 38, 0);
    strokeWeight(6);
    noFill();
    pushMatrix();
    translate(-78,-20);
    rotate(78);
    arc(0,0,132,143,240,280);
    popMatrix();
    pushMatrix();
    translate(35,-105);
    rotate(226);
    arc(0,0,57,143,240,271);
    popMatrix();

    stroke(0,0,0);
    fill(26, 212, 100);
    pushMatrix();
    translate(-1,-54);
    rotate(17);
    ellipse(11,1,30,15);
    popMatrix();
    pushMatrix();
    translate(-3,-54);
    rotate(-30);
    ellipse(11,1,30,15);
    popMatrix();

    stroke(0,0,0);
    fill(213, 0, 255);
    ellipse(-25,-30,20,20);
    ellipse(7,-24,20,20);
    ellipse(-9,-25,20,20);

    ellipse(-7,30,20,20);

    ellipse(-16,18,20,20);
    ellipse(0,16,20,20);

    ellipse(-24,1,20,20);
    ellipse(9,1,20,20);
    ellipse(-8,5,20,20);

    ellipse(-29,-15,20,20);
    ellipse(17,-15,20,20);
    ellipse(4,-11,20,20);
    ellipse(-13,-12,20,20);

    popMatrix();
    }
    },
    // pineapple
    {
    name: 'Pineapple',
    attack: 2,
    health: 4,
    size:1,
    discount: 1,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 5,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +2 health. Also gain +2 gold next turn.';
    },
    applied: function(t,subj){
    subj.health += 2;
    feedProj(subj);
    bonusGold += 2;
    },
    img:false,
    loadImg: function(e){
   pushMatrix();
   translate(0,4);
    scale(1.24);
    fill(0, 227, 19);
    stroke(0,0,0);
    strokeWeight(30);
    pushMatrix();
    translate(-18,-44);
    scale(0.08);
beginShape();
vertex(142,444);
    vertex(142,358);
    vertex(50,225);
    vertex(163,266);
    vertex(129,120);
    vertex(213,211);
    vertex(248,75);
    vertex(274,216);
    vertex(348,149);
    vertex(317,272);
    vertex(408,250);
    vertex(323,372);
    vertex(320,441);
endShape(CLOSE);
popMatrix();
noStroke();
fill(0, 176, 44);
pushMatrix();
    translate(-8,-29);
    scale(0.04);
beginShape();
vertex(142,444);
    vertex(142,358);
    vertex(50,225);
    vertex(163,266);
    vertex(129,120);
    vertex(213,211);
    vertex(248,75);
    vertex(274,216);
    vertex(348,149);
    vertex(317,272);
    vertex(408,250);
    vertex(323,372);
    vertex(320,441);
endShape(CLOSE);
popMatrix();

    //stroke(0,0,0);
    strokeWeight(2);
    noStroke();
    fill(255, 251, 0);
    ellipse(0,0,24,30);
    stroke(135, 79, 0);
    var a = [16,24,26,20];
    var a2 = [21,26,25,17];
    var amt = 30;
    for(var i = -90; i < 30; i+=amt){
    line(cos(i)*12,sin(i)*15,cos(i)*12+cos(135)*a[(i+90)/amt],sin(i)*15+sin(135)*a[(i+90)/amt]);
    }
    for(var i = -90; i < 30; i+=amt){
    line(-cos(i)*12,sin(i)*15,-cos(i)*12+cos(55)*a2[(i+90)/amt],sin(i)*15+sin(55)*a2[(i+90)/amt]);
    }

    stroke(0,0,0);
    strokeWeight(3);
    noFill();
    ellipse(0,0,24,30);

    popMatrix();
    }
    },
    // }
    // tier 6 {
    // white chocolate
    {
    name: 'White Chocolate',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return filt(allMyChickensExceptForArray([]),function(e){
    if(getLevel(e.xp) >= 3){
    return false;
    }
    return true;
    });
    },
    tier: 6,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +1 xp permanently and +3/+4 for one turn';
    },
    applied: function(t,subj){
    subj.xp += 1;
    temporaryStat(subj,3,4);
    xpProj(subj);
    feedProj(subj);
    //var splatter = new effect(subj.x,subj.y,'xp splatter',1.4,200,{amount:3});
    },
    img:false,
    loadImg: function(e){
        pushMatrix();

    rotate(52);
    scale(1.2);
    translate(-8,-19);
    stroke(0, 0, 0);
    fill(245, 218, 196);
    strokeWeight(3);
    rect(1,-3,19,30,4);
    stroke(235, 203, 155);
    strokeWeight(2);
    noFill();
    rect(4,1,5,5,2);
    rect(12,1,5,5,2);
    rect(4,9,5,5,2);
    rect(12,9,5,5,2);
    strokeWeight(3);
    stroke(0,0,0);
    fill(189, 189, 189);
    quad(1,12,21,20,21,38,1,38);
    stroke(0, 0, 0);
    strokeWeight(7);
    line(0,14,21,20);
    stroke(255,255,255);
    strokeWeight(3);
    line(0,14,21,20);
    noStroke();
    fill(247, 247, 86);
    pushMatrix();
    translate(10.8,28.5);
    beginShape();
    for(var i = 0; i < 360; i += 360/5){
    vertex(cos(i)*5,sin(i)*5);
    vertex(cos(i+360/10)*2.5,sin(i+360/10)*2.5);   
    }
    endShape();
    popMatrix();
    popMatrix();
    }
    },
    // popcorn
    {
    name: 'Popcorn',
    attack: 2,
    health: 4,
    size:1,
    discount: 0,
    targetString: 'chickens',
    targets: function(){
    return allMyChickensExceptForArray([]);
    },
    tier: 6,
    bulletLife: 600,
    ability: function(lvl){
    return 'Give a chicken +2 attack and +3 health. Also replace shop page 2 with 2 discounted oils';
    },
    applied: function(t,subj){
    subj.attack += 3;
    subj.health += 4;
    feedProj(subj);
    shop[1].frozens = [];
    cleanShop(1);
    shop[1].data = [];
    shopPage = 1;
    for(var i = 0; i < 2; i++){
        var a = new foodItem(t.x,t.y,stats.food.Oil);
        shop[1].data.push(a);
        shop[1].data[shop[1].data.length-1].price = 1;
    }
    },
    img:false,
    loadImg: function(e){
    pushMatrix();
    translate(0,-5);
    rotate(0);
    scale(0.7);


    var corn = function(x,y,r){
    pushMatrix();
    translate(x,y);
    scale(0.7);
    rotate(r);
    stroke(0,0,0);
    strokeWeight(9);
    noFill();
    ellipse(0,0,12,12);
    ellipse(6,4,6,6);
    ellipse(-6,4,6,6);
    noStroke();
    fill(255, 243, 130);
    ellipse(0,0,12,12);
    ellipse(6,4,6,6);
    ellipse(-6,4,6,6);
    popMatrix();
    };

    noFill();
    stroke(0,0,0);
    strokeWeight(6);
    beginShape();
    vertex(30,-17);
    vertex(0,0);
    vertex(-21,-15);
    vertex(0,-30);
    endShape(CLOSE);

    for(var i = 0; i < 50; i++){
        var a = sin(i*128)*360;
        corn(0+cos(a)*23*cos(i*123),-15+sin(a)*22*cos(i*123),sin(i*20)*20);
    }

    stroke(0,0,0);
    strokeWeight(2);
    var a = false;
    for(var i = -20; i < 40; i += 10){
    a = !a;
    if(a){
        fill(242, 80, 80);
    }else{
        fill(235, 235, 235);
    }
    beginShape();
    vertex(i-10,abs(i-10)*-0.5);
    vertex(i,abs(i)*-0.5);
    vertex(i,abs(i)*-0.5+50);
    vertex(i-10,abs(i-10)*-0.5+50);
    endShape(CLOSE);
    }
    noFill();
    stroke(0,0,0);
    strokeWeight(6);
    beginShape();
    vertex(-30,-15);
    vertex(-30,35);
    vertex(0,50);
    vertex(30,35);
    vertex(30,-15);
    vertex(0,0);
    endShape(CLOSE);

    popMatrix();
    }
    },
    // }
        ],
};

var TESTINGCHICKEN = 'Light chicken';

// nest image load
{
background(255, 255, 255);
background(255, 255, 255,0);
pushMatrix();
scale(2);
cnest(150,150);
popMatrix();
var nestImg = get();
}

var chickensLoaded = -1;
var curTypeLoadNum = 0;
var tierStats = [[],[],[],[],[],[],];

for(var q = 0; q < sTypes.length; q++){
for(var i = 0; i < types[sTypes[q]].length; i++){
    stats[sTypes[q]][types[sTypes[q]][i].name] = types[sTypes[q]][i];
    tierStats[types[sTypes[q]][i].tier-1].push(types[sTypes[q]][i]);
}
}

// bg
background(255, 255, 255);
// {
pushMatrix();
background(255, 255, 255,0);


translate(300,150);
scale(0.27);
translate(-300,-150);

translate(-400,0);


pushMatrix();
translate(-400,0);
noStroke();
fill(64, 201, 84);
rect(0,0,2200,1600);
var r = random(1000000000);
randomSeed(56);
var bgData = [
[434.1780722141266,832.9843248706311,560.0376509130001,33.07532471138984,0.05501486547291279],
[490.10761494282633,653.7263426929712,453.4984901547432,-6.2004887498915195,-1.4468573359772563],
[403.55702558439225,874.5596257504076,226.82344317436218,12.893165522255003,1.4215481923893094],
[448.96261081658304,1698.889864841476,685.9986379742622,46.00898488191888,-2.4198913611471653],
[450.486601206474,1928.6854977719486,1143.4180326759815,32.062713883351535,-0.737203917466104],
[459.34295091219246,616.8581223580986,1228.4530341625214,39.012165686581284,0.2511348398402333],
[372.07995200622827,1559.9508428480476,450.0893034040928,-12.15273518115282,3.555155045352876],
[490.1439705397934,1406.413404038176,932.0226818323135,36.11920211929828,2.558447035960853],
[447.21175126731396,1899.7187080327421,1408.7508413940668,66.49546385975555,3.8780665630474687],
[477.0461597125977,606.1840703245252,734.3023467808962,7.9610130726359785,2.4030758626759052],
[431.6838425351307,299.2205775808543,183.7351307272911,39.0836751810275,2.520020639523864],
[452.24330856930465,193.64019189961255,162.1627751737833,65.1019137003459,5.9477790063247085],
[383.8776643425226,2129.706343775615,1340.6475737690926,53.46692261984572,-1.7959812749177217],
[475.62870535161346,1720.0751231051981,785.9090216457844,27.212636631447822,3.8951006466522813],
[406.85362363420427,1292.6247210241854,774.9006681144238,60.099408437963575,-3.7950731804594398],
[494.04977182205766,1294.5570236537606,17.231041565537453,13.327876522671431,5.8567652143538],
[392.76445968821645,1661.0231176018715,1410.1511560380459,-17.84185759956017,-2.472909016534686],
[476.83196646068245,1182.4802707415074,1542.6078092306852,16.296665153931826,3.611216362565756],
[436.7190749356523,2127.9026522301137,963.5064121335745,-11.090646858792752,5.496072701178491],
[456.8241915740073,987.5957683194429,1122.2526337951422,55.40825598873198,-2.7197955353185534],
[479.49602380767465,1575.3075734246522,856.0616508126259,10.401921742595732,0.8749010730534792],
[430.3214988550171,246.96105234324932,1283.068685978651,-12.574367688503116,-0.17262361012399197],
[409.73758036457,994.0512792672962,1292.4974605441093,60.001072264276445,-2.306789946742356],
[381.4502914668992,1311.7439832538366,559.7909338772297,54.152156761847436,-3.169989007525146],
[409.98899184539914,1304.6325179748237,1411.486890912056,37.15624914970249,1.7884274357929826],
[428.88226020988077,799.2282415740192,647.545151039958,10.377411423251033,0.2524069221690297],
[466.493197738193,1821.4203151874244,762.5599257647991,59.817097096238285,-0.07186586130410433],
[430.6908799260855,2032.5103228446096,636.891496181488,37.08659918047488,0.18497982807457447],
[474.9106872212142,2170.3049591276795,362.3107813298702,2.9085252853110433,-4.84515861608088],
[394.6732954895124,195.85686116479337,137.70524822175503,54.94731868384406,0.2766457684338093],
[495.21690854337066,957.7447541989386,605.858963727951,32.7831518300809,-1.2132362658157945],
[386.1801426000893,1699.8286183923483,1528.5015225410461,19.69068147940561,-1.0340166836977005],
[441.95088360179216,178.70737817138433,51.02919861674309,-3.747602109797299,-3.511765906587243],
[393.59445656090975,1173.6901691183448,1301.8485568463802,-18.256329908035696,5.363892619498074],
[482.32532815728337,1570.4459082800895,506.2731944024563,62.89876228198409,0.8396324440836906],
[464.60974918771535,618.8364880625159,115.70531278848648,36.28132732119411,-2.4351088963449],
[489.5334646310657,1721.8707824125886,716.8218206614256,19.49883103137836,3.9698194628581405],
[447.68055128492415,307.09205106832087,292.95733384788036,-15.914181305561215,0.4804927483201027],
[425.4722413951531,592.0746247749776,505.02513758838177,46.66417677421123,-1.2192453918978572],
[430.4828092157841,1090.5786585062742,406.9004539400339,34.47370485868305,5.258035569451749],
[437.4578955639154,2116.440908657387,1091.8600726872683,34.58114400971681,4.842640498653054],
[436.29196897987276,817.3367100767791,779.9153197556734,8.804263377096504,5.367083361372352],
[476.8126184018329,2108.5819038096815,1361.0990606248379,20.813036942854524,4.929426592774689],
[486.4349070591852,1967.8701385390013,1183.3548247814178,1.31158166565001,-2.391227244399488],
[435.3391951909289,1277.5633402634412,518.6762355268002,28.3209362719208,5.99529333319515],
[448.7029474750161,567.7885461132973,7.8937675803899765,-9.727710532024503,3.0055145444348454],
[377.80953302048147,1401.264279941097,1271.7160407453775,11.553022942971438,4.771681225858629],
[478.14599055051804,782.2985051665455,1189.8294944316149,58.96372197661549,4.110380774363875],
[475.70968404971063,2061.4948079921305,1559.5569398254156,44.79862473672256,-4.803113383240998],
[456.38618347235024,760.5327385477722,179.90949749946594,53.01597432233393,3.810076031833887],
[413.0798983993009,484.1219489928335,176.13835521042347,-14.246631069108844,-3.9507550317794085],
[428.5081388428807,898.4413930680603,520.0470082461834,30.149403710383922,-0.4263028036803007],
[443.3751838821918,233.29782192595303,428.9952952414751,-4.6322605246677995,0.8401279654353857],
[395.2001032028347,121.42975302413106,758.0872774124146,60.91908038593829,3.9228416169062257],
[372.15315499994904,1430.2421583794057,945.299618318677,67.09407235262915,-4.244468315504491],
[393.55591967422515,1841.2303785793483,1576.3040110468864,55.488107739947736,5.81821876950562],
[433.82088806666434,1378.951994329691,1449.9939132481813,45.59994710609317,2.0601481115445495],
[470.7912694653496,1399.3207221385092,758.8069874793291,65.11459836969152,0.22820264846086502],
[423.16441185679287,1506.959213502705,1251.6409363597631,38.89065176947042,-3.8372666416689754],
[388.68182242196053,1142.4560042098165,981.6626183688641,-0.8757980493828654,1.7686521401628852],
[398.9858812112361,986.6262872703373,152.4651352316141,44.178654921706766,1.3951484160497785],
[496.38689507264644,274.8603668063879,1365.0442995131016,25.624979049898684,-2.3571161283180118],
[445.33172002155334,897.8617170825601,1291.5199916809797,-6.395663041621447,0.728718220256269],
[426.687175296247,1573.935871431604,1192.44983792305,1.1646112171001732,5.007139720954001],
[420.6570011014119,1510.014856979251,167.78286434710026,5.370915012899786,2.7275015488266945],
[439.379534448497,44.72872344776988,1102.6220232248306,60.75842740247026,2.818375678732991],
[419.3850118787959,1897.8178274817765,274.91438277065754,30.210816469043493,-3.8913453901186585],];
for(var i = 0; i < bgData.length; i++){
fill(20+bgData[i][3], 210+bgData[i][4], 84);
ellipse(bgData[i][1],bgData[i][2],bgData[i][0],bgData[i][0]);
}
// for(var i = 0; i < bgData.length; i++){
// println('['+bgData[i]+'],');
// }
ellipse(392,980,400,400);
ellipse(1771,760,400,400);
filter(BLUR,1.8);
randomSeed(r);


popMatrix();


popMatrix();
var bg1 = get();
// }

// fence
background(255, 255, 255);
function fence(){
background(255, 255, 255,0);
pushMatrix();
scale(1200/1400);
var a = 90;
var a2 = 1200%a;
var a3 = 700%a;
for(var q = 0; q < 2; q++){
pushMatrix();
translate(-10,q*700);
stroke(0,0,0);
strokeWeight(5);
noFill();
for(var i = (a+a2)/2-a; i < 1200; i+=a){
arc(i+(a/2)+10,310,a-20,30,0,180);
}
stroke(0,0,0);
fill(181, 125, 4);
strokeWeight(5);
for(var i = (a+a2)/2; i < 1200; i+=a){
rect(i,300,20,60,5);
}

popMatrix();
}
stroke(0,0,0);
strokeWeight(5);
rect(-50,280,40,80,5);
rect(1210,280,40,80,5);

stroke(0,0,0);
fill(181, 125, 4);
strokeWeight(5);
for(var q = 0; q < 2; q++){
pushMatrix();
translate(q*1260,0);
for(var i = (a+a3)/2; i < 700; i+=a){
line(-30,300+i,-30,330+i-a);
rect(-40,300+i,20,60,5);
}
line(-30,300+i,-30,328+i-a);
popMatrix();
}
stroke(0,0,0);
strokeWeight(5);
rect(-50,980,40,80,5);
rect(1210,980,40,80,5);

popMatrix();
}
var a = 1300*12/14;
pushMatrix();
translate(a/13,0);
fence();
var bFence1 = get();
popMatrix();
pushMatrix();
translate(-a/2.17,0);
fence();
var bFence2 = get();
popMatrix();
pushMatrix();
translate(-a/2.17,-600);
fence();
var bFence3 = get();
popMatrix();
pushMatrix();
translate(a/13,-600);
fence();
var bFence4 = get();
popMatrix();


function getImg(e,t){

return stats[t][e].img;

}

var complexGrass = true;
function grassBlade(x,y,l,w,c,t,cattail){
var pSeg = [[x,y]];
stroke(2,112,0);
strokeWeight(2);
 for(var d = 0; d < l; d++){
    if(complexGrass === true){
    stroke(c);
    strokeWeight(t);
    }
    if(cattail){
    if(cattail[0] === true){
    if(d === l-1){
    stroke(cattail[1]);
    strokeWeight(cattail[2]);
    }
    }
    }
    var yd = sqrt(pow(-3,2)+pow(w+(d)*(w/2),2));
    var gInvert = 0;

    pSeg.push([(pSeg[pSeg.length-1][0]+w)+(d)*(w/2),(pSeg[pSeg.length-1][1]-9+yd)]);



    line(pSeg[pSeg.length-2][0],pSeg[pSeg.length-2][1],pSeg[pSeg.length-1][0],pSeg[pSeg.length-1][1]);

 }

}
var grassLoads = [[],[]];

function grassLoad1OLD(frame){
    background(255,255,255);
    background(255,255,255,0);
    var x = 300;
    var y = 300;
    var wind = sin((frame*(360/numGrassFrames))*1);
    var wind2 = sin((frame*(360/numGrassFrames)+30)*1);
    var wind3 = sin((frame*(360/numGrassFrames)+50)*1);
    grassBlade(x+20,y+30,4,wind2*1.5,color(6, 128, 2),2);
    grassBlade(x+24,y+15,3,wind2*1.5,color(2, 112, 0),2);
    grassBlade(x+11,y+32,2,wind*1.5,color(2, 112, 0),2.5);
    grassBlade(x+30,y+28,5,wind3*1.5,color(2, 112, 0),2,[true,color(255, 255, 255),4.5]);
    grassBlade(x+10,y+20,5,wind2*1.5,color(2, 112, 0),2.5,[true,color(255, 255, 255),5]);
    grassLoads[0][frame] = get();
}
function grassLoad2OLD(frame){
    background(255,255,255);
    background(255,255,255,0);
    var x = 300;
    var y = 300;
    var wind = sin((frame*(360/numGrassFrames))*1);
    var wind2 = sin((frame*(360/numGrassFrames)+70)*1);
    var wind3 = sin((frame*(360/numGrassFrames)+50)*1);
    grassBlade(x+23,y+19,3,wind3*1.5,color(2, 112, 0),2);
    grassBlade(x+31,y+35,4,wind2*1.5,color(2, 112, 0),2.5);
    grassBlade(x+16,y+32,2,wind*1.5,color(8, 133, 4),2);
    grassBlade(x+6,y+25,1,wind2*1.5,color(2, 112, 0),1.5);
    grassBlade(x+35,y+13,2,wind3*1.5,color(8, 133, 4),2);
    grassBlade(x+11,y+11,3,wind*1.5,color(7, 128, 3),2.5);
    grassLoads[1][frame] = get();
}
function grassLoad1(frame){
    background(255,255,255);
    background(255,255,255,0);
    var x = 300;
    var y = 300;
    pushMatrix();
    translate(x+15,y+15);
    scale(0.5);
   stroke(7, 133, 3);
   strokeWeight(5);
   noFill();
   for(var i = 0; i < 10; i++){
      pushMatrix();
      translate(cos(i*266)*30,sin(i*58)*30);
    beginShape();
    vertex(sin((frame*(360/numGrassFrames))+i*10)*30,-114);
    curveVertex(sin((frame*(360/numGrassFrames))+i*10)*5,-39+cos((frame*(360/numGrassFrames))+i*10)*5);
    vertex(0,0);
    vertex(sin((frame*(360/numGrassFrames))+i*10)*30,40);
    endShape();
    popMatrix();
   }

popMatrix();
    grassLoads[0][frame] = get();
}
function grassLoad2(frame){
    background(255,255,255);
    background(255,255,255,0);
    var x = 300;
    var y = 300;
    pushMatrix();
    translate(x+15,y+15);
    scale(0.5);
   stroke(38, 153, 34);
   strokeWeight(5);
   noFill();
   for(var i = 0; i < 10; i++){
      pushMatrix();
      translate(cos(i*133)*30,sin(i*31)*30);
    beginShape();
    vertex(sin((frame*(360/numGrassFrames))+i*10)*30,-114);
    curveVertex(sin((frame*(360/numGrassFrames))+i*10)*5,-39+cos((frame*(360/numGrassFrames))+i*10)*5);
    vertex(0,0);
    vertex(sin((frame*(360/numGrassFrames))+i*10)*30,40);
    endShape();
    popMatrix();
   }

popMatrix();
    grassLoads[1][frame] = get();
}
function drawAmbience(type, x, y) {
    if(type === 'stain1') {
        noStroke();

    }
    if(type === 'grass1' && !delag && !trueDelag) {
    var num = floor(frameCount/(360/numGrassFrames))-floor(floor(frameCount/(360/numGrassFrames))/numGrassFrames)*numGrassFrames;
    if(grassLoads[0][num]){
        image(grassLoads[0][num],x-300,y-300);
    }else{

    }
    }
    if(type === 'grass2' && !delag && !trueDelag) {
    var num = floor(frameCount/(360/numGrassFrames))-floor(floor(frameCount/(360/numGrassFrames))/numGrassFrames)*numGrassFrames;
    if(grassLoads[1][num]){
        image(grassLoads[1][num],x-300,y-300);
    }else{

    }
    }

}
function mGrass(x,y,s,t){
    pushMatrix();
    drawAmbience(t,x,y);
    popMatrix();
}
function nest(x,y){
pushMatrix();
translate(x-150,y-150);
scale(1/2);
image(nestImg,0,0);
popMatrix();
}

var m = {
hold:false,
downPos:{x:0,y:0},
origin:false,
holdTimer:0,
};
function didMouseMove(){
if(msX === m.downPos.x && msY === m.downPos.y){
    return false;
}
return true;
}
function didMouseCurMove(){
if(msX === pmsX && msY === pmsY){
    return false;
}
return true;
}

var chickens = [];
var contraptions = [];
var foods = [];
var myCoops = [];
var myContraptions = [];
var projs = [];
var coops = [];
var todo = [];
var effects = [];
var merging = true;
var action;
var lastBought = false;
var stopHold = false;
var introTurn = false;
var infiniteRun = false;
var introAnim = 0;
var tNameAnim = 0;
var fightStage = 'start';
var teams = [false,false];
var teamTotals = [0,0];
// wins losses turn
var record = [0,0,11];
var battleResults = {
win:false,
changedRecord:false,
};
var gold = 10;
var power = 0;
var neededPower = 15;
var powerAnim = 0;
var mergeAnim = [0,0];
var coinAnim = {r:0,s:1,rs:0};
var shopPage = 0;
var shopUi = {scroll:0,};
var tier = 4;
var promptTarg = false;
var shop = [
    {
        data:[],
        num:3+round(tier/1.5),
        frozens:[],
        types:['chicken']
    },
    {
        data:[],
        num:3,
        frozens:[],
        types:['contraption','food']
    },
    {
        data:[],
        num:5,
        frozens:[],
        types:['chicken','food','contraption']
    },
    ];
var attackPaths = [];
var hats = ["🎩","🎓","⛑","👒","🍩","🥪","🪖","👑","🧢",];
var begTexts = ["BUK BUK BUUUUK","GOBBLE GOBBLE","GOBBLE BUK BUK","🥺🥺🥺🥺"];
var gold = 10;
function calcThrow(startX, startY, targetX, targetY, gravity, initialVelocity) {
    //angleMode(degrees);
    var g = gravity || 9.81; // gravitational varant, default value is for Earth (m/s²)
    var v0 = initialVelocity;

    var deltaX = targetX - startX;
    var deltaY = targetY - startY;
//println(gravity);
    var v0Squared = v0 * v0;
    var rootTerm = v0Squared * v0Squared - g * (g * deltaX * deltaX + 2 * deltaY * v0Squared);
    if (rootTerm < 0) {
        return NaN; // no solution, cannot reach the target
    }

    var angle1 = Math.atan((v0Squared + Math.sqrt(rootTerm)) / (g * deltaX));
    var angle2 = Math.atan((v0Squared - Math.sqrt(rootTerm)) / (g * deltaX));

    var validAngle = angle1 >= 0 ? angle1 : angle2;
    return validAngle;
}
function spend(n){
gold -= n;
coinAnim = {r:random(-30,30),s:1.4,rs:0};
}
function killChicken(e){

    if(e.origin){

    e.origin[0].c[e.origin[1]] = false;

    }
    e.killed = true;
for(var i = chickens.length-1; i > -1; i--){
    if(chickens[i] === e){
        chickens.splice(i,1);
    }
}
}
function killFood(e){
    e.kill();
}
function killContraption(e){
for(var i = myContraptions.length-1; i > -1; i--){
    if(myContraptions[i] === e){
        myContraptions.splice(i,1);
    }
}
for(var i = contraptions.length-1; i > -1; i--){
    if(contraptions[i] === e){
        contraptions.splice(i,1);
    }
}
}
function canSwap(a,b){
    return true;
}
function chicken(x,y,t){
this.x = x;
this.y = y;
this.px = x;
this.py = y;
this.dir = 1;
this.lvl = 1;
this.IDENTIFIER = 'chicken';
this.shakeIntensity = 1.1;
this.shakeRad = 5;
this.triggers = 0;
this.xp = 0;
this.stats = {
size:1,
health:1,
attack:1,
name:"Boring chicken",
};
if(t){
this.stats = t;
this.health = this.stats.health;
this.attack = this.stats.attack;
this.name = this.stats.name;
}else{
this.health = 1;
this.attack = 1;
}
this.price = 3-t.discount;
this.sellValue = 1;
this.tempStatAttack = 0;
this.tempStatHealth = 0;
if(this.stats.price){
this.price = this.stats.price;
}
this.dHealth = this.health;
this.dAttack = this.attack;
// this.pAttack = this.attack;
// this.pHealth = this.health;
// this.pXp = this.xp;

this.hat = hats[floor(random(0,hats.length))];
this.begText = begTexts[floor(random(0,begTexts.length))];
this.id = random(0,1000000000);
chickens.push(this);
}

function doAbilityTurnSingle(e,tc){
if(tc.stats[e]){
    gFight.timer = 0;
    todo.push([tc,e]);
}
}
function doAbilitiesTurn(e, exclude){
if(!exclude){
    var exclude = function(){
        return true;
    };
}
var f = function(tc){
if(tc.stats[e]){
    gFight.timer = 0;
    todo.push([tc,e]);
}
};
//println(e);
    for(var q = 0; q < myCoops.length; q++){
        var theCoop = myCoops[q];
        for(var q2 = 0; q2 < theCoop.c.length; q2++){
            if(theCoop.c[q2] && exclude(theCoop.c[q2])){
            f(theCoop.c[q2]);
            }
        }

    }
    for(var q = 0; q < myContraptions.length; q++){
        if(exclude(myContraptions[q])){
        f(myContraptions[q]);
        }
    }
}
function doesOwn(e){
switch(e.IDENTIFIER){
    case 'chicken':
    if(e.owned === true){
        return true;
    }
    break;
    case 'contraption':
    if(myContraptions.indexOf(e) >= 0){
        return true;
    }
    break;
}
return false;
}
function contraption(x,y,t){
this.x = x;
this.y = y;
this.px = x;
this.py = y;
this.dir = 1;
this.xp = 1;
this.lvl = 1;
this.IDENTIFIER = 'contraption';
this.deathLocationText = 'Tow Mater\'s';
this.shakeIntensity = 1.1;
this.shakeRad = 5;
this.nScale = 1;
this.triggers = 0;
this.stats = {
size:1,
health:1,
attack:1,
name:"Boring contraption",
};
if(t){
this.stats = t;
this.health = this.stats.health;
this.attack = this.stats.attack;
this.radius = this.stats.radius;
this.name = this.stats.name;
this.size = this.stats.size;
}else{
this.health = 1;
this.attack = 1;
this.radius = 30;
}
this.price = 3-t.discount;
this.sellValue = 1;
if(this.stats.price){
this.price = this.stats.price;
}
this.dHealth = this.health;
this.dAttack = this.attack;

this.hat = hats[floor(random(0,hats.length))];

this.id = random(0,1000000000);
contraptions.push(this);
}
function foodItem(x,y,t){
//println(t);
this.x = x;
this.y = y;
this.px = x;
this.py = y;
this.dir = 1;
this.lvl = 1;
this.IDENTIFIER = 'food';
this.deathLocationText = 'how are you even gonna sell this';
this.shakeIntensity = 1.1;
this.shakeRad = 5;
this.nScale = 1;
this.triggers = 0;
this.stats = {
size:1,
health:1,
attack:1,
name:"Boring food",
};
if(t){
this.stats = t;
this.health = this.stats.health;
this.attack = this.stats.attack;
this.radius = this.stats.radius;
this.name = this.stats.name;
this.size = this.stats.size;
}else{
this.health = 1;
this.attack = 1;
this.radius = 30;
}
this.price = 3-t.discount;
this.sellValue = 1;
if(this.stats.price){
this.price = this.stats.price;
}
this.dHealth = this.health;
this.dAttack = this.attack;

this.hat = hats[floor(random(0,hats.length))];

this.id = random(0,1000000000);
foods.push(this);
}
function coop(x,y,c){
this.x = x;
this.y = y;
this.dir = 1;
this.IDENTIFIER = 'coop';
this.stats = {
size:1,
};
if(c){
this.c = c;
}else{
this.c = [];
}
for(var i = 0; i < 6; i++){
if(!this.c[i]){
    this.c[i] = false;
}
}
coops.push(this);
}
function makeThing(x,y,t,type){

var ret;
switch(type){
case 'chicken':
ret = new chicken(x,y,t);
break;
case 'contraption':
ret = new contraption(x,y,t);
break;
case 'food':
ret = new foodItem(x,y,t);
}
return ret;
}
function getRand(t,type,x,y){
var options = [];
for(var i = 0; i < types[type].length; i++){
    if(types[type][i].tier <= t){
        options.push(i);
    }
}
var num = floor(random(0,options.length));
var num2 = options[num];
var newChick = makeThing(x,y,types[type][num2],type);
//chickens.push(newChick);
return newChick;
}
function getRandExact(t,type,x,y){

var options = [];
for(var i = 0; i < types[type].length; i++){
    if(types[type][i].tier === t){
        options.push(i);
    }
}
if(options.length === 0){
    options.push(0);
}
var num = floor(random(0,options.length));
var num2 = options[num];
var newChick = makeThing(x,y,types[type][num2],type);
//chickens.push(newChick);
return newChick;
}
function getNameExact(n,type,x,y){

var options = [];
for(var i = 0; i < types[type].length; i++){
    if(types[type][i].name === n){
        options.push(i);
    }
}
if(options.length === 0){
    options.push(0);
}
var num = floor(random(0,options.length));
var num2 = options[num];
var newChick = makeThing(x,y,types[type][num2],type);
//chickens.push(newChick);
return newChick;
}
function roll(n,unfreeze){
rollCount = 0;
var frozen = [];
for(var i = 0; i < shop[n].num; i++){
if(shop[n].data[i]){
if(!shop[n].frozens[i] || unfreeze){
if(shop[n].data[i].IDENTIFIER === 'chicken'){
killChicken(shop[n].data[i]);
}
if(shop[n].data[i].IDENTIFIER === 'contraption'){
killContraption(shop[n].data[i]);
}
if(shop[n].data[i].IDENTIFIER === 'food'){
killFood(shop[n].data[i]);
}
}else{
frozen.push(shop[n].data[i]);
}
}
}
shop[n].data = frozen;
shop[n].frozens = [];
for(var i = 0; i < frozen.length; i++){
    shop[n].frozens.push(true);
}
var a = shopPage*600-shopUi.scroll;
var x;
var y;
for(var i = shop[n].data.length; i < shop[n].num; i++){
x = 10;
y = 590;
// x = 50+i*70+a;
// y = 700;
if(delag2){
x = 50+i*70+a;
y = 550;
}
shop[n].data.push(getRand(tier,chooseFrom(shop[n].types),x,y));
shop[n].frozens.push(false);
}
if(tutorial.on === true && tutorial.num === 10 && (n === 1||n===2)){
shop[n].data[0] = getNameExact('Apple','food',x,y);
}
if(tutorial.on === true && tutorial.num === 15 && (n === 1||n===2)){
shop[n].data[0] = getNameExact('Dart launcher','contraption',x,y);
}
}
function merge(target,subj){
target.temporaryScale = 1.4;
var num = target.xp+1;
if(subj.xp + 1 < num){
num = subj.xp + 1;
}

var a = getLevel(target.xp);
var a2 = getLevel(subj.xp);
if (a2 < a){
    a = a2;
}


target.xp += subj.xp + 1;

power += 1;

var splatter = new effect(target.x,target.y,'xp splatter',1.4,200,{amount:subj.xp + 1});

var mostA = target.attack - target.tempStatAttack;
var mostH = target.health - target.tempStatHealth;
var tempStats = [target.tempStatAttack+subj.tempStatAttack,target.tempStatHealth+subj.tempStatHealth];
if(subj.attack - subj.tempStatAttack > mostA){
mostA = subj.attack - subj.tempStatAttack;
}
if(subj.health - subj.tempStatHealth > mostH){
mostH = subj.health - subj.tempStatHealth;
}
if(subj.triggers > target.triggers){
target.triggers = subj.triggers;
}
target.attack = mostA + 1 +tempStats[0];
target.health = mostH + 1 +tempStats[1];

target.tempStatAttack = tempStats[0];
target.tempStatHealth = tempStats[1];

updateStats(target);

killChicken(subj);
}
function getHeightOfText(t,w){
var t = textWidth(t);
var sd = ceil(t/w);
// the text stuff is weird :p
//return (textDescent()*5)*sd;
return 40;
}
function projectile(x,y,vx,vy,data){
this.x = x;
this.y = y;
this.sx = x;
this.sy = y;
this.vx = vx;
this.vy = vy;
this.life = 0;
this.data = data;
this.id = random(0,1000000000);
projs.push(this);
}
function effect(x,y,t,s,l,data){
this.x = x;
this.y = y;
this.type = t;
this.scale = s;
this.maxL = l;
this.l = l;
if(data){
this.data = data;
}else{
this.data = {};
}
this.id = random(0,1000000000);
effects.push(this);
}
function arcFrom(x,y,x2,y2,cx,cy,t){
if(delag3){
return 0;
}else{
var d = dist(x,y,x2,y2);
var d2 = dist(x,y,cx,cy);
var cur = d2/d;

return sin(cur*180);
}
}
projectile.prototype.draw = function() {
    pushMatrix();
        translate(this.x,this.y);
    switch(this.data.type){
        case 'egg':
        var a = 0;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        //println(a);
        translate(0,-a*(100+cos(this.id)*20));
        rotate((frameCount*8)*sin(this.id));
        egg(0,0,0.16);
        break;
        case 'special':
        var a = 0;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        //println(a);
        translate(0,-a*(100+cos(this.id)*20));
        rotate((frameCount*8)*sin(this.id));
        stroke(0, 0, 0);
        fill(30, 201, 0);
        noColoredEgg(0,0,0.16);
        break;
        case 'dart':
        strokeWeight(3);
        stroke(0,0,0);
        var a = atan2(this.vy,this.vx);
        line(0,0,0+cos(a)*8,0+sin(a)*8);
        strokeWeight(3);
        stroke(117, 66, 4);
        for(var i = -30; i < 30; i+=15){
        line(0,0,0-cos(a+i)*8,0-sin(a+i)*8);
        }
        break;
        case 'bomb':
        var a = 0;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        //println(a);
        translate(0,-a*(150+cos(this.id)*50));
        rotate(this.id+frameCount*8);
        stroke(0,0,0);
        strokeWeight(4);
        fill(115, 115, 115);
        ellipse(0,0,20,20);
        line(0,-10,0,-15);
        pushMatrix();
translate(0,-15);
scale(0.2);
rotate(frameCount*4);
strokeWeight(20);
stroke(255, 77, 0);
fill(255, 166, 0);
beginShape();
var n = 5;
for(var i = 0; i < n; i++){
var a = (360/n)*i;
vertex(0+cos(a)*30,0+sin(a)*30);
var a3 = (360/n)*(i+0.5+cos((frameCount*15+a*123))*0.2);
var a2 = 50+cos((frameCount*15+a))*5;
vertex(0+cos(a3)*a2,0+sin(a3)*a2);
}
endShape(CLOSE);
popMatrix();
        break;
        case 'fireball':
        {
        pushMatrix();
        var rSpeed = 6;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        var h = 50;
        translate(0,-a*(h+cos(this.id)*20));
        var a2 = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x+this.vx,this.y+this.vy,this);
        var angle = atan2((this.y+this.vy-a2*(h+cos(this.id)*20)) - (this.y-a*(h+cos(this.id)*20)), (this.x+this.vx)-this.x);
        rotate(angle);
        scale(0.15);

        pushMatrix();
rotate(21);
noStroke();
strokeWeight(38);
stroke(0,0,0);
pushMatrix();
scale(1+(cos(frameCount*23)*0.01));
rotate(cos(frameCount*10)*6);
fill(0,0,0);
ellipse(0,0,200,200);
beginShape();
vertex(0,-100);
vertex(-100,-60);
vertex(-200,-16);
vertex(-128,-30);
vertex(-249,54);
vertex(-131,35);
vertex(-259,148);
vertex(-75,71);
vertex(-134,159);
vertex(51,64);
endShape(CLOSE);
popMatrix();
noStroke();
for(var i = 0; i < 3; i++){
pushMatrix();
scale(1-i*0.28+(cos(frameCount*23+i*60)*0.01));
rotate(cos(frameCount*10+i*60)*6);
fill(255, 98+i*30, 0);
ellipse(0,0,200,200);
beginShape();
vertex(0,-100);
vertex(-100,-60);
vertex(-200,-16);
vertex(-128,-30);
vertex(-249,54);
vertex(-131,35);
vertex(-259,148);
vertex(-75,71);
vertex(-134,159);
vertex(51,64);
endShape(CLOSE);
popMatrix();
}
popMatrix();

        popMatrix();
        }
        break;
        case 'iceball':
        {
        pushMatrix();
        var rSpeed = 6;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        var h = 50;
        translate(0,-a*(h+cos(this.id)*20));
        var a2 = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x+this.vx,this.y+this.vy,this);
        var angle = atan2((this.y+this.vy-a2*(h+cos(this.id)*20)) - (this.y-a*(h+cos(this.id)*20)), (this.x+this.vx)-this.x);
        rotate(angle);
        scale(0.15);

        pushMatrix();
rotate(21);
noStroke();

for(var i = 0; i < 3; i++){
pushMatrix();
scale(1-i*0.28+(cos(frameCount*23+i*60)*0.01));
rotate(cos(frameCount*10+i*60)*6);
fill(0, 158+i*40, 255);
ellipse(0,0,200,200);
beginShape();
vertex(0,-100);
vertex(-100,-60);
vertex(-200,-16);
vertex(-128,-30);
vertex(-249,54);
vertex(-131,35);
vertex(-259,148);
vertex(-75,71);
vertex(-134,159);
vertex(51,64);
endShape(CLOSE);
popMatrix();
}
popMatrix();

        popMatrix();
        }
        break;
        case 'missile':
        {
        pushMatrix();
        var rSpeed = 6;
        if(this.data.target){
        a = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x,this.y,this);
        }
        var h = 400;
        translate(0,-a*(h+cos(this.id)*20));
        var a2 = arcFrom(this.sx,this.sy,this.data.target.x,this.data.target.y,this.x+this.vx,this.y+this.vy,this);
        var angle = atan2((this.y+this.vy-a2*(h+cos(this.id)*20)) - (this.y-a*(h+cos(this.id)*20)), (this.x+this.vx)-this.x);
        rotate(angle);
        scale(0.3);
stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(frameCount*rSpeed+n)*30;
if(cos(frameCount*rSpeed+n) <= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}

noStroke();
fill(255, 149, 0);
beginShape();
vertex(-405,180+sin(frameCount*5)*40);
curveVertex(-190,0);
vertex(-290+cos(frameCount*10)*10,0);
endShape(CLOSE);
beginShape();
vertex(-405,-180-sin(frameCount*5)*40);
curveVertex(-190,0);
vertex(-290+cos(frameCount*10)*10,0);
endShape(CLOSE);
fill(255, 217, 0);
beginShape();
vertex(-405,60+sin(frameCount*5+40)*20);
curveVertex(-190,0);
vertex(-260+cos(frameCount*10+40)*10,0);
endShape(CLOSE);
beginShape();
vertex(-405,-60-sin(frameCount*5+40)*20);
curveVertex(-190,0);
vertex(-260+cos(frameCount*10+40)*10,0);
endShape(CLOSE);

stroke(0,0,0);
fill(235, 235, 235);
strokeWeight(10);
rect(-190,-30,306,60,5);
noStroke();
var h = 30;
for(var i = 0; i < 6; i++){
var n = i*(360/6);
var r = sin(frameCount*rSpeed+n)*30;
if(cos(frameCount*rSpeed+n+h) >= 0){
if(i/2 === round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(14+30,r,25,cos(frameCount*rSpeed+n+h)*h,5);
if(i/2 !== round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(25,r,25,cos(frameCount*rSpeed+n+h)*h,5);
}
}




stroke(0,0,0);
noFill();
strokeWeight(10);
rect(-190,-30,306,60,5);
fill(255, 0, 21);
triangle(200,0,100,-50,100,50);
fill(212, 212, 212,120);
noStroke();
pushMatrix();
translate(135,-19);
rotate(25);
ellipse(0,0,57,9);
popMatrix();

stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(frameCount*rSpeed+n)*30;
if(abs(r) < 0.0001){
r = 0.0001;
}
if(cos(frameCount*rSpeed+n) >= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}
//triangle(-170, 56, -170, 25,-107, 25);
//noStroke();
strokeWeight(7);
rect(-194,-35,10,70,5);
rect(-22,-35,10,70,5);
popMatrix();
        }
        break;
        case 'food':
        rotate((frameCount*8)*sin(this.id));
        textAlign(CENTER,BASELINE);
        textSize(20);
        text('🍔',0,0);
        break;
        case 'xp':
        rotate((frameCount*8)*sin(this.id));
        scale(0.7);
        pushMatrix();
    strokeWeight(4);
    stroke(0, 0, 0);
    fill(227, 18, 224);
    rect(-15,-25,30,50,10);
    fill(19, 89, 11);
    ellipse(0.5,-20,30,10);
    fill(0,0,0);
    noStroke();
    ellipse(0,-23,15,10);
    stroke(0,0,0);
    strokeWeight(3);
    fill(255, 234, 0);
    pushMatrix();
    translate(0,2);
    beginShape();
    vertex(0,-10);
    vertex(-7,-2);
    vertex(-1,7);
    vertex(0,15);
    vertex(7,5);
    vertex(2,-2);
    endShape(CLOSE);
    popMatrix();
    popMatrix();
        break;
        default:
        fill(255, 0, 0);
        noStroke();
        ellipse(0,0,30,30);
        break;
    }
    popMatrix();

};
effect.prototype.draw = function() {
    pushMatrix();
        translate(this.x,this.y);
        scale(this.scale);
    switch(this.type){
        case 'ghost':
        {
        var zeroToOne = ((this.maxL-this.l)/(this.maxL));
        var num = 10;
        translate(0,-num/(1.01-zeroToOne)+num);
        pushMatrix();
        rotate(-num/(1.01-zeroToOne)+num);
        pushMatrix();
    scale(1/2);
    translate(-300,-300);
    if(this.data && this.data.type){
    image(getImg(this.data.type,'chicken'),0,0);
    // if(stats.chicken[this.data.type].animImg){
    // stats.chicken[this.data.type].animImg();
    // }
    }
    popMatrix();
    popMatrix();
    noStroke();
    fill(255, 255, 255,150);
    rect(-30,-30,60,80,5);
    noFill();
    strokeWeight(10);
    stroke(255, 191, 0);
    ellipse(0,-25,45,15);

        }
        break;
        case 'egg splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(255, 255, 255,255*oneToZero);
        stroke(0,0,0,255*oneToZero);
        strokeWeight(3*(1/0.1));
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        noStroke();
        fill(255, 225, 0,255*oneToZero);
        ellipse(0,0,5,5);
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'special splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(0, 212, 25,255*oneToZero);
        stroke(0,0,0,255*oneToZero);
        strokeWeight(3*(1/0.1));
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        noStroke();
        fill(255, 225, 0,255*oneToZero);
        ellipse(0,0,5,5);
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = -this.data.differenceHealth;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'xp splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(252, 0, 218,255*oneToZero);
        noStroke();
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        fill(54, 0, 48,255*oneToZero);
        textSize(5);
        textAlign(CENTER,CENTER);
        pushMatrix();
        rotate((cos(this.id)*70)*oneToZero);
        text('+'+this.data.amount+' XP',0,0);
        popMatrix();
        }
        break;
        case 'missile splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));

        pushMatrix();
        scale(2);
        rotate(this.id);
        scale(0.1);
        fill(250, 83, 0,255*oneToZero);
        noStroke();
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        pushMatrix();
        //translate(-this.x,-this.y);
        //translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'bomb splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(250, 83, 0,255*oneToZero);
        noStroke();
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'fireball splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(250, 83, 0,255*oneToZero);
        noStroke();
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
         case 'iceball splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*5;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        scale(abs(sin(this.id))+1,abs(sin(this.id*2))+1);
        //scale(1-(this.maxL-this.l)/(this.maxL*3));
        pushMatrix();
        rotate(this.id);
        scale(0.1);
        fill(0, 192, 250,255*oneToZero);
        noStroke();
        beginShape();
    curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99); curveVertex(-1,-62); curveVertex(114,-110); curveVertex(84,-12); curveVertex(128,98); curveVertex(9,47); curveVertex(-86,107); curveVertex(-83,1); curveVertex(-132,-99);
    endShape();
        popMatrix();
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'food splatter':
        {
        pushMatrix();
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        scale((oneToZero)*2.4);
        translate(-this.x,-this.y);
        var zeroToOne = 1-oneToZero;
        var num = 0;
        //println(this.data.differenceHealth);
        while(this.data.hit&&(this.data.differenceAttack > num ||this.data.differenceHealth > num)){
        if(this.data.differenceAttack > num){
        attack(this.data.hit.x+cos(this.id-(num+1)*123)*zeroToOne*50,this.data.hit.y+sin(this.id-(num+1)*123)*zeroToOne*50,0.1,oneToZero*255);
        }
        if(this.data.differenceHealth > num){
        heart(this.data.hit.x+cos(this.id+num*1234)*zeroToOne*50,this.data.hit.y+sin(this.id+num*1234)*zeroToOne*50,0.1,oneToZero*255);

        }
        num++;
        }
        popMatrix();
        }
        break;
        case 'dart splatter':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        pushMatrix();
        translate(-this.x,-this.y);
        translate(this.data.hit.x,this.data.hit.y);
        var num2 = this.data.damage;
        fill(255, 0, 0, 255*oneToZero);
        textSize(25);
        textAlign(CENTER,CENTER);
        text(num2,0,0);
        popMatrix();
        }
        break;
        case 'deadChicken':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*7;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        rotate(sin(this.id)*10);
        pushMatrix();
        rotate(-12);
        strokeWeight(3);
        stroke(232, 232, 232,255*oneToZero);
        line(-5,-20,-5,-35);
        noStroke();
        fill(232, 232, 232,255*oneToZero);
        ellipse(-5,-35,5,3);
        fill(135, 66, 16,255*oneToZero);
        ellipse(-5,-20,10,20);
        popMatrix();
        pushMatrix();
        rotate(12);
        strokeWeight(3);
        stroke(232, 232, 232,255*oneToZero);
        line(-5,-20,-5,-35);
        noStroke();
        fill(232, 232, 232,255*oneToZero);
        ellipse(-5,-35,5,3);
        fill(135, 66, 16,255*oneToZero);
        ellipse(-5,-20,10,20);
        popMatrix();
        pushMatrix();
        rotate(-5);
        strokeWeight(3);
        stroke(232, 232, 232,255*oneToZero);
        line(13,-20,13,-35);
        noStroke();
        fill(232, 232, 232,255*oneToZero);
        ellipse(13,-35,5,3);
        fill(135, 66, 16,255*oneToZero);
        ellipse(13,-20,10,20);
        popMatrix();
        strokeWeight(5);
        stroke(0, 0, 0,255*oneToZero);
        fill(224, 224, 224,255*oneToZero);
        rect(-18,-20,36,40,5);
        noStroke();
        fill(255, 71, 71,255*oneToZero);
        rect(-13,-20,8,20);
        rect(5,-20,8,20);
        stroke(0, 0, 0,255*oneToZero);
        noFill();
        rect(-18,-20,36,40,5);
        fill(0,0,0,255*oneToZero);
        textSize(10);
        textAlign(CENTER,BASELINE);
        text('KFC',0,10);
        textSize(15);
        //text('㋛',0,-4);

        }
        break;
        case 'deadContraption':
        {
        var oneToZero = 1-((this.maxL-this.l)/(this.maxL));
        if(!oneToZero){
        oneToZero = 1;
        }
        var num = ((this.maxL-this.l)/(this.maxL))*7;
        if(num <= 1.5){
        scale(1+4*((-1/5)*pow((num-1.4),5)-pow((num-1.4),4)-pow((num-1.4),3)));
        }
        rotate(sin(this.id)*10);
        strokeWeight(3);
        fill(0, 0, 0,255*oneToZero);
        // textSize(50);
        // textAlign(CENTER,CENTER);
        // text("⚙",0,0);
        pushMatrix();
    stroke(99, 99, 99,255*oneToZero);
    strokeWeight(12);
    fill(99, 99, 99,255*oneToZero);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    noStroke();
    fill(173, 173, 173,255*oneToZero);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    stroke(99, 99, 99,255*oneToZero);
    strokeWeight(6);
    fill(10, 173, 56);
    ellipse(0,0,15,15);


    popMatrix();
        }
        break;
        case 'egg':
        rotate((frameCount*8)*sin(this.id));
        egg(0,0,0.16);
        break;
        default:
        fill(255, 0, 0);
        noStroke();
        ellipse(0,0,30,30);
        break;
    }
    popMatrix();
    this.l -= speed;
    if(this.l <= 0){
        this.kill();
    }
};

projectile.prototype.registerHit = function(){
    if(!this.data.damage && this.data.damage !== 0){
    this.data.damage = this.data.owner.attack;
    }
    var splatter = new effect(this.x,this.y,this.data.type+' splatter',this.data.customSize||1,this.customLife||100,{
        differenceHealth:this.data.target.health-this.data.target.dHealth,
        differenceAttack:this.data.target.attack-this.data.target.dAttack,
        hit:this.data.target,
        damage:this.data.damage||0,
        amount:this.data.amount,
    });
    //println(this.data.target.health+' , '+this.data.target.dHealth);
    //println(this.data.damage + ' , '+ this.data.owner.attack);
    this.data.target.temporaryScale = 1.5;
    this.data.target.temporaryRot = -30;

    if(this.data.damage > 0){
    this.data.target.dHealth -= this.data.damage;
    }else{
    this.data.target.dHealth = this.data.target.health;
    }
    this.data.target.dAttack = this.data.target.attack;
    this.data.target.checkStatUp();

this.kill();
};
projectile.prototype.doRegistering = function(){
if(this.data.owner.attack){
    this.data.target.health -= this.data.owner.attack;
    this.data.target.checkStatUp();
}
};
projectile.prototype.update = function(){

    for(var q = 0; q < speed; q++){
    this.x += this.vx;
    this.y += this.vy;

    if(this.data.g||this.data.g === 0){
        this.vy += this.data.g;
    }else{
        this.vy += 0.1;
    }

    if(this.data.target && (this.data.g === 0||this.vy >= 0)){
        if(dist(this.x,this.y,this.data.target.x,this.data.target.y)<=25 || this.data.target === m.hold){
            if(this.data.target === m.hold){
            this.x = this.data.target.x;
            this.y = this.data.target.y;
            }
            this.registerHit();
            q = speed+1;
        }

    }
    }

    this.draw();
    this.life++;
    if(this.data.data.bulletLife){
    if(this.life >= this.data.data.bulletLife){
    if(this.data.target){
    this.x = this.data.target.x;
    this.y = this.data.target.y;
    }
    this.registerHit();
    this.kill();
    }
    }else if(this.life >= 500){
    if(this.data.target){
    this.x = this.data.target.x;
    this.y = this.data.target.y;
    }
    this.registerHit();
    this.kill();
    }


};
projectile.prototype.kill = function(){
for(var i = 0; i < projs.length; i++){
    if(projs[i] === this){
        projs.splice(i,1);
    }
}
};
effect.prototype.kill = function(){
for(var i = 0; i < effects.length; i++){
    if(effects[i] === this){
        effects.splice(i,1);
    }
}
};
chicken.prototype.animDraw = function(behind){
if(!(delag4&&!this.stats.crucialAnim)){
if(behind){
 if(this.stats.animImgBehind){
    pushMatrix();
    scale(this.stats.size);
    this.stats.animImgBehind(this);
    popMatrix();
}  
}else{
if(this.stats.animImg){
    pushMatrix();
    scale(this.stats.size);
    this.stats.animImg(this);
    popMatrix();
}
}
}
};
chicken.prototype.draw = function(e,noAnimDraw){
    this.displayed = true;
    //println(this.pos);
    if(e){
    this.pos = e;
    }else{
    // retain position
    }
    if(this.attack < 0){
    this.attack = 0;
    }

    this.radius = 25;

    this.checkStatUp();

    pushMatrix();
    translate(this.x,this.y);
    var saveDir = this.dir;
    scale(this.dir,1);
    if(this.coopId){
        this.dir = this.coopId.dir;
    }else{
        this.dir = 1;
    }

    scale(this.stats.size);
    var d = atan2(this.py-this.y,this.px-this.x);

    if(!this.cardReveal && this.cardReveal !== 0){
    this.cardReveal = 1;
    }
    if(!this.highlighted && !this.promptCard){
    this.cardReveal= lerp(this.cardReveal, 1,0.15);
    }
    if(!this.highlightAddScale){
        this.highlightAddScale = 1;
    }
    if(this.highlighted){
        this.highlightAddScale = lerp(this.highlightAddScale, 1.12,0.15);

    }else{
    this.highlightAddScale = lerp(this.highlightAddScale, 1,0.15);
    }
    if(this.highlightAddScale > 1.001){
    noStroke();
        fill(0,0,0,(this.highlightAddScale-1)*1000);
        var d2 = 0;
        if(!delag2){
        d2 = dist(this.px,this.py,this.x,this.y);
        }
        ellipse(cos(d)*d2,sin(d)*d2,75,75);
    scale(this.highlightAddScale);
    }
    pushMatrix();

    if(!delag2){
    if(!this.curStretch){
        this.curStretch = {x:1,y:1};
    }
    var stretchLimit = 30;
    if(this.stats.stretchLimit){
    stretchLimit = this.stats.stretchLimit;
    }
    this.curStretch.x = lerp(this.curStretch.x,(abs(this.x-this.px)/stretchLimit)+1,0.1);
    this.curStretch.y = lerp(this.curStretch.y,(abs(this.y-this.py)/stretchLimit)+1,0.1);

    scale(this.curStretch.x,this.curStretch.y);
    }

    translate(0,22);
    rotate(sin(frameCount*this.shakeIntensity+this.id)*this.shakeRad);
    this.shakeIntensity = 1.1;
    this.shakeRad = 5;
    if(!delag2){
    rotate(this.x-this.px);
    }
    if(this.temporaryScale || this.temporaryScale === 0){
    scale(this.temporaryScale);
    this.temporaryScale = lerp(this.temporaryScale,1,0.1);
    }else{
    this.temporaryScale = 1;
    }
    if(this.temporaryRot || this.temporaryRot === 0){
    rotate(this.temporaryRot);
    this.temporaryRot = lerp(this.temporaryRot,0,0.1);
    }else{
    this.temporaryRot = 0;
    }
    translate(0,-22);
    if(!this.invis){
    if(!noAnimDraw){
    this.animDraw(true);
    }
    pushMatrix();
    scale(1/2);
    translate(-300,-300);
    image(getImg(this.stats.name,'chicken'),0,0);
    popMatrix();
    if(!noAnimDraw){
    this.animDraw();
    }
    }
    if(this.bad > 0){
        this.bad--;
        fill(200, 0, 0);
        textSize(20);
        textAlign(CENTER,BASELINE);
        pushMatrix();
        scale(saveDir,1);
        //text(this.badMessage,0,0
        noStroke();
        fill(255, 3, 3, 100);
        ellipse(0,0,80,80);
        popMatrix();
    }
    if(this.stats.name === "Boring chicken"){
    textSize(50);
    fill(0,0,0);
    scale(0.6);
    textAlign(BASELINE);
    text(this.hat,-30,-25);
    }
    popMatrix();

    if(this.foodHighlight){
        noStroke();
        fill(247, 255, 0,100);
        ellipse(0,0,80,80);
    }
    this.foodHighlight = false;

    stroke(0,0,0);
    strokeWeight(3);

    if(!this.noStatsShow){
    pushMatrix();
    scale(saveDir,1);
    var fadeStuff = 255-(this.highlightAddScale-1)*(255/0.12);
    var fadeStuffA = fadeStuff/255;

    // attack
    attack(-18,-16,0.14*1.1,fadeStuff);

    // heart
    if(scene === 'fight' || scene === 'summary'){
    var a = this.dHealth/this.maxhealth;
    if(a < 0){
    a = 0;
    }
    if(a > 1){
    a = 1;
    }
    dynaHeart(20,-20,0.1*1.1,fadeStuff,a);
    }else{
    heart(20,-20,0.1*1.1,fadeStuff);
    }

    noStroke();
    fill(163, 163, 163,100*fadeStuffA);
    rect(-16,-34,30,8,7);

    noStroke();
    fill(255, 0, 183,150*fadeStuffA);
    rect(-16,-34,30*getProgress(this.xp),8,7);

    stroke(66, 66, 66,200*fadeStuffA);
    strokeWeight(2);
    noFill();
    rect(-16,-34,30,8,7);

    textSize(10);
    textAlign(CENTER,BASELINE);
    fill(0,0,0,fadeStuff);
    text(this.dHealth,20,-19);
    text(this.dAttack,-20,-19);
    fill(0,0,0,fadeStuff);
    textSize(10);
    if(getLevel(this.xp)> 1){
    text(getLevel(this.xp),0,-26);
    }
    popMatrix();
    }
    this.noStatsShow = false;
    if(this.inCoop){

    }
    popMatrix();
    if(scene === 'fight'){
        if(this.showTargetPath){

            if(this.target){
                attackPaths.push([this.x,this.y,this.target.x,this.target.y,getAngle(this,this.target)]);
            }
        }
    }
    this.lvl = getLevel(this.xp);
    this.inCoop = false;
};
chicken.prototype.checkStatUp = function(){
    this.lvl = getLevel(this.xp);
    if(!this.pAttack||!this.pHealth){
    this.pAttack = this.attack;
    this.pHealth = this.health;
    }
    if(!this.pXp && this.pXp !== 0){
    this.pXp = this.xp;
    }

    if((this.health <= 0 ||this.dHealth <= 0 )&& scene === 'game'){
    this.health = 1;
    this.dHealth = 1;
    this.pHealth = 1;
    }
    if(this.health > 99){
    this.health = 99;
    if(this.pHealth>99){
    this.pHealth = 99;
    }
    this.dHealth = 99;
    }
    if(this.attack > 99){
    this.attack = 99;
    if(this.pAttack>99){
    this.pAttack = 99;
    }
    this.dAttack = 99;
    }

    if(!this.maxhealth || this.health > this.maxhealth){
    this.maxhealth = this.health;
    }

    if(round(getLevel(this.pXp)) < round(getLevel(this.xp))){
    lastLeveled = this;
    if(scene === 'game'){
    doAbilitiesTurn('friendlyLevelUp');
    }
    if(this.stats.levelUp){
    if(scene === 'game'){
    gFight.timer = 0;
    }
    //println('e');
    todo.push([this,"levelUp"]);
    }
    }

    if(round(this.health) < round(this.pHealth)){
    if(this.stats.hurt){
    if(scene === 'game'){
    gFight.timer = 0;
    }
    //println('e');
    todo.push([this,"hurt"]);
    }
    }

    this.attack = round(this.attack);
    this.health = round(this.health);
    this.pXp = this.xp;

    this.pAttack = this.attack;
    this.pHealth = this.health;
};
contraption.prototype.checkStatUp = function(){
    if(!this.pHealth){
    this.pHealth = this.health;
    }
    this.lvl = getLevel(this.xp);
    // if((this.health <= 0 ||this.dHealth <= 0 )&& scene === 'game'){
    // this.health = 1;
    // this.dHealth = 1;
    // this.pHealth = 1;
    // }

    // if(round(this.health) < round(this.pHealth)){
    // if(this.stats.hurt){
    // if(scene === 'game'){
    // gFight.timer = 0;
    // }
    // //println('e');
    // todo.push([this,"hurt"]);
    // }
    // }

    this.health = round(this.health);
    this.pHealth = this.health;
};
contraption.prototype.draw = function(e){

    this.checkStatUp();
    this.displayed = true;
    //println(this.pos);
    if(e){
    this.pos = e;
    }else{
    // retain position
    }
    pushMatrix();
    translate(this.x,this.y);
    var saveDir = this.dir;
    scale(this.dir,1);
    if(false){
        this.dir = -1;
    }else{
        this.dir = 1;
    }
    if(!this.nScale){
        this.nScale = 1;
    }
    if(e !== 'shop' || m.hold === this){
        this.nScale = lerp(this.nScale,this.radius/(25*this.stats.size),0.1);
    }else{
        this.nScale = lerp(this.nScale,1,0.1);
    }

    scale(this.nScale);

    scale(this.stats.size);
    var d = atan2(this.py-this.y,this.px-this.x);

    if(!this.cardReveal && this.cardReveal !== 0){
    this.cardReveal = 1;
    }
    if(!this.highlighted && !this.promptCard){
    this.cardReveal= lerp(this.cardReveal, 1,0.15);
    }
    if(!this.highlightAddScale){
        this.highlightAddScale = 1;
    }
    if(this.highlighted){
        this.highlightAddScale = lerp(this.highlightAddScale, 1.12,0.15);
        noStroke();
        fill(0,0,0,(this.highlightAddScale-1)*1000);
        var d2 = 0;
        if(!delag2){
        d2 = dist(this.px,this.py,this.x,this.y);
        }
        ellipse(cos(d)*d2,sin(d)*d2,70,70);
    }else{
    this.highlightAddScale = lerp(this.highlightAddScale, 1,0.15);
    }
    scale(this.highlightAddScale);
    pushMatrix();
    if(!delag2){
    if(!this.curStretch){
        this.curStretch = {x:1,y:1};
    }
    var stretchLimit = 30;
    this.curStretch.x = lerp(this.curStretch.x,(abs(this.x-this.px)/stretchLimit)+1,0.1);
    this.curStretch.y = lerp(this.curStretch.y,(abs(this.y-this.py)/stretchLimit)+1,0.1);

    scale(this.curStretch.x,this.curStretch.y);
    }

    translate(0,22);
    rotate(sin(frameCount*this.shakeIntensity+this.id)*this.shakeRad);
    this.shakeIntensity = 0;
    this.shakeRad = 0;
    if(!delag2){
    rotate(this.x-this.px);
    }
    if(this.temporaryScale || this.temporaryScale === 0){
    scale(this.temporaryScale);
    this.temporaryScale = lerp(this.temporaryScale,1,0.1);
    }else{
    this.temporaryScale = 1;
    }
    if(this.temporaryRot || this.temporaryRot === 0){
    rotate(this.temporaryRot);
    this.temporaryRot = lerp(this.temporaryRot,0,0.1);
    }else{
    this.temporaryRot = 0;
    }
    //
    translate(0,-22);
    if(this.stats.animImgBehind  && !(delag4&&!this.stats.crucialAnim)){
        pushMatrix();
        scale(this.stats.size);
        this.stats.animImgBehind(this);
        popMatrix();
    }
    pushMatrix();
    scale(1/2);
    translate(-300,-300);
    image(getImg(this.stats.name,'contraption'),0,0);
    popMatrix();
    if(this.stats.animImg && !(delag4&&!this.stats.crucialAnim)){
        pushMatrix();
        scale(this.stats.size);
        this.stats.animImg(this);
        popMatrix();
    }
    if(this.heldTimer){
        if(this.stats.clickAndHold){
            if(scene === 'game'){
        this.temporaryRot = random(-this.heldTimer/10,this.heldTimer/10);
        this.temporaryScale = 1+(this.heldTimer/60)/10;
        noStroke();
        fill(64, 64, 64,180);
        arc(0,0,this.radius*1.8,this.radius*1.8,0,this.heldTimer*6);    
            }
        }
    }

    if(this.bad > 0){
        this.bad--;
        fill(200, 0, 0);
        textSize(20);
        textAlign(CENTER,BASELINE);
        pushMatrix();
        scale(1/this.nScale);
        scale(saveDir,1);
        //text(this.badMessage,0,0);
        noStroke();
        fill(255, 3, 3, 100);
        ellipse(0,0,80,80);
        popMatrix();
    }
    //
popMatrix();

     if(this.foodHighlight){
        noStroke();
        fill(0, 255, 242,100);
        ellipse(0,0,80,80);
    }
    this.foodHighlight = false;

    stroke(0,0,0);
    strokeWeight(3);
    this.noStatsShow = false;
    popMatrix();

    if(myContraptions.indexOf(this) >= 0){
        this.owned = true;
    }

};
foodItem.prototype.draw = function(e){

    this.displayed = true;
    //println(this.pos);
    if(e){
    this.pos = e;
    }else{
    // retain position
    }
    pushMatrix();
    translate(this.x,this.y);
    var saveDir = this.dir;
    scale(this.dir,1);
    if(false){
        this.dir = -1;
    }else{
        this.dir = 1;
    }
    if(!this.nScale){
        this.nScale = 1;
    }
    if(e !== 'shop' || m.hold === this){
        this.nScale = lerp(this.nScale,this.radius/(25*this.stats.size),0.1);
    }else{
        this.nScale = lerp(this.nScale,1,0.1);
    }

    scale(this.nScale);

    scale(this.stats.size);
    var d = atan2(this.py-this.y,this.px-this.x);

    if(!this.cardReveal && this.cardReveal !== 0){
    this.cardReveal = 1;
    }
    if(!this.highlighted && !this.promptCard){
    this.cardReveal= lerp(this.cardReveal, 1,0.15);
    }
    if(!this.highlightAddScale){
        this.highlightAddScale = 1;
    }
    if(this.highlighted){
        this.highlightAddScale = lerp(this.highlightAddScale, 1.12,0.15);
        noStroke();
        fill(0,0,0,(this.highlightAddScale-1)*1000);
        var d2 = 0;
        if(!delag2){
        d2 = dist(this.px,this.py,this.x,this.y);
        }
        ellipse(cos(d)*d2,sin(d)*d2,70,70);
    }else{
    this.highlightAddScale = lerp(this.highlightAddScale, 1,0.15);
    }
    scale(this.highlightAddScale);
    pushMatrix();

    if(!delag2){
    if(!this.curStretch){
        this.curStretch = {x:1,y:1};
    }
    var stretchLimit = 30;
    this.curStretch.x = lerp(this.curStretch.x,(abs(this.x-this.px)/stretchLimit)+1,0.1);
    this.curStretch.y = lerp(this.curStretch.y,(abs(this.y-this.py)/stretchLimit)+1,0.1);

    scale(this.curStretch.x,this.curStretch.y);
    }

    translate(0,22);
    rotate(sin(frameCount*this.shakeIntensity+this.id)*this.shakeRad);
    this.shakeIntensity = 0;
    this.shakeRad = 0;
    if(!delag2){
    rotate(this.x-this.px);
    }
    if(this.temporaryScale || this.temporaryScale === 0){
    scale(this.temporaryScale);
    this.temporaryScale = lerp(this.temporaryScale,1,0.1);
    }else{
    this.temporaryScale = 1;
    }
    if(this.temporaryRot || this.temporaryRot === 0){
    rotate(this.temporaryRot);
    this.temporaryRot = lerp(this.temporaryRot,0,0.1);
    }else{
    this.temporaryRot = 0;
    }
    //

    translate(0,-22);
    pushMatrix();
    scale(1/2);
    translate(-300,-300);

    image(getImg(this.stats.name,'food'),0,0);

    popMatrix();
    if(this.stats.animImg && !(delag4&&!this.stats.crucialAnim)){
        this.stats.animImg(this);
    }
    if(this.heldTimer){
        if(this.stats.clickAndHold){
        this.temporaryRot = random(-this.heldTimer/10,this.heldTimer/10);
        this.temporaryScale = 1+(this.heldTimer/60)/10;
        noStroke();
        fill(64, 64, 64,180);
        arc(0,0,this.radius*1.8,this.radius*1.8,0,this.heldTimer*6);
        }
    }

    if(this.bad > 0){
        this.bad--;
        fill(200, 0, 0);
        textSize(20);
        textAlign(CENTER,BASELINE);
        pushMatrix();
        scale(saveDir,1);
        text(this.badMessage,0,0);
        popMatrix();
    }
    //

    popMatrix();
    stroke(0,0,0);
    strokeWeight(3);
    this.noStatsShow = false;
    popMatrix();

};
coop.prototype.draw = function() {
    this.physics();
    pushMatrix();
    if(!this.highlightAddScale){
        this.highlightAddScale = 1;
    }
    if(this.highlighted){
        this.highlightAddScale = lerp(this.highlightAddScale, 1.06,0.15);
    }else{
    this.highlightAddScale = lerp(this.highlightAddScale, 1,0.15);
    }
    translate(this.x,this.y);
    scale(this.highlightAddScale);
    translate(-this.x,-this.y);
    pushMatrix();
    translate(this.x,this.y);
    scale(this.dir,1);
    scale(this.stats.size);
    stroke(0,0,0);
    strokeWeight(5);
    fill(102, 46, 8);
    rect(-110,-70,220,145,5);
    popMatrix();
    this.manage();
    pushMatrix();
    translate(this.x,this.y);
    scale(this.dir,1);
    scale(this.stats.size);
    strokeWeight(5);
    stroke(0, 0, 0);
    fill(255, 56, 56);
    quad(-130,-70,130,-70,105,-105,-105,-110);
    fill(255, 153, 0);
    ellipse(-90,-90,25,25);
    fill(0,0,0);
    textAlign(CENTER,BASELINE);
    textSize(11);
    var i = myCoops.indexOf(this)+1;
    var count = 0;
    for(var q = 0; q < 2; q++){
    count = 0;
    if(teams[q]){
    for(var q2 = 0; q2 < teams[q].length; q2++){
    if(teams[q][q2].id.IDENTIFIER === 'coop'){
    count++;
    if(teams[q][q2].id === this){
        i = count;
    }
    }
    }
    }
    }
    pushMatrix();
    translate(-90,-87);
    scale(this.dir,1);
    translate(90,87);
    text(i,-90,-87);
    popMatrix();
    var num = 20;
for(var i = 0; i < num; i+=3){
var odd = 1;
if(round(i/2) === i/2){
odd = 2;
}
mGrass(-20+cos(i*(180/num))*110,50+sin((i+0.5)*(180/num))*20,1,'grass'+odd);
}
    popMatrix();
    popMatrix();

};
chicken.prototype.kill = function() {
if(scene === 'game' || scene === 'fight'){
var kfc = new effect(this.x,this.y,'deadChicken',1,100);
}
killChicken(this);
};
foodItem.prototype.kill = function(){
for(var i = foods.length-1; i > -1; i--){
    if(foods[i] === this){
        foods.splice(i,1);
    }
}
};
contraption.prototype.kill = function() {
if(scene === 'game' || scene === 'fight'){
var tmc = new effect(this.x,this.y,'deadContraption',this.radius/30,400);
}
killContraption(this);
};
var physics = function(e){
if(!e.x){
    e.x = 0;
}
if(!e.y){
    e.y = 0;
}
if(!e.tx){
e.tx = e.x;
}
if(!e.ty){
e.ty = e.y;
}
e.px = e.x;
e.py = e.y;
if(delag2){
e.x = e.tx;
e.y = e.ty;
}else{
e.x = lerp(e.x,e.tx,physicsLerpSpeed);
e.y = lerp(e.y,e.ty,physicsLerpSpeed);
}
};
coop.prototype.physics = function(){
if(!this.x){
    this.x = 0;
}
if(!this.y){
    this.y = 0;
}
if(!this.tx){
this.tx = this.x;
}
if(!this.ty){
this.ty = this.y;
}
this.px = this.x;
this.py = this.y;
this.x = lerp(this.x,this.tx,0.14);
this.y = lerp(this.y,this.ty,0.14);
};
chicken.prototype.cardStuff = function(x,y,n){
    var r = n*(1/0.12);
    var n2 = 1;
    if(this.promptCard){
        n2 = 0.9;
    }
    fill(200,200,200,((n)*2100)*n2);
noStroke();
    var tAbility = 'No ability';
    if(this.stats.ability){
        tAbility = this.stats.ability(this.lvl,this);
    }
    textAlign(LEFT,BASELINE);
    textSize(15);
    var hAbility = getHeightOfText(tAbility,240);
    if(this.stats.plusCardHeight){
        hAbility += this.stats.plusCardHeight;
    }
    var wid = 200;
    if(this.stats.plusCardWidth){
        wid += this.stats.plusCardWidth;
    }
    strokeWeight(2);
    stroke(0,0,0);
    rect(x,y,wid*r,(100+hAbility)*r,6);
    fill(0,0,0);
    textAlign(LEFT,BASELINE);
    textSize(15);
    pushMatrix();
    translate(x,y);
    translate(0,22);
    scale(r);
    scale(0.8);
    var t = this.stats.name;
    if(!t){
        t = 'Boring chicken';
    }
    text(t+' (L'+this.lvl+')',10,2);
    var add = '';
    if(this.tempStatAttack){
    add = ' (base '+(this.attack-this.tempStatAttack)+')';
    }
    text('Attack   : '+this.attack+add,10,24);
    attack(83,23,0.1);
    fill(0,0,0);
    var add = '';
    if(this.tempStatHealth){
    add = ' (base '+(this.health-this.tempStatHealth)+')';
    }
    text('Health   : '+this.health+add,10,46);
    heart(81,43,0.07);
    fill(0,0,0);
    var t = this.stats.tier;
    if(!t){
        t = 0;
    }
    text('Tier: '+t,10,68);

    text(tAbility,10,78,240,300);

    noStroke();
    fill(163, 163, 163);
    rect((wid*r)/2-25,-35,100,15,7);

    noStroke();
    fill(255, 0, 183,200);
    rect((wid*r)/2-25,-35,100*getProgress(this.xp),15,7);

    stroke(66, 66, 66);
    strokeWeight(3);
    noFill();
    rect((wid*r)/2-25,-35,100,15,7);

    textAlign(CENTER,CENTER);
    textSize(10);
    fill(0,0,0);
    text('XP: '+this.xp,(wid*r)/2+25,-27);

    dice((wid*r)/2-30-10,-27,this.stats.tier);
    dice((wid*r)/2-25+100+5+10,-27,this.stats.tier);

    popMatrix();

};
contraption.prototype.cardStuff = function(x,y,n){
    var r = n*(1/0.12);
    fill(200,200,200,(n)*2100);
noStroke();
    var tAbility = 'No ability';
    if(this.stats.ability){
        tAbility = this.stats.ability(this.lvl,this);
    }
    textAlign(LEFT,BASELINE);
    textSize(15);
    var hAbility = getHeightOfText(tAbility,240);
    if(this.stats.plusCardHeight){
        hAbility += this.stats.plusCardHeight;
    }
    var wid = 200;
    if(this.stats.plusCardWidth){
        wid += this.stats.plusCardWidth;
    }
    strokeWeight(2);
    stroke(0,0,0);
    rect(x,y,wid*r,(100+hAbility)*r,6);
    fill(0,0,0);
    textAlign(LEFT,BASELINE);
    textSize(15);
    pushMatrix();
    translate(x,y);
    translate(0,22);
    scale(r);
    scale(0.8);
    var t = this.stats.name;
    if(!t){
        t = 'Boring chicken';
    }
    text(t+' (L'+this.lvl+')',10,2);
    text('Size: '+(this.radius*this.size),10,24);
    fill(0,0,0);
    text('Durability (-1 p/t)   : '+this.health,10,46);
    heart(198,43,0.07);
    fill(0,0,0);
    var t = this.stats.tier;
    if(!t){
        t = 0;
    }
    text('Tier: '+t,10,68);

    text(tAbility,10,78,240,300);

    dice((wid*r)/2+25,-27,this.stats.tier);

    popMatrix();

};
foodItem.prototype.cardStuff = function(x,y,n){
    var r = n*(1/0.12);
    fill(200,200,200,(n)*2100);
noStroke();
    var tAbility = 'No ability';
    if(this.stats.ability){
        tAbility = this.stats.ability(1,this);
    }
    textAlign(LEFT,BASELINE);
    textSize(15);
    var hAbility = getHeightOfText(tAbility,240);
    if(this.stats.plusCardHeight){
        hAbility += this.stats.plusCardHeight;
    }
    var wid = 200;
    if(this.stats.plusCardWidth){
        wid += this.stats.plusCardWidth;
    }
    strokeWeight(2);
    stroke(0,0,0);
    rect(x,y,wid*r,(100+hAbility)*r,6);
    fill(0,0,0);
    textAlign(LEFT,BASELINE);
    textSize(15);
    pushMatrix();
    translate(x,y);
    translate(0,22);
    scale(r);
    scale(0.8);
    var t = this.stats.name;
    if(!t){
        t = 'Boring chicken';
    }
    text(t,10,2);
    fill(0,0,0);
    var t = this.stats.tier;
    if(!t){
        t = 0;
    }
    text('Tier: '+t,10,24);

    text('Use on: '+this.stats.targetString,10,46);

    text(tAbility,10,60,240,300);

    dice((wid*r)/2+25,-27,this.stats.tier);

    popMatrix();

};
var card = function(e,noMove,subj){

    noStroke();
    var tAbility = 'No ability';
    if(subj.stats.ability){
        tAbility = subj.stats.ability(1,subj);
    }

    textAlign(LEFT,BASELINE);
    textSize(15);
    var hAbility = getHeightOfText(tAbility,240);
    if(subj.stats.plusCardHeight){
        hAbility += subj.stats.plusCardHeight;
    }
    var n = e-1;
    var d = 30;

    var wid = 200;
    if(subj.stats.plusCardWidth){
        wid += subj.stats.plusCardWidth;
    }

    if(subj.y > 145+hAbility || noMove){
    // -150
    d = -135-hAbility;
    }
    var l = -100;
    if(subj.x < 110 && !noMove){
        l = -subj.x+10;
    }
    if(subj.x > 490-(wid-200) && !noMove){
        l = 600-subj.x-210-(wid-200);
    }

    var r = n*(1/0.12);
    subj.cardStuff(subj.x+l*r,subj.y+d*r,n);

};
chicken.prototype.behavior = function(){
physics(this);
if(dist(msX,msY,this.x,this.y)<=25){
if(!this.noStatsShow && !m.hold && notHeldCount > 30){
    card(this.cardReveal,false,this);
    this.cardReveal= lerp(this.cardReveal, 1.12,0.15);
}
this.highlighted = true;
cursor(HAND);
if(this.canHold && ((clicked && m.hold !== this)||(held && m.hold === false))){
m.hold = this;
m.hold.type = 'chicken';
clicked = false;
m.downPos = {x:msX,y:msY};
if(this.coopId){
    this.origin = [this.coopId,this.coopPos];
}else{
    this.origin = false;
}
}
}else{
this.highlighted = false;
}
this.canHold = true;
};
contraption.prototype.behavior = function(){
physics(this);
if(this.pressed === true && !didMouseCurMove() && this.owned === true && m.hold === this){
if(!this.heldTimer){
this.heldTimer = 0;
}
this.heldTimer++;
this.pressed = false;
}else{
if(this.heldTimer > 0){
this.heldTimer-=3;
}
if(this.heldTimer < 0){
this.heldTimer = 0;
}
}
if(this.heldTimer >= 60){
if(this.stats.clickAndHold){
    if(m.hold){
        m.hold = false;
    }
    this.stats.clickAndHold(this,this.lvl);
    stopHold = true;
    this.heldTimer = 0;
}
}
if(dist(msX,msY,this.x,this.y)<=(25*this.stats.size)*this.nScale){
if(scene === 'game'){
    if(todo.length <= 0){
    if(held && !stopHold){
        this.pressed = true;
    }
    }
}
if(!this.noStatsShow && !m.hold && notHeldCount > 30){
    card(this.cardReveal,false,this);
    this.cardReveal= lerp(this.cardReveal, 1.12,0.15);
}

this.highlighted = true;
cursor(HAND);

if(!stopHold && this.canHold && ((clicked && m.hold !== this)||(held && m.hold === false))){

m.hold = this;
m.hold.type = 'contraption';
this.grabPointY = this.y-msY;
this.grabPointX = this.x-msX;
clicked = false;
m.downPos = {x:msX,y:msY};
if(this.coopId){
    this.origin = [this.coopId,this.coopPos];
}else{
    this.origin = false;
}
}
}else{
this.highlighted = false;
}
this.canHold = true;
};
foodItem.prototype.behavior = function(){
physics(this);
if(dist(msX,msY,this.x,this.y)<=(25*this.stats.size)*this.nScale){

if(!this.noStatsShow && !m.hold && notHeldCount > 30){
    card(this.cardReveal,false,this);
    this.cardReveal= lerp(this.cardReveal, 1.12,0.15);
}

this.highlighted = true;
cursor(HAND);

if(!stopHold && this.canHold && ((clicked && m.hold !== this)||(held && m.hold === false))){

m.hold = this;
m.hold.type = 'contraption';
this.grabPointY = this.y-msY;
this.grabPointX = this.x-msX;
clicked = false;
m.downPos = {x:msX,y:msY};
if(this.coopId){
    this.origin = [this.coopId,this.coopPos];
}else{
    this.origin = false;
}
}
}else{
this.highlighted = false;
}
this.canHold = true;
};
function canPurchase(ob){
if(gold >= ob.price){
return true;
}
return false;
}
function purchase(ob,to,cb,effectiveBoughtChicken){
spend(ob.price);
try {
cb(to);
// it says chicken but its anything that can be bought
doAbilityTurnSingle('buy',effectiveBoughtChicken);
lastBought = effectiveBoughtChicken;
if(ob.IDENTIFIER === 'contraption'){
if(tutorial.on && tutorial.num === 15){
tutorial.active = true;
tutorial.num++;
tutorial.boughtcontraptionname = ob.name;
}
doAbilitiesTurn('contraptionBought', function(e){
if(effectiveBoughtChicken === e){
return false;
}
return true;
});
}
if(ob.IDENTIFIER === 'chicken'){
if(tutorial.on && tutorial.num === 4){
tutorial.active = true;
tutorial.num++;
tutorial.boughtchickenname = ob.name;
}
doAbilitiesTurn('chickenBought', function(e){
if(effectiveBoughtChicken === e){
return false;
}
return true;
});
}
}catch(e){

}
}
coop.prototype.setSlot = function(i,ob,h){
    //println('e');
     //println(ob.pos);
var didSwap = false;
if(ob.pos === 'coop'){
    //println(this.c[i]);
if(!this.c[i]){
ob.coopId.c[ob.coopPos] = false;
this.c[i] = ob;
didSwap = true;
}else{
// swapping chickens
if(merging === true && this.c[i].name === ob.name){
// if same name, merge
merge(this.c[i],ob);
didSwap = true;
}else{
// else swap
var prev = this.c[i];
var prevSlot = ob.coopPos;
var prevCoop = ob.coopId;
this.c[i] = ob;
this.c[i].canHold = false;
prevCoop.c[prevSlot] = prev;
prevCoop.c[prevSlot].canHold = false;
}
//m.hold = false;
}
}else{
if(ob.pos !== 'battle'){

// shop
if(!this.c[i]){
    if(canPurchase(ob)){
    purchase(ob,this,function(theCoop){
    theCoop.c[i] = ob;
    shop[ob.shopPos[0]].data[ob.shopPos[1]] = false;
    didSwap = true;
    }, ob);
    }else{
    ob.bad = 30;
    ob.badMessage = 'not enough moneyz';
    ob.temporaryScale = 0.5;
    coinAnim = {s:1.4,r:0,rs:50};
    }
}else{
if(merging === true && this.c[i].name === ob.name){
// if same name and has enough money, purchase then merge
if(canPurchase(ob)){
    purchase(ob,this.c[i],function(target){
    shop[ob.shopPos[0]].data[ob.shopPos[1]] = false;
    merge(target,ob);
    didSwap = true;
    }, this.c[i]);
    }else{
    ob.bad = 30;
    ob.badMessage = 'not enough moneyz';
    ob.temporaryScale = 0.5;
    coinAnim = {s:1.4,r:0,rs:50};
    }
}
}
}
}
if(didSwap === true){
    if(h === m){
        m.hold = false;
        clicked = false;
    }
}
};
coop.prototype.manage = function(){
    var already = [];
    for(var i = 0; i < 6; i++){
        var slot = {x:0,y:0};
        if(this.dir === -1){
        var slot = {
        x:(this.x +100 -i*(200/3) -(200/3)/2 -((i%3)-i)*(200/3)),
        y:this.y-30+((i%3)-i)*(-65/3),
        };
        }else{
        var slot = {
        x:(this.x -100 +i*(200/3) +(200/3)/2 +((i%3)-i)*(200/3)),
        y:this.y-30+((i%3)-i)*(-65/3),
        };
        }
        if(m.hold && m.hold.type === 'chicken'){
            if(msX > slot.x - 25 && msX < slot.x + 25 && msY > slot.y - 25 && msY < slot.y + 25){
                if(clicked){
                    if(this.c[i] !== m.hold){
                        this.setSlot(i,m.hold,m);
                        if(already.indexOf(this.c[i]) >= 0){
                        already[already.indexOf(this.c[i])] = false;
                        }
                    }
                }
            }
        }


        // nest(slot.x,slot.y);
        if(this.c[i]){
        if(already.indexOf(this.c[i]) >= 0){
        this.c[i] = false;
        }else{
        this.c[i].inCoop = true;
        this.c[i].coopPos = i;
        this.c[i].coopId = this;
        this.c[i].origin = [this,i];
        this.c[i].owned = true;
        if(m.hold !== this.c[i]){
        this.c[i].tx = slot.x;
        this.c[i].ty = slot.y;
        this.c[i].dir = this.dir;
        this.c[i].draw('coop');
        }
        already.push(this.c[i]);
        }
        }else{
        //nest(slot.x,slot.y);
        // textSize(15);
        // text(this.c[i],slot.x-20,slot.y);
        }
        if(!this.c[i] || m.hold === this.c[i]){
        if(m.hold){
        if(m.hold.IDENTIFIER === 'chicken'){
        noStroke();
        var num2 = m.holdTimer*10;
        if(num2 > 100){
            num2 = 100;
        }
        fill(191, 191, 191,num2*0.3);
        var num = 60;
        ellipse(slot.x,slot.y,num,num);
        }
        }
        }
        nest(slot.x,slot.y);

    }
};
function pushFrom(subj,targ,r,v){
// v = retaliation

var amt = dist(subj.x,subj.y,targ.x,targ.y);
var d = atan2(subj.y-targ.y,subj.x-targ.x);

if(amt <= r){
var per = (v/(v+1));
var inverse = 1-per;
subj.x+=cos(d)*(r-amt)*inverse;
subj.y+=sin(d)*(r-amt)*inverse;
subj.tx+=cos(d)*(r-amt)*inverse;
subj.ty+=sin(d)*(r-amt)*inverse;
targ.x-=cos(d)*(r-amt)*per;
targ.y-=sin(d)*(r-amt)*per;
targ.tx-=cos(d)*(r-amt)*per;
targ.ty-=sin(d)*(r-amt)*per;
}
// while(dist(subj.x,subj.y,targ.x,targ.y)<=r){
// subj.x+=cos(d);
// subj.y+=sin(d);
// subj.tx+=cos(d);
// subj.ty+=sin(d);
// targ.x-=cos(d)*v;
// targ.y-=sin(d)*v;
// targ.tx-=cos(d)*v;
// targ.ty-=sin(d)*v;
// }
}


// this sometimes doesnt work bc nested callbacks i think
function forEachInTeam(i, callback){
    //println(i);
    if(teams[i]){
    for(var q = 0; q < teams[i].length; q++){
        switch(teams[i][q].id.IDENTIFIER){
        case 'coop':
        var theCoop = teams[i][q].id;
        for(var q2 = 0; q2 < theCoop.c.length; q2++){
            if(theCoop.c[q2]){
            callback(theCoop.c[q2]);
            }
        }
        break;
        case 'contraption':
        callback(teams[i][q].id);
        break;
        }
    }
    }
}
function forEachChickenInTeam(i, callback){
    //println(i);
    forEachInTeam(i,function(e){
    if(e.IDENTIFIER === 'chicken'){
    callback(e);
    }
    });
}
function eachChickenInTeam(i){
    //println(i);
    var ret = [];
    if(teams[i]){
    for(var q = 0; q < teams[i].length; q++){
        if(teams[i][q].id.IDENTIFIER === 'coop'){
        var theCoop = teams[i][q].id;
        for(var q2 = 0; q2 < theCoop.c.length; q2++){
            if(theCoop.c[q2]){
            ret.push(theCoop.c[q2]);
            }
        }
        }
    }
    }
    return ret;
}
chicken.prototype.findTarget = function(i){
    var foundTarget = false;
    var similarities = [Infinity,Infinity];
    var it = 0;
    var f3 = function(theChicken){
    // if(!theChicken.targeted){
    //     theChicken.targeted = 0;
    // }
    if(theChicken.targeted < it && !foundTarget){
        theChicken.targeted += 1;
        foundTarget = theChicken;
        if(theChicken.stats.targeted){
        todo.push([theChicken,"targeted"]);
        }
    }
    //return 3
    };

    //var all = eachChickenInTeam(i);
    while(foundTarget === false){
        it++;
        // for(var q = 0; q < all.length; q++){
        //     f3(all[q]);
        // }
        forEachInTeam(i,f3);
    }
    //if(i === 1){
        //println(all[0].targeted);
    //}
    return foundTarget;
};
function drawChickens(){
for(var i = 0; i < chickens.length; i++){
    chickens[i].draw();
}
}
function drawMyCoops(){
var order = [];
var left = [];
for(var i = 0; i < myCoops.length; i++){
    left.push(myCoops[i]);
}
while(left.length > 0){
var index = 0;
for(var i = 0; i < left.length; i++){
    if(left[i].y < left[index].y){
    index = i;
    }
}
order.push(left[index]);
left.splice(index,1);
}
for(var i = 0; i < order.length; i++){
    order[i].draw();
}
}
function drawMyContraptions(){
for(var i = 0; i < myContraptions.length; i++){
    myContraptions[i].draw();
}
}
function drawMyStuff(){
var order = [];
var left = [];
for(var i = 0; i < myCoops.length; i++){
    left.push(myCoops[i]);
}
for(var i = 0; i < myContraptions.length; i++){
    left.push(myContraptions[i]);
}
while(left.length > 0){
var index = 0;
for(var i = 0; i < left.length; i++){
    if(left[i].y < left[index].y){
    index = i;
    }
}
order.push(left[index]);
left.splice(index,1);
}
for(var i = 0; i < order.length; i++){
    order[i].draw();
}
}
function clearPrompts(){
for(var i = 0; i < chickens.length; i++){
    chickens[i].promptCard = false;
}
promptTarg = false;
for(var i = 0; i < contraptions.length; i++){
    contraptions[i].promptCard = false;
}
}

function manageCoops(){
for(var i = 0; i < coops.length; i++){
    coops[i].manage();
}
}
function drawThing(e){
e.draw();
}
function borderCheckCoop(e){
e.x = constrain(e.x,120,480);
e.y = constrain(e.y,110,520);
e.tx = constrain(e.tx,120,480);
e.ty = constrain(e.ty,110,520);
}
function borderCheckContraption(e){
e.x = constrain(e.x,e.radius,600-e.radius);
e.y = constrain(e.y,e.radius,600-e.radius);
e.tx = constrain(e.tx,e.radius,600-e.radius);
e.ty = constrain(e.ty,e.radius,600-e.radius);
}
function translateTeam(listOfCoops,listOfContraptions){
var ret = [];
for(var i = 0; i < listOfCoops.length; i++){
    var d = [];
    for(var q = 0; q < listOfCoops[i].c.length; q++){
        if(listOfCoops[i].c[q] !== false){
        var p = new chicken(0,0,listOfCoops[i].c[q].stats);
        p.health = listOfCoops[i].c[q].health;
        p.attack = listOfCoops[i].c[q].attack;
        p.xp = listOfCoops[i].c[q].xp;
        p.lvl = listOfCoops[i].c[q].lvl;
        p.hat = listOfCoops[i].c[q].hat;
        d.push(p);
        }else{
        d.push(false);
        }
    }
    ret.push({
    type:'coop',
    data:d,
    pos:{x:listOfCoops[i].x, y:listOfCoops[i].y,},
    });
}
for(var i = 0; i < listOfContraptions.length; i++){
    var d = listOfContraptions[i];
    ret.push({
    type:'contraption',
    data:d.stats,
    pData:d,
    pos:{x:listOfContraptions[i].x, y:listOfContraptions[i].y,},
    });
}
return ret;
}
function getEnemyTeam(){
    var options = [];

    var eString = '';
    var mostSimilar = [0,10000];

    var tries = 0;
    while(options.length < 10 && tries < 60){
    tries++;
    var i = floor(random(0,codes.length));
    if(codes[i]){
    if(codes[i][record[2]-1]){
            options.push(i);
    }
    }
    }
    //println(options);

    if(options.length > 0){
    for(var i2 = 0; i2 < options.length; i2++){
    var tCode = codes[options[i2]][record[2]-1];

    // get record
    var pdata = '';
    for(var i = 0; i < tCode.length; i++){
        var a = tCode[i];
        // get metadata
        if(a === '#'){
            i = tCode.length+1;
        }else{
            pdata += a;
        }
    }
    var a2 = 0;
    var add = '';
    var a3 = [];
    for(var i = 0; i < pdata.length; i++){
        if(pdata[i] !== ','){
        // wait for name to pass
        }else{
        a2 = i;
        i = pdata.length;
        }
    }
    for(var i = a2+1; i < pdata.length; i++){
        if(pdata[i] === ','){
        a3.push(parseInt(add,10));
        add = '';
        }else{
        add += pdata[i];
        }
    }
    a3.push(parseInt(add,10));
    // a3 should be record
    if(a3[1] > 4){
    a3[1] = 4;
    }

    // evaluate record difference
    var diff = 0;
    diff += abs(a3[0]-record[0]);
    diff += abs(a3[1]-record[1]);
    if(diff < mostSimilar[1]){
    mostSimilar[1] = diff;
    mostSimilar[0] = i2;
    }

    }
    eString = codes[options[mostSimilar[0]]][record[2]-1];
    //eString = codes[options[floor(random(0,options.length))]][record[2]-1];
    }else{
    var a = codes[floor(random(0,codes.length))];
    eString = a[a.length-1];
    }
    var ret = [];
    var unpackStage = 0;

    // metadata
    var metaData = '';
    var ns = [];
    var cs = [];
    var curBlock = '';
    var curTo = false;

    // unpack
    for(var i = 0; i < eString.length; i++){
        var a = eString[i];
        // get metadata
        if(unpackStage === 0){
            if(a === '#'){
                unpackStage = 1;
            }else{
                metaData += a;
            }
        }
        if(unpackStage === 1){
            if(a === '|'){
                if(curTo === 'coop'){
                    ns.push(curBlock);
                }else if(curTo === 'contraption'){
                    cs.push(curBlock);
                }
                curBlock = '';
                curTo = false;
            }else if(!curTo){
                if(a === 'n'){
                    curTo = 'coop';
                }else if(a === 'c'){
                    curTo = 'contraption';
                }
            }else{
                curBlock += a;
            }
        }
    }
    if(curTo === 'coop'){
        ns.push(curBlock);
    }else if(curTo === 'contraption'){
        cs.push(curBlock);
    }

    // coops
    for(var q = 0; q < ns.length; q++){
        var add = {
        type:'coop',
        data:[],
        pos:{x:300,y:300},
        };

        var blocks = [];
        var curAdd = '';
        // separate x, y, and data
        for(var i = 0; i < ns[q].length; i++){
            var a = ns[q][i];
            if(a === ',' && blocks.length < 2){
                blocks.push(curAdd);
                curAdd = '';
            }else{
                curAdd += a;
            }
        }
        blocks.push(curAdd);
        curAdd = '';

        // add x and y
        add.pos.x = 600-parseInt(blocks[0],10);
        add.pos.y = parseInt(blocks[1],10);

        var cBlocks = [];
        var curAdd = '';
        // blocks[2] is chickens
        for(var i = 0; i < blocks[2].length; i++){
            var a = blocks[2][i];
            if(a === '~'){
                if(curAdd.length > 0){
                    if(curAdd === '#'){
                    cBlocks.push(false);
                    }else{
                    cBlocks.push(curAdd);
                    }
                }
                curAdd = '';
            }else{
                curAdd += a;
            }
        }
        if(curAdd === '#'){
            cBlocks.push(false);
        }else{
            cBlocks.push(curAdd);
        }

        //cBlocks is the coop contents data
        for(var i = 0; i < cBlocks.length; i++){
            if(cBlocks[i] === false){
                add.data.push(false);
            }else{
                var mBlocks = [];
                var curAdd = [];
                for(var i2 = 0; i2 < cBlocks[i].length; i2++){
                    var a = cBlocks[i][i2];
                    if(a === ','){
                        mBlocks.push(curAdd);
                        curAdd = '';
                    }else{
                        curAdd += a;
                    }
                }
                var a = new chicken(300,300,stats.chicken[mBlocks[0]]);
                a.xp = parseInt(mBlocks[1],10);
                a.health = parseInt(mBlocks[2],10);
                a.attack = parseInt(mBlocks[3],10);
                add.data.push(a);
            }
        }


        ret.push(add);
    }

    // contraptions
    for(var q = 0; q < cs.length; q++){
        var add = {
            type:'contraption',
            data:{},
            pData:{},
            pos:{x:300,y:300},
        };

        var blocks = [];
        var curAdd = '';
        // separate data by ,
        for(var i = 0; i < cs[q].length; i++){
            var a =  cs[q][i];
            if(a === ','){
                blocks.push(curAdd);
                curAdd = '';
            }else{
                curAdd += a;
            }
        }
        // add x and y
        add.pos.x = 600-parseInt(blocks[4],10);
        add.pos.y = parseInt(blocks[5],10);

        var a = new contraption(300,300,stats.contraption[blocks[0]]);
        a.xp = blocks[1];
        a.health = blocks[2];
        a.attack = blocks[3];

        add.data = a.stats;
        add.pData = a;

        ret.push(add);
    }

    var a = '';
    var a2 = 0;
    var add = '';
    var a3 = [];
    for(var i = 0; i < metaData.length; i++){
        if(metaData[i] !== ','){
        a += metaData[i];
        }else{
        a2 = i;
        i = metaData.length;
        }
    }
    for(var i = a2+1; i < metaData.length; i++){
        if(metaData[i] === ','){
        a3.push(parseInt(add,10));
        add = '';
        }else{
        add += metaData[i];
        }
    }
    a3.push(parseInt(add,10));
    for(var i = 0; i < 3; i++){
        if(a3[i]){
        tRecord[i] = a3[i];
        if(i === 1){
        if(tRecord[i] > 4){
        tRecord[i] = 4;
        }
        }
        }
    }
    tNames[1] = a;
    //println(tNames[1]+' , '+tRecord);

    return ret;

// var d = [false,false,false,false,false,false];
// for(var i = 0; i < 6; i++){
// var a = false;
// while(!a || a.stats.tier !== 6){
// var a = new chicken(300,300,chooseFrom(types.chicken));
// }
// //var a = new chicken(300,300,stats.chicken["Vault-chicken"]);
// d[i] = a;
// }
// var d3 = new contraption(300,300,stats.contraption["Advent calendar"]);
// return [
// {type:'coop',
// data:d,
// pos:{x:120,y:110},
// },
// {type:'contraption',
// data:d3.stats,
// pData:d3,
// pos:{x:300,y:300},
// },
// ];
}
function calcProjAng(a,b,v,g){
return calcThrow(a.x,a.y,b.x,b.y,g,v);
}
function R(e){
    return random(-e,e);
}

function doAbilitiesFight(e){
var triggered = false;
var f = function(tc){
if(tc.stats[e]){
    todo.push([tc,e]);
    triggered = true;
}
};
for(var i = 0; i < 2; i++){
forEachInTeam(i,f);
}
// returns true if an ability triggered
if(triggered){
return true;
}
}
function doAbilitiesFightTeam(e,i){
var triggered = false;
var f = function(tc){
if(tc.stats[e]){
    todo.push([tc,e]);
    triggered = true;
}
};

forEachInTeam(i,f);

// returns true if an ability triggered
if(triggered){
return true;
}
}
function summonCheck(a){
lastSummoned = a;
if(scene === 'game'){
var f = function(tc){
if(tc.stats.chickenSummoned){
    gFight.timer = 0;
    todo.push([tc,'chickenSummoned',a]);
}
};
//println(e);
    for(var q = 0; q < myCoops.length; q++){
        var theCoop = myCoops[q];
        for(var q2 = 0; q2 < theCoop.c.length; q2++){
            if(theCoop.c[q2]){
            f(theCoop.c[q2]);
            }
        }

    }
}
if(scene === 'fight'){
var f = function(tc){
if(tc.stats.chickenSummoned){
    todo.push([tc,'chickenSummoned',a]);
}
};

forEachInTeam(a.teamId,f);
}
}
function allPrompts(noMove){
var ret = false;
var triggered = false;
for(var i = 0; i < chickens.length; i++){
    if(chickens[i].promptCard){
        chickens[i].cardReveal= lerp(chickens[i].cardReveal, 1.12,0.15);
        card(chickens[i].cardReveal,noMove,chickens[i]);
        ret = chickens[i];
        triggered = true;
    }
}
for(var i = 0; i < contraptions.length; i++){
    if(contraptions[i].promptCard){
        contraptions[i].cardReveal= lerp(contraptions[i].cardReveal, 1.12,0.15);
        card(contraptions[i].cardReveal,noMove,contraptions[i]);
        ret = contraptions[i];
        triggered = true;
    }
}
if(!triggered && promptTarg){
promptTarg.cardReveal= lerp(promptTarg.cardReveal, 1.12,0.15);
        card(promptTarg.cardReveal,noMove,promptTarg);
        ret = promptTarg;
        if(!promptTarg.promptTargTimer){
            promptTarg.promptTargTimer = 0;
        }
        promptTarg.promptTargTimer++;
        if(promptTarg.promptTargTimer > 60 && scene === 'game'){
        promptTarg.promptTargTimer = 0;
        promptTarg = false;
        }
}
return ret;
}

function stringTranslated(e){
var ret = '';

// metadata # |c/n DATA,DATA,DATA |c/n DATA,DATA,DATA

// | to divide objects
// # to end metadata
// , to separate metadata and object properties
// ~ to separate chickens
// metadata: name, record[0], record[1], record[2]
// object identifiers: coop=n, contraption=c
// contraption data: name, xp, health, attack, x, y
// coop data: x, y, ~CHICKEN ~CHICKEN ~#, etc
// chicken data: ~ name, xp, health, attack
// DO NOT ALLOW IN NAMES: # | , ~

ret += tNames[0]+','+record[0]+','+record[1]+','+record[2]+'#';

for(var i = 0; i < e.length; i++){

    if(e[i].type === 'contraption'){
        ret += '|c';
        ret += e[i].data.name+',';
        ret += e[i].pData.xp+',';
        ret += e[i].pData.health+',';
        ret += e[i].pData.attack+',';
        ret += round(e[i].pos.x)+',';
        ret += round(e[i].pos.y)+',';
    }else if(e[i].type === 'coop'){
        ret += '|n';
        ret += round(e[i].pos.x)+',';
        ret += round(e[i].pos.y)+',';
        for(var q = 0; q < e[i].data.length; q++){
            var a = e[i].data[q];
            if(!a){
                ret += '~#';
            }else{
                ret += '~';
                ret += a.stats.name+',';
                ret += a.xp+',';
                ret += a.health+',';
                ret += a.attack+',';
            }
        }
    }

}

return ret;
}


var fightTrans = 1000;
var sumTrans = 0;
var sumTrans2 = 0;
var sumTrans3 = 0;
var resumeFightStage = '';
var lastWent = 0;
var homeTrans = 1000;
var confirmFight = false;
var settingFromGame = false;
var tSet = [[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[5,0]];
function initGame(){
if(tutorial.on && (tutorial.num === 12||tutorial.num === 19)){
    tutorial.active = true;
    tutorial.num++;
    tutorial.battleresults = battleResults.win;
}
saveSpeed = speed;
introTurn = true;
introAnim = 0;
speed = 2;
gold = 14+bonusGold;
bonusGold = 0;
scene = 'game';
m.hold = false;
lastWent = 0;
fightTrans = 0;
cam.x = 0; cam.y = 0;
cam.zoom = 1;
if(promptTarg){
        promptTarg.promptTargTimer = 0;
}
promptTarg = false;
var f = function(tc){
switch(tc.IDENTIFIER){
case 'chicken':
killChicken(tc);
break;
case 'contraption':
killContraption(tc);
break;
}
};
for(var i = 0; i < 2; i++){
forEachInTeam(i,f);
}
teams = [false,false];
projs = [];
effects = [];
todo = [];
tier = floor((record[2]+1)/2);
tier = round(tier);
if(tier < 1){
tier = 1;
}
if(tier > 6){
tier = 6;
}
shop[0].num = 3+floor(tier/1.3);
//tier = 4;
shop[1].num = 2+round((tier-0.5)/2)+1+round(tier/9);
shop[2].num = 3+floor(tier/2);
// println('e');
for(var i = 0; i < shop.length; i++){
roll(i,false);
}
clearPrompts();
for(var i = 0; i < chickens.length; i++){
    chickens[i].triggers = 0;
    chickens[i].promptCard = false;
    if(chickens[i].tempStatAttack){
    chickens[i].attack -= chickens[i].tempStatAttack;
    chickens[i].pAttack = chickens[i].attack;
    }
    if(chickens[i].tempStatHealth){
    chickens[i].health -= chickens[i].tempStatHealth;
    chickens[i].pHealth = chickens[i].health;
    }
    chickens[i].tempStatAttack = 0;
    chickens[i].tempStatHealth = 0;
    updateStats(chickens[i]);
}
for(var i = contraptions.length-1; i > -1; i--){

    contraptions[i].triggers = 0;
    contraptions[i].promptCard = false;
    if(myContraptions.indexOf(contraptions[i]) >= 0){
    contraptions[i].health--;
    updateStats(contraptions[i]);
    if(contraptions[i].health <= 0){
        contraptions[i].kill();
    }
    }
}

doAbilitiesTurn("startOfTurn");
}
function turn(){
lastWent = 0;

//println('a');
for(var i = 0; i < chickens.length; i++){
    updateStats(chickens[i]);
    chickens[i].promptCard = false;
}
for(var i = 0; i < contraptions.length; i++){
    updateStats(contraptions[i]);
    contraptions[i].promptCard = false;
}
promptTarg = false;
for(var i = 0; i < contraptions.length; i++){
    contraptions[i].promptCard = false;
}


if(todo.length > 0){
projs = [];
effects = [];

// sort todo and make chickens with more attack trigger first
var a = [];
while(todo.length > 0){
var index = 0;
var most = todo[0][0];
var mostNum = 0;
for(var i = 0; i < todo.length; i++){
if((todo[i][0].IDENTIFIER === 'chicken' && (todo[i][0].attack > mostNum || (todo[i][0].attack === mostNum && floor(random(0,2)) === 1)))||(todo[i][0].IDENTIFIER === 'contraption' && (todo[i][0].health > mostNum || (todo[i][0].health === mostNum && floor(random(0,2)) === 1)))){
most = todo[i][0];
if(todo[i][0].IDENTIFIER === 'chicken'){
mostNum = todo[i][0].attack;
}else{
mostNum = todo[i][0].health;
}
index = i;
}
}
a.push(todo[index]);
todo.splice(index,1);
}
todo = a;

//println('e');
//println(todo[0][0].stats[todo[0][1]]);
todo[0][0].stats[todo[0][1]](todo[0][0],todo[0][0].lvl);

//todo[0][0].dAttack = todo[0][0].attack;
//todo[0][0].dHealth = todo[0][0].health;
todo[0][0].promptCard = true;
promptTarg = todo[0][0];
todo.splice(0,1);

if(todo.length < 1){
    resumeFightStage = fightStage;
    fightStage = 'cleanup';
}

}else{

switch(fightStage){
//
case 'start':
{
var trigger = false;
projs = [];
effects = [];
var f = function(tc){
if(tc.stats.startOfBattle){
    trigger = true;
    todo.push([tc,"startOfBattle"]);
}
};
for(var i = 0; i < 2; i++){
forEachInTeam(i,f);
}
var startEnd = false;
if(eachChickenInTeam(1).length < 1){
battleResults.win = true;
startEnd = true;
}else if(eachChickenInTeam(0).length < 1){
battleResults.win = false;
startEnd = true;
}
if(!startEnd){
fightStage = 'targeting';
}else{
fightStage = 'summary';
todo = [];
}
turn();
}
break;
//
case 'targeting':
{
var f2 = function(theChicken){
theChicken.target = theChicken.findTarget(1-theChicken.teamId);
};
var f = function(theChicken){
theChicken.targeted = 0;
};
for(var q = 0; q < chickens.length; q++){
    chickens[q].targeted = 0;
}

for(var i = 0; i < 2; i++){

// var all = eachInTeam(i);
// for(var q = 0; q < all.length; q++){
//     f2(all[q]);
// }
forEachChickenInTeam(i,f2);
}
var f = function(theChicken){
theChicken.showTargetPath = true;
};

for(var i = 0; i < 2; i++){
// var all = eachInTeam(i);
// for(var q = 0; q < all.length; q++){
//   f(all[q]); 
// }
forEachChickenInTeam(i,f);
}
fightStage = 'attack';
}
break;
case 'attack':
{
projs = [];
var f = function(tc){
var h = random(5,9);
throwProj(tc,tc.target,h);

};
var f2 = function(theChicken){
theChicken.showTargetPath = false;
};

for(var i = 0; i < 2; i++){
forEachChickenInTeam(i,f2);
}
for(var i = 0; i < 2; i++){
// var all = eachInTeam(i);
// for(var q = 0; q < all.length; q++){
//     f(all[q]);
// }
forEachChickenInTeam(i,f);
}
doAbilitiesFight('attacked');
resumeFightStage = 'targeting';
fightStage = 'cleanup';
}
break;
case 'cleanup':
{

projs = [];
effects = [];
var triggered = false;
var f = function(tc){
if(tc.IDENTIFIER === 'chicken' && tc.health <= 0){
    triggered = true;
    if(tc.stats.faint){
        todo.push([tc,"faint"]);
        }
    tc.kill();
}
};
for(var i = 0; i < 2; i++){

forEachInTeam(i,f);
}

if(resumeFightStage === 'cleanup'){
    resumeFightStage = 'targeting';
}
fightStage = resumeFightStage;
if(todo.length <= 0 && (eachChickenInTeam(0).length < 1 || eachChickenInTeam(1).length < 1)){
triggered = true;
if(eachChickenInTeam(1).length < 1 && eachChickenInTeam(0).length < 1){
battleResults.win = 'tie';
}else if(eachChickenInTeam(1).length < 1){
battleResults.win = true;
}else if(eachChickenInTeam(0).length < 1){
battleResults.win = false;
}
fightStage = 'summary';
}
if(triggered === false){
    turn();
}
}
break;
case 'summary':
{
battleResults = {
win:battleResults.win,
changedRecord:false,
};
scene = 'summary';
}
break;
//
}
}

}
function initFight(){
speed = saveSpeed;
scene = 'fight';
fightStage = 'start';
resumeFightStage = 'start';
fightTrans = 0;
m.hold = false;
cam.x = 600; cam.y = 200;
cam.zoom = 0.4;
tNameAnim = 0;
teams = [false,false];
teamTotals = [0,0];
projs = [];
todo = [];
effects = [];
if(promptTarg){
        promptTarg.promptTargTimer = 0;
}
promptTarg = false;
var myTeam = translateTeam(myCoops,myContraptions);
var theirTeam = getEnemyTeam();

saveCode.push(stringTranslated(myTeam));
// var giveCode = '[';
// for(var i = 0; i < saveCode.length; i++){
//     giveCode += '"'+saveCode[i]+'",';
// }
// giveCode += '],';
// println(giveCode);

teams = [myTeam,theirTeam];
for(var i = 0; i < 2; i++){
    if(teams[i]){
    for(var q = 0; q < teams[i].length; q++){
        if(teams[i][q].type === 'coop'){
            var co = new coop(teams[i][q].pos.x+(600*(i)),teams[i][q].pos.y+(300+75),teams[i][q].data);
            //println(teams[i][q].data);
            for(var e = 0; e < teams[i][q].data.length; e++){
              teams[i][q].data[e].teamId = i;
            }
            teams[i][q].id = co;

        }
        if(teams[i][q].type === 'contraption'){
            var co = new contraption(teams[i][q].pos.x+(600*(i)),teams[i][q].pos.y+(300+75),teams[i][q].data);
            co.radius = teams[i][q].pData.radius;
            co.health = teams[i][q].pData.health;
            co.triggers = teams[i][q].pData.triggers;
            co.teamId = i;
            // add more specific stats off of pData
            co.xp = teams[i][q].pData.xp;
            teams[i][q].id = co;
        }
    }
    }
}
function readyChicken(e){
    e.x = 600;
    e.y = 600;
    e.triggers = 0;
    updateStats(e);
    e.maxhealth = e.health;
    teamTotals[e.teamId] += e.health;
    teamTotals[e.teamId] = round(teamTotals[e.teamId]);
}
forEachChickenInTeam(0,function(e){
readyChicken(e);
});
forEachChickenInTeam(1,function(e){
readyChicken(e);
});
for(var i = 0; i < chickens.length; i++){
if(chickens[i]){
chickens[i].promptCard = false;
}
}
for(var i = 0; i < contraptions.length; i++){
    contraptions[i].triggers = 0;
    contraptions[i].promptCard = false;
}
// downwards ordering
// for(var i = 0; i < teams.length; i++){
//     var left = [];
//     var down = [];
//     for(var q = 0; q < teams[i].length; q++){
//     left.push(teams[i][q]);
//     }
//     while(left.length > 0){
//     var index = 0;
//     for(var q = 0; q < left.length; q++){
//     if(left[q].id.y < left[index].id.y){
//     index = q;
//     }
//     }
//     down.push(left[index]);
//     left.splice(index,1);
//     }
//     teams[i] = down;

// }
}
function newGame(){
    if(tutorial.on){
    tutorial.num = 0;
    tutorial.active = true;
    tutorial.clicked = false;
    tutorial.timer = 0;
    }else{
    tutorial.active = false;
    }
    chickens = [];
    contraptions = [];
    foods = [];
    myCoops = [];
    myContraptions = [];
    projs = [];
    coops = [];
    todo = [];
    effects = [];

    saveCode = [];
    infiniteRun = false;
    var co = new coop(300,300,[]);
    myCoops.push(co);
    record = [0,0,1];
    gold = 14;
    bonusGold = 0;
    power = 0;
    fightTrans = 0;
    neededPower = 15;
    powerAnim = 0;
    mergeAnim = [0,0];
    coinAnim = {r:0,s:1,rs:0};
    shop = [
    {
        data:[],
        num:3+round(tier/1.5),
        frozens:[],
        types:['chicken']
    },
    {
        data:[],
        num:3,
        frozens:[],
        types:['contraption','food']
    },
    {
        data:[],
        num:5,
        frozens:[],
        types:['chicken','food','contraption']
    },
    ];
    shopPage = 0;
    shopUi = {scroll:0,};
    tier = 1;
    promptTarg = false;
    // background(0,0,0);
    // bgImg = get();
    initGame();
}
function goHome(){
    bgImg = get();
    homeTrans = 0;
    tSet = [];
    //prepTransition();
    scene = 'home';
}

function prepTransition(){
    for(var i = 0; i < 7; i++){
        var a = floor(random(0,6));
        var a2 = floor(random(0,tierStats[a].length));
        tSet.push([a,a2]);
    }
}
function doTransition(e){
if(e === 0){
prepTransition();
}
var a3 = (-e*(e-100))/2500;
var a2 = 1-a3;
pushMatrix();
translate(0,1050*a2);
noStroke();
fill(111, 242, 155);
ellipse(300,300,900,900);
for(var i = 0; i < 5; i++){
fill(111-i*30, 242-i*5, 155-i*18);
var a = 900-i*((a3*100)+100);
ellipse(300,300-i*(a3*20),a,a);
}
        for(var i = -1; i < 2; i++){
        var a = tierStats[tSet[i+1][0]][tSet[i+1][1]];
        if(a.img){
            pushMatrix();
            var a4 = (-e*(e-100-abs(i*10)))/2500;
            var a5 = 1-a4;
            translate(300+i*200,300+(a5)*300);
            rotate(i*30*a3);
            scale(2);
            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();
        }
        }

        for(var i = 0; i < 2; i++){
        var a = tierStats[tSet[i+3][0]][tSet[i+3][1]];
        if(a.img){
            pushMatrix();
            var a4 = (-e*(e-100-abs(i*4)))/2500;
            var a5 = 1-a4;
            translate(300-100+i*200,100+400*a5);
            rotate((i-0.5)*30*a3);
            scale(2);
            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();
        }
        }

        for(var i = 0; i < 2; i++){
        var a = tierStats[tSet[i+5][0]][tSet[i+5][1]];
        if(a.img){
            pushMatrix();
            translate(300-100+i*200,500);
            rotate((i-0.5)*30*a3);
            scale(2);
            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();
        }
        }

popMatrix();
}

// newGame();
// record = [10,1,5]
// var co = new coop(300,210,[]);
// myCoops.push(co);
// var q = ['Fan chicken','Fan chicken'];
// for(var i = 0; i < 6; i++){
// if(q[i]){
// var a = new chicken(300,300,stats.chicken[q[i]]);
// co.c[i] = a;
// }
// }


// for(var q = 0; q < 3; q++){
// myContraptions.push(new contraption(300+random(),300+random(),stats.contraption['Cloning machine']));
// }

// var co = new coop(200,400,[]);
// myCoops.push(co);
// for(var i = 0; i < 0; i++){
// var a = new chicken(300,300);
// co.c[i] = a;
// }

// for(var i = 0; i < shop.length; i++){
// roll(i,false);
// }




var trashAnim = 0;
var frameRecord = [];
background(0, 0, 0);
var bgImg = get();
var saveM;
var gFight = {
start:false,
timer:0,
clearTimer:0,
};
var rollAnim = 0;
var freezeAnim = 0;
var pageAnim = 0;
var rollCount = 0;
var fightAnim = 0;

var mouseMoved = false;

function aMouse(){
    return {
    x:(1/cam.zoom)*(msX)-cam.x,
    y:(1/cam.zoom)*(msY)-cam.y,
    };
}

function button(x,y,onClick){
    this.x = x;
    this.y = y;
    this.onClick = onClick;
    this.altClick = false;
    this.graphic = function(){};
    this.hitbox = function(){return false;};
    this.pop = 1;
    this.toPop = 1.2;
    this.overFor = 0;
    this.offFor = 0;
    this.offPop = 1;
    this.popSpeed = 2;
}
button.prototype.draw = function() {
    pushMatrix();
    translate(this.x,this.y);

    var popFunc = function(a){
    return sin(a*(180/PI))/a;
    };

    if(this.hitbox(this.x,this.y)){
    this.overFor++;
    this.offFor = 0;
    cursor(HAND);



    if(this.overFor < 20*this.popSpeed){
    this.pop = lerp(this.pop,lerp(this.toPop,1,popFunc(this.overFor/this.popSpeed)),0.6);
    }else{
    this.pop = lerp(this.pop,this.toPop,0.2);
    }
    this.offPop = this.pop;
    }else{
    //this.pop = 1;
    this.offFor++;
    if(this.offFor < 20*this.popSpeed){
    this.pop = lerp(this.pop,lerp(1,this.offPop,popFunc(this.offFor/this.popSpeed)),0.6);
    }else{
    this.pop = lerp(this.pop,1,0.2);
    }
    this.overFor = 0;
    }


    scale(this.pop);
    this.graphic();
    if(this.hitbox(this.x,this.y)){
    var determiner = false;
    if(this.altClick){
        determiner = this.altClick;
    }
    if((clicked&&!determiner)||(determiner && determiner())){
        this.onClick();
        this.pop = 1;
        this.offFor = 100;
    }
    }
    popMatrix();
};
var dictAnim;
var dictPops;
var playButton = new button(300,380,function(){
    homeTrans = 0;
    tSet = [];
    scene = 'name';
    dictAnim = 0;
    dictPops = [];
});
playButton.toPop = 1.2;
playButton.popSpeed = 2;
playButton.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=60){
        return true;
    }else{
        return false;
    }
};
playButton.graphic = function(){

    pushMatrix();
    rotate(cos(frameCount*1.5)*5);
    scale(2);
    strokeWeight(14);
    stroke(0,0,0);
    fill(0,0,0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-20,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    fill(255, 255, 255);
    noStroke();
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-20,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    scale(0.5);
    stroke(0,0,0);
    strokeWeight(5);
    noStroke();
    fill(255, 20, 20);
    triangle(25,0,-15,-20,-15,20);
    popMatrix();
};
var helpButton = new button(300,530,function(){
    homeTrans = 0;
    tSet = [];
    scene = 'help';
    dictAnim = 0;
    dictPops = [];
    tutorial.anim = 0;
});
helpButton.toPop = 1.2;
helpButton.popSpeed = 2;
helpButton.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=40){
        return true;
    }else{
        return false;
    }
};
helpButton.graphic = function(){
    //ellipse(0,0,100,100);
    pushMatrix();
    rotate(cos(frameCount*1.5)*5);
    scale(0.25);
    stroke(0,0,0);
    strokeWeight(20);
    fill(255, 31, 31);
    pushMatrix();
translate(-100,-130);
beginShape();
    curveVertex(103,105);
    curveVertex(12,91);
    curveVertex(85,23);
    curveVertex(170,51);
    curveVertex(140,123);
    curveVertex(55,141);
    curveVertex(62,249);
    curveVertex(110,247);
    curveVertex(113,179);
    curveVertex(183,163);
    curveVertex(229,58);
    curveVertex(169,-24);
    curveVertex(59,-30);
    curveVertex(0,12);
    curveVertex(11,89);
endShape(CLOSE);
popMatrix();
    ellipse(-20,180,60,60);
    popMatrix();
};
var settingsButton = new button(130,480,function(){
    homeTrans = 0;
    tSet = [];
    scene = 'settings';
});
settingsButton.toPop = 1.2;
settingsButton.popSpeed = 2;
settingsButton.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=55){
        return true;
    }else{
        return false;
    }
};
settingsButton.graphic = function(){

    pushMatrix();
    rotate(cos(frameCount*1.5)*5);
    scale(1.4);

    stroke(0,0,0);
    strokeWeight(12);
    fill(0,0,0);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    noStroke();
    fill(173, 173, 173);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    stroke(0,0,0);
    strokeWeight(6);
    fill(28, 232, 89);
    ellipse(0,0,15,15);


    popMatrix();



};
var dictButton = new button(470,480,function(){
    homeTrans = 0;
    tSet = [];
    scene = 'dict';
    dictAnim = 0;
    dictPops = [];
});
dictButton.toPop = 1.2;
dictButton.popSpeed = 2;
dictButton.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=55){
        return true;
    }else{
        return false;
    }
};
dictButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*5);
    scale(3.5);
    pushMatrix();
    translate(-7,-16);
strokeWeight(3);
stroke(0,0,0);
fill(97, 67, 16);
rect(0,0,20,26,5);
noStroke();
fill(201, 201, 201);
rect(-1,2,20,26,5);
strokeWeight(3);
stroke(0,0,0);
fill(125, 88, 27);
rect(-4,3,20,26,5);
strokeWeight(3);
stroke(235, 166, 5);
    popMatrix();

    scale(0.14);
    translate(-8,16);
    strokeWeight(15);
    stroke(0,0,0);
    fill(0,0,0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    fill(125, 88, 27);
    noStroke();
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    popMatrix();



};
var settingsButtonGame;
var backButton = new button(300,560,function(){
    if(!settingFromGame){
    goHome();
    }else{
    scene = 'game';
    settingsButtonGame.pop = 1;
    settingsButtonGame.offFor = 100;
    settingFromGame = false;
    }
});
backButton.toPop = 1.2;
backButton.popSpeed = 2;
backButton.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-20 && msY < y+20){
        return true;
    }else{
        return false;
    }
};
backButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(5);
    fill(217, 217, 217);
    rect(-80,-20,160,40,10);
    fill(0,0,0);
    textSize(20);
    textAlign(CENTER,CENTER);
    text('Back',0,0);
    popMatrix();



};

var contTo = 'home';
var contButton = new button(490,560,function(){
    scene = contTo;
    homeTrans = 0;
    bgImg = get();
});
contButton.toPop = 1.2;
contButton.popSpeed = 2;
contButton.hitbox = function(x,y){
    if(msX > x-70 && msX < x+70 && msY > y-20 && msY < y+20){
        return true;
    }else{
        return false;
    }
};
contButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(5);
    fill(217, 217, 217);
    rect(-70,-20,140,40,10);
    fill(0,0,0);
    textSize(20);
    textAlign(CENTER,CENTER);
    text('Continue',0,0);
    popMatrix();



};

var keyboardChars = 'qwertyuiopasdfghjklzxcvbnm';
var keyboardCase = false;
var playButton2 = new button(300,150,function(){
    if(loadedCodes){
    newGame();
    homeTrans = 0;
    tSet = [];
    fightTrans = 100000;
    }else{
        println('Awaiting code retrieval from offsite database\nIf this takes to long, try refreshing');
    }
});
playButton2.toPop = 1.2;
playButton2.popSpeed = 2;
playButton2.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=60){
        return true;
    }else{
        return false;
    }
};
playButton2.graphic = function(){

    pushMatrix();
    rotate(cos(frameCount*1.5)*5);
    scale(2);
    strokeWeight(14);
    stroke(0,0,0);
    fill(0,0,0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-20,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    fill(255, 255, 255);
    noStroke();
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-20,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);

    scale(0.5);
    stroke(0,0,0);
    strokeWeight(5);
    noStroke();
    fill(255, 20, 20);
    triangle(25,0,-15,-20,-15,20);
    popMatrix();
};
var delagButton = new button(300,90,function(){
    if(!trueDelag){
    delag = !delag;
    }else{
    delag = true;
    }
    });
delagButton.toPop = 1.1;
delagButton.popSpeed = 2;
delagButton.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-50 && msY < y+50){
        return true;
    }else{
        return false;
    }
};
delagButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(217, 217, 217);
    rect(-80,-50,160,100,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(20);
    text('Remove Grass',0,-26);
    textSize(16);

    if(!trueDelag){

    if(delag){
    fill(0, 224, 26);
    text('ON',-20,0);
    }else{
    fill(255, 0, 0);
    text('OFF',-20,0);
    }
    strokeWeight(4);
    stroke(0,0,0);
    fill(0, 255, 225,50);
    rect(-45,-12,50,25,3);
    }else{
    fill(168, 67, 0);
    textSize(10);
    text('GRASS NOT LOADED (ON)',0,0);
    strokeWeight(4);
    stroke(0,0,0);
    fill(33, 255, 255,70);
    rect(-70,-12,140,25,3);
    }

    fill(135, 0, 135);
    textSize(10);
    text('De-lag\nLevel:',-30,30);

    pushMatrix();
    translate(30,38);
    stroke(0,0,0);
    strokeWeight(14);
    fill(0,0,0);
    var a = 20;
    arc(0,0,a*2,a*2,-180,0);
    line(-a,0,a,0);
    for(var i = -180; i <= 0; i+=10){
    strokeWeight(6);
    if(i <= -90){
    stroke(255, (i+180)*(255/90), 0);
    }else{
    stroke(255-(i+90)*(255/90), 255, 0);
    }
    line(0,0,0+cos(i)*a,sin(i)*a);
    }
    stroke(0,0,0);
    strokeWeight(8);
    point(0,0);
    strokeWeight(4);
    //-170, -118, -62, -10
    var a2 = -10;
    line(0,0,cos(a2)*(a-5),sin(a2)*(a-5));

    popMatrix();

    popMatrix();



};

var delag2Button = new button(480,260,function(){
    delag2 = !delag2;
});
delag2Button.toPop = 1.1;
delag2Button.popSpeed = 2;
delag2Button.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-50 && msY < y+50){
        return true;
    }else{
        return false;
    }
};
delag2Button.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(217, 217, 217);
    rect(-80,-50,160,100,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(20);
    text('Remove Lerp',0,-26);
    textSize(16);
    if(delag2){
    fill(0, 224, 26);
    text('ON',-20,0);
    }else{
    fill(255, 0, 0);
    text('OFF',-20,0);
    }
    strokeWeight(4);
    stroke(0,0,0);
    fill(0, 255, 225,50);
    rect(-45,-12,50,25,3);
    fill(135, 0, 135);
    textSize(10);
    text('De-lag\nLevel:',-30,30);

    pushMatrix();
    translate(30,38);
    stroke(0,0,0);
    strokeWeight(14);
    fill(0,0,0);
    var a = 20;
    arc(0,0,a*2,a*2,-180,0);
    line(-a,0,a,0);
    for(var i = -180; i <= 0; i+=10){
    strokeWeight(6);
    if(i <= -90){
    stroke(255, (i+180)*(255/90), 0);
    }else{
    stroke(255-(i+90)*(255/90), 255, 0);
    }
    line(0,0,0+cos(i)*a,sin(i)*a);
    }
    stroke(0,0,0);
    strokeWeight(8);
    point(0,0);
    strokeWeight(4);
    //-170, -118, -62, -10
    var a2 = -118;
    line(0,0,cos(a2)*(a-5),sin(a2)*(a-5));

    popMatrix();

    popMatrix();



};

var delag3Button = new button(120,270,function(){
    delag3 = !delag3;
});
delag3Button.toPop = 1.1;
delag3Button.popSpeed = 2;
delag3Button.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-70 && msY < y+50){
        return true;
    }else{
        return false;
    }
};
delag3Button.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(217, 217, 217);
    rect(-80,-70,160,120,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(16);
    text('Remove Arc\nCalculations',0,-36);
    textSize(16);
    if(delag3){
    fill(0, 224, 26);
    text('ON',-20,0);
    }else{
    fill(255, 0, 0);
    text('OFF',-20,0);
    }
    strokeWeight(4);
    stroke(0,0,0);
    fill(0, 255, 225,50);
    rect(-45,-12,50,25,3);
    fill(135, 0, 135);
    textSize(10);
    text('De-lag\nLevel:',-30,30);

    pushMatrix();
    translate(30,38);
    stroke(0,0,0);
    strokeWeight(14);
    fill(0,0,0);
    var a = 20;
    arc(0,0,a*2,a*2,-180,0);
    line(-a,0,a,0);
    for(var i = -180; i <= 0; i+=10){
    strokeWeight(6);
    if(i <= -90){
    stroke(255, (i+180)*(255/90), 0);
    }else{
    stroke(255-(i+90)*(255/90), 255, 0);
    }
    line(0,0,0+cos(i)*a,sin(i)*a);
    }
    stroke(0,0,0);
    strokeWeight(8);
    point(0,0);
    strokeWeight(4);
    //-170, -118, -62, -10
    var a2 = -170;
    line(0,0,cos(a2)*(a-5),sin(a2)*(a-5));

    popMatrix();

    popMatrix();



};


var delag4Button = new button(300,454,function(){
    delag4 = !delag4;
});
delag4Button.toPop = 1.1;
delag4Button.popSpeed = 2;
delag4Button.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-88 && msY < y+50){
        return true;
    }else{
        return false;
    }
};
delag4Button.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(217, 217, 217);
    rect(-80,-88,160,138,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(14);
    text('Remove Animated\nGraphics\n(Not Recommended)',0,-45);
    textSize(16);
    if(delag4){
    fill(0, 224, 26);
    text('ON',-20,0);
    }else{
    fill(255, 0, 0);
    text('OFF',-20,0);
    }
    strokeWeight(4);
    stroke(0,0,0);
    fill(0, 255, 225,50);
    rect(-45,-12,50,25,3);
    fill(135, 0, 135);
    textSize(10);
    text('De-lag\nLevel:',-30,30);

    pushMatrix();
    translate(30,38);
    stroke(0,0,0);
    strokeWeight(14);
    fill(0,0,0);
    var a = 20;
    arc(0,0,a*2,a*2,-180,0);
    line(-a,0,a,0);
    for(var i = -180; i <= 0; i+=10){
    strokeWeight(6);
    if(i <= -90){
    stroke(255, (i+180)*(255/90), 0);
    }else{
    stroke(255-(i+90)*(255/90), 255, 0);
    }
    line(0,0,0+cos(i)*a,sin(i)*a);
    }
    stroke(0,0,0);
    strokeWeight(8);
    point(0,0);
    strokeWeight(4);
    //-170, -118, -62, -10
    var a2 = -62;
    line(0,0,cos(a2)*(a-5),sin(a2)*(a-5));

    popMatrix();

    popMatrix();



};

var settingsButtonGame = new button(100,60,function(){
    if(!m.hold){
    scene = 'settings';
    settingFromGame = true;
    backButton.pop = 1;
    backButton.offFor = 100;
    }
});
settingsButtonGame.toPop = 1.2;
settingsButtonGame.popSpeed = 2;
settingsButtonGame.hitbox = function(x,y){
    if(dist(msX,msY,x,y)<=18){
        return true;
    }else{
        return false;
    }
};
settingsButtonGame.graphic = function(){

    pushMatrix();
    rotate(cos(frameCount*1.5)*5);
    scale(0.5);

    stroke(0,0,0);
    strokeWeight(12);
    fill(0,0,0);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    noStroke();
    fill(173, 173, 173);
    ellipse(0,0,45,45);
    var num = 7;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i);
    translate(0,-25);
    rect(-7,-10,14,15);
    popMatrix();
    }

    stroke(0,0,0);
    strokeWeight(6);
    fill(10, 173, 56);
    ellipse(0,0,15,15);


    popMatrix();



};

var abandonButton = new button(510,70,function(){
    scene = 'confirmAbandon';
});
abandonButton.toPop = 1.1;
abandonButton.popSpeed = 2;
abandonButton.hitbox = function(x,y){
    if(msX > x-60 && msX < x+60 && msY > y-40 && msY < y+40){
        return true;
    }else{
        return false;
    }
};
abandonButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(255, 56, 56);
    rect(-60,-40,120,80,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(20);
    text('ABANDON\nRUN!',0,0);

    popMatrix();



};
var cancelTutorialButton = new button(90,530,function(){
    scene = 'confirmCancelTutorial';
});
cancelTutorialButton.toPop = 1.1;
cancelTutorialButton.popSpeed = 2;
cancelTutorialButton.hitbox = function(x,y){
    if(msX > x-60 && msX < x+60 && msY > y-40 && msY < y+40){
        return true;
    }else{
        return false;
    }
};
cancelTutorialButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(8);
    fill(255, 56, 56);
    rect(-60,-40,120,80,10);
    textAlign(CENTER,CENTER);
    fill(0,0,0);
    textSize(20);
    text('Cancel\nTutorial',0,0);

    popMatrix();



};

var codeButton = new button(300,545,function(){
    var giveCode = '\n[';
for(var i = 0; i < saveCode.length; i++){
    giveCode += '"'+saveCode[i]+'",';
}
giveCode += '],\n';
println(giveCode);

    println('Here is your save code!');
    println('(This project was originally hosted on Khan Academy, where the code could be shared. It may not be so easy to share the code from this platform.)');
});
codeButton.toPop = 1.2;
codeButton.popSpeed = 2;
codeButton.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-35 && msY < y+35){
        return true;
    }else{
        return false;
    }
};
codeButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 56, 205,160);
    rect(-80,-35,160,70,10);
    fill(0,0,0);
    textSize(20);
    textAlign(CENTER,CENTER);
    text('Yes!',0,0);
    popMatrix();



};
var infiniteButton = new button(120,560,function(){
    infiniteRun = true;
    bgImg = get();
    initGame();
});
infiniteButton.toPop = 1.2;
infiniteButton.popSpeed = 2;
infiniteButton.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-35 && msY < y+35){
        return true;
    }else{
        return false;
    }
};
infiniteButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(5);
    fill(99, 255, 104,160);
    rect(-90,-20,180,40,10);
    fill(0,0,0);
    textSize(20);
    textAlign(CENTER,CENTER);
    text('Endless Mode',0,0);
    popMatrix();



};
var tutorialToggleButton = new button(440,350,function(){
    tutorial.anim = 360;
    tutorial.on = !tutorial.on;
    if(tutorial.on){
    tutorial.active = true;
    }else{
    tutorial.active = false;
    }
});
tutorialToggleButton.toPop = 1.15;
tutorialToggleButton.popSpeed = 1;
tutorialToggleButton.hitbox = function(x,y){
    if(msX > x-100 && msX < x+100 && msY > y-40 && msY < y+40){
        return true;
    }else{
        return false;
    }
};
tutorialToggleButton.graphic = function(){

    pushMatrix();
    rotate(cos(frameCount*1.5)*3);

    stroke(20, 40, 255);
    strokeWeight(10);
    fill(237, 225, 0);
    rect(-100,-40,200,80,2);
    strokeWeight(5);
    fill(186, 186, 186);
    rect(-40,-20,80,40,20);
    noStroke();
    var a = 0+(tutorial.anim/360);
    if(tutorial.on){
    a = 1-(tutorial.anim/360);
    }
    fill(240*(1-a), 240*a, 40);
    rect(-38+(38+4)*(a),-18,36,36,20);
    strokeWeight(5);
    stroke(20, 40, 255);
    noFill();
    rect(-40,-20,80,40,20);

    popMatrix();

};

var tutorial;

var tNextButton = new button(400,520,function(){
    tutorial.buttonFunctions[tutorial.num]();
});
tNextButton.toPop = 1.2;
tNextButton.popSpeed = 2;
tNextButton.hitbox = function(x,y){
    if(msX > x-80 && msX < x+80 && msY > y-20 && msY < y+20){
        return true;
    }else{
        return false;
    }
};
tNextButton.graphic = function(){

    pushMatrix();

    rotate(cos(frameCount*1.5)*3);
    stroke(0,0,0);
    strokeWeight(5);
    fill(217, 217, 217);
    rect(-80,-20,160,40,10);
    fill(0,0,0);
    textSize(20);
    textAlign(CENTER,CENTER);
    text('Next',0,0);
    popMatrix();



};
tNextButton.altClick = function(){
if(tutorial.clicked){
return true;
}
return false;
};

var ackstring = '101010101010101010101010101010';

function trainerImg(){
pushMatrix();
    translate(400,400);
    scale(2);
    scale(-1,1);
    if(tutorial.timer <= 200){
        scale(1+sin(tutorial.timer*((180*10)/200))*0.1,1);
    }
    translate(0,25);
        rotate(-10+cos(frameCount*1.5)*2);
    translate(0,-25);
    //{

bases.chicken();
pushMatrix();
scale(1.5);
translate(-18,-20);
rotate(-9);
stroke(0,0,0);
strokeWeight(3);


fill(255, 36, 36);
rect(0,0,30,14,4);
arc(15.5,4,30,15,180,360);

fill(247, 247, 247);
strokeWeight(1);
arc(24,11,15,15,162,360);
fill(255, 36, 36);
noStroke();
arc(24,11,8,8,162,360);

stroke(0,0,0);
strokeWeight(2);
fill(247, 247, 247);
rect(18,10.5,25,4,4);

popMatrix();
noStroke();
fill(255, 255, 255);
ellipse(-10,2,15,15);

fill(0,0,0);
ellipse(-2,1,5,10);
fill(245, 245, 245);
//ellipse(-1,-1,1.5,3);

stroke(0,0,0);
strokeWeight(5);
line(-12,-7,1,-4);
strokeWeight(1);
line(-10,9,-14,4);
line(-11,-8,-14,4);
strokeWeight(2);
line(-12,9,1,7);
line(-12,12,1,8);

pushMatrix();
translate(-27,14);
scale(1.2);
rotate(-27);
strokeWeight(2);
stroke(0,0,0);
fill(245, 245, 245);
ellipse(0,0,20,20);
fill(255, 0, 0);
arc(0,0,20,20,180,360);
strokeWeight(2);
line(-9,0,9,0);
fill(209, 209, 209);
ellipse(0,0,6,6);
popMatrix();

    //}
    popMatrix();
}

var tutorial = {
on:false,
num:0,
active:false,
clicked:false,
anim:0,
timer:0,
scenes:[
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Welcome to Super\nChicken Game!\n\nAs trainer chicken, it\nis my job to teach you\nhow to play the game.\n\nIf you already know how,\nyou can turn the tutorial\noff in the settings.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,120);

    tNextButton.draw();
    },
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();
    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,30,250,340,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,30,250,340,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Super Chicken Game\nis a rougelite and turn\nbased auto-battler\nvery roughly based off\nof Super Auto Pets\nby teamwood games.\nIn this game you will\nassemble a team of\nchickens and contraptions\nin order to win fights\nagainst teams made by\nother players.\nWin ten battles to win\na run!';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,60);
    pushMatrix();
    translate(450,160);
    var a = tutorial.timer;
    if(a > 180){
    a = 180;
    textAlign(CENTER,CENTER);
    fill(255, 196, 0);
    var a2 = 50*(1/((tutorial.timer-180)*0.2));
    if(a2 > 50){
    a2 = 50;
    }
    textSize(50-a2);
    text('10',0,0);
    }
    for(var i = 0; i < a*2-35; i+=360/10){
    pushMatrix();
    rotate(i+tutorial.timer/6);
    trophy(0,-80+cos(frameCount+i*255)*3,1.6);
    popMatrix();
    }
    popMatrix();

    tNextButton.draw();
    },
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();
    {
    pushMatrix();
    translate(450,120);
    scale(1-(1/((tutorial.timer*0.1)+1)));
    scale(0.7);
    stroke(0,0,0);
    strokeWeight(5);
    fill(102, 46, 8);
    rect(-110,-70,220,145,5);
    strokeWeight(5);
    stroke(0, 0, 0);
    fill(255, 56, 56);
    quad(-130,-70,130,-70,105,-105,-105,-110);
    fill(255, 153, 0);
    ellipse(-90,-90,25,25);
    for(var q = 0; q < 2; q++){
    for(var i = -1; i < 2; i++){
    if(q === 1 && i <= 0){
    pushMatrix();
    translate(i*200/3,-30+q*65);
    bases.chicken();
    popMatrix();
    }
    nest(i*200/3,-30+q*65);
    }
    }
    popMatrix();
    pushMatrix();
    translate(520,220);
    scale(1-(1/((tutorial.timer*0.1)+1)));
    strokeWeight(5);
    stroke(0,0,0);
    fill(153, 153, 153);
    rect(-20,-20,40,40,5);
    fill(0,0,0);
    noStroke();
    ellipse(15,0,15,15);
    stroke(0,0,0);
    strokeWeight(2);
    fill(0, 130, 7);
    rect(13,-3,20,6,3);
    popMatrix();
    attack(360,220,0.2*(1-(1/((tutorial.timer*0.1)+1))));
    heart(400,240,0.16*(1-(1/((tutorial.timer*0.1)+1))));
    pushMatrix();
    pushMatrix();
    translate(460,220);
    scale(1-(1/((tutorial.timer*0.1)+1)));
    {
    translate(0,10);
    rotate(-45);
    translate(0,-10);
    strokeWeight(4);
    stroke(0,0,0);
    fill(186, 153, 93);
    rect(-30,-5,74,15,10);
    strokeWeight(4);
    stroke(69, 47, 12);
    var max = 7;
    for(var i = 1; i < max; i++){
    var x = (7)+i*10-(max/2)*10;
    line(x-2,6,x+2,0);
    }
    popMatrix();
    }
    popMatrix();
    }
    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,30,250,340,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,30,250,340,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(14);
    var a = 'A team consists of 1-3\nchicken coops, each\nfilled with up to 6\nchickens, and any number\nof contraptions\nChickens and contraptions\ncan be purchased from the\nshop for gold (usually 3).\nYou get 14 gold to spend\neach turn.\nFood can also be bought,\nwhich is used to make\nchickens stronger.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,60);

    if(tutorial.timer > 170){
    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    fill(255, 31, 31);
    rect(160,350,30,120,4);
    triangle(175,500,140,450,210,450);
    noStroke();
    fill(255, 31, 31);
    rect(160,350,30,120,4);
    triangle(175,500,140,450,210,450);
    coin(175,370,2,'14');
    }
    if(tutorial.timer > 50){
    stroke(0,0,0);
    strokeWeight(14);
    rect(285,100,50,30,4);
    triangle(365,115,325,150,325,80);
    noStroke();
    fill(255, 31, 31);
    rect(285,100,50,30,4);
    triangle(365,115,325,150,325,80);
    }
    tNextButton.draw();
    },
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Let\'s begin by\nbuying a chicken.\n\nDrag a chicken from the\nshop to an empty coop\nspot to buy it.\nIf the shop has no\nchickens you want, you\ncan reroll it for 1 gold\nby pressing "Roll"';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,130);

    tNextButton.draw();
    },
    function(){},
    function(){tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Nice!\n'+tutorial.boughtchickenname+'\nwas a very wise purchase.\n\nA chicken has four\nimportant stats:\nType,\nAttack,\nHealth,\nand XP (experience)';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,120);

    tNextButton.draw();},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(14);
    var a = 'Each chicken type will\nhave a unique ability.\nYou can see a chicken\'s\nability by hovering over\nit with your mouse.\nIf you drag a chicken of\nthe same type onto another,\nthey will combine into a\nchicken with +1 XP.\nGet enough XP and a chicken\nwill level up (up to lvl 3).\nHigher level chickens will\nhave better abilities.\nMerging also gives +1/+1.\n(+1 attack and +1 health)';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,55);
    pushMatrix();
    translate(445,180);
    scale(1-1/(tutorial.timer/10+1));
    translate(-445,-180);
    pushMatrix();
    translate(380,130);
    {
    bases.chicken();
    attack(-18,-16,0.14*1.1);
    heart(20,-20,0.1*1.1);
    noStroke();
    fill(163, 163, 163,100);
    rect(-16,-34,30,8,7);
    noStroke();
    fill(255, 0, 183,150);
    rect(-16,-34,0,8,7);
    stroke(66, 66, 66,200);
    strokeWeight(2);
    noFill();
    rect(-16,-34,30,8,7);
    textSize(10);
    textAlign(CENTER,BASELINE);
    fill(0,0,0);
    text('3',20,-19);
    text('2',-20,-19);
    }
    popMatrix();
    pushMatrix();
    translate(510,130);
    {
    bases.chicken();
    attack(-18,-16,0.14*1.1);
    heart(20,-20,0.1*1.1);
    noStroke();
    fill(163, 163, 163,100);
    rect(-16,-34,30,8,7);
    noStroke();
    fill(255, 0, 183,150);
    rect(-16,-34,0,8,7);
    stroke(66, 66, 66,200);
    strokeWeight(2);
    noFill();
    rect(-16,-34,30,8,7);
    textSize(10);
    textAlign(CENTER,BASELINE);
    fill(0,0,0);
    text('2',20,-19);
    text('1',-20,-19);
    }
    popMatrix();
    pushMatrix();
    translate(460,230);
    {
    bases.chicken();
    attack(-18,-16,0.14*1.1);
    heart(20,-20,0.1*1.1);
    noStroke();
    fill(163, 163, 163,100);
    rect(-16,-34,30,8,7);
    noStroke();
    fill(255, 0, 183,150);
    rect(-16,-34,30/2,8,7);
    stroke(66, 66, 66,200);
    strokeWeight(2);
    noFill();
    rect(-16,-34,30,8,7);
    textSize(10);
    textAlign(CENTER,BASELINE);
    fill(0,0,0);
    text('4',20,-19);
    text('3',-20,-19);
    }
    popMatrix();
    fill(255, 0, 221);
    textSize(78);
    textAlign(CENTER,CENTER);
    text('+',445,130);
    text('=',390,230);
    popMatrix();


    tNextButton.draw();
    },
    function(){ tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Merging a chicken also\ngives you power.\n\nThis is shown by the power\nmeter in the top right.\n\nFill the power meter and\nyou will be rewarded\nwith another coop!\nYou can have up to 3.\n\nGetting another coop is\nvery good, as you can\nhouse 6 more chickens.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,60);
    pushMatrix();
    translate(380,160);
    scale(2.2);
    scale(1-1/(1+tutorial.timer/10));
    noStroke();
fill(79, 79, 79,150);
rect(-10,-10,80,23,5);
noStroke();

fill(0, 217, 18,150);
rect(-10,-10,5*(80/15),23,5);

for(var i = 1; i < 15; i++){
strokeWeight(1);
stroke(0,0,0,50);
line(-10+i*(80/(15)),-9,-10+i*(80/(15)),12);
}
noFill();
strokeWeight(3);
stroke(0,0,0);
rect(-10,-10,80,23,5);
fill(0,0,0);
textSize(8);
textAlign(CENTER,BASELINE);
text('Merge Power:\n'+5+'/'+15,30,-1);
    popMatrix();

    tNextButton.draw();},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,40,250,330,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(13);
    var a = 'The main stats of a chicken\nare attack and health\n(shown by egg and heart).\nThey can range from 1-99.\n\nWhen you end your turn, your\nteam will fight another.\nChickens will throw eggs\nand deal their attack damage\nto another chicken\'s health.\n\nWhen a chicken has no health,\nit faints. Don\'t worry,\nEVERYTHING\nthat happens in a battle is\ntemporary (except for\nwin/loss)';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,56);
    pushMatrix();
    pushMatrix();
    translate(430,180);
    scale(2);
    scale(1-1/(1+tutorial.timer/10));
    {
    var a = abs(cos(tutorial.timer));
    bases.chicken();
    attack(-18,-16,0.14*1.1);
    dynaHeart(20,-20,0.1*1.1,255,a);
    noStroke();
    fill(163, 163, 163,100);
    rect(-16,-34,30,8,7);
    noStroke();
    fill(255, 0, 183,150);
    rect(-16,-34,0,8,7);
    stroke(66, 66, 66,200);
    strokeWeight(2);
    noFill();
    rect(-16,-34,30,8,7);
    textSize(10);
    textAlign(CENTER,BASELINE);
    fill(0,0,0);
    text(round(a*10),20,-19);
    text('4',-20,-19);
    }
    popMatrix();
    popMatrix();

    tNextButton.draw();
    },
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'You can improve these\nstats with abilities\nor food.\nFood is found in shop\npages 2 and 3.\n\nNavigate to shop page 2,\nthen drag an apple to a\nchicken in your coop\nto feed it.\n';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,130);

    pushMatrix();
    translate(430,120);
    scale(1.2);
    scale(1-1/(1+tutorial.timer/10));
    {
    strokeWeight(8);
    stroke(0,0,0);
    fill(247, 37, 37);
    ellipse(0,0,60,60);
    stroke(102, 61, 10);
    line(5,-20,20,-35);
    noStroke();
    fill(15, 135, 4);
    ellipse(0,-25,15,24);
    }
    popMatrix();
    pushMatrix();
    translate(430,220);
    scale(1.2);
    scale(1-1/(1+tutorial.timer/10));
    stroke(0,0,0);
    strokeWeight(5);
    fill(194, 194, 194);
    rect(-45,-15,90,30,5);
    textSize(14);
    fill(0,0,0);
    textAlign(CENTER,BASELINE);
    text("Page: "+(2)+"/"+3,0,5);
    popMatrix();

    tNextButton.draw();
    },
    function(){},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Nice!\nLet\'s finish the turn.\n\nSpend ALL of your gold,\nthen press the\nFight\n button in the top right\nto go battle.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,130);

    pushMatrix();

    popMatrix();

    tNextButton.draw();
    },
    function(){},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = '';
    if(tutorial.battleresults === true){
    a += 'Congrats on the win!\nYou got a trophy!';
    }
    if(tutorial.battleresults === 'tie'){
    a += 'Well, a tie is fine.\nYou\'re still in it!';
    }
    if(tutorial.battleresults === false){
    a += 'Nice try,\nYou\'ll get em next time!';
    }
    a +='\n\nEvery time you win you\nget 1 trophy.\nTo win a run, you need\nto get 10 trophies.\nEvery time you lose, you\nlose 1 heart.\nLose all 5 hearts and the\nrun will be over.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,130);

    pushMatrix();

    popMatrix();

    tNextButton.draw();
    },
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,60,250,310,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,60,250,310,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Let\'s buy a contraption.\n\nContraptions can be found\nin shop page 2 and 3.\n\nDrag a contraption to\nanywhere above the shop\nto buy it!\n\nContraptions will lose\n1 durability per turn.\nWhen it has no durability,\nit will be destroyed.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,80);

    pushMatrix();
    translate(430,120);
    scale(2);
    scale(1-1/(1+tutorial.timer/10));
    {
    strokeWeight(5);
    stroke(0,0,0);
    fill(153, 153, 153);
    rect(-20,-20,40,40,5);
    fill(0,0,0);
    noStroke();
    ellipse(15,0,15,15);
    stroke(0,0,0);
    strokeWeight(2);
    fill(0, 130, 7);
    rect(13,-3,20,6,3);
    }
    popMatrix();
    pushMatrix();
    translate(430,220);
    scale(1.2);
    scale(1-1/(1+tutorial.timer/10));
    stroke(0,0,0);
    strokeWeight(5);
    fill(194, 194, 194);
    rect(-45,-15,90,30,5);
    textSize(14);
    fill(0,0,0);
    textAlign(CENTER,BASELINE);
    text("Page: "+(2)+"/"+3,0,5);
    popMatrix();

    tNextButton.draw();
    },
    function(){},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,60,250,310,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,60,250,310,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Nice!\n\nAs you may have noticed,\nyou can drag around all\nyour stuff to arrange\nyour team as you wish.\n\nYou can also get rid of\nstuff you don\'t want for\n a profit. Drag stuff\nto the trash in the top\nleft to sell it for gold\nequal to its level.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,80);

    pushMatrix();
    translate(370,40);
    scale(2);
    scale(1-1/(1+tutorial.timer/10));
    stroke(0,0,0);
    strokeWeight(5);
    fill(135, 135, 135);
    pushMatrix();
    //point(0,0);
    translate(0,40);
    translate(0,-40);
    arc(35,40,50,30,180,360);
    line(10,40,60,40);
    ellipse(35,25,12,10);
    popMatrix();
    rect(10,40,50,60,5);
    stroke(0,0,0,50);
    for(var i = 1; i < 3; i++){
        line(10+i*(50/3),55,10+i*(50/3),85);
    }
    fill(0,0,0);
    textAlign(CENTER,CENTER);
    textSize(12);
    text('Trash',35,65);

    popMatrix();

    tNextButton.draw();
    },
    function(){},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Nice!\nLet\'s finish the turn.\nMake sure to spend all\nof your gold!\nIf you have just a few\ngold left over, you can\nroll and save things for\nlater by clicking the\nfreeze button that pops\nup when you hold a shop\nitem.';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,120);

    pushMatrix();

    translate(450,200);
    scale(1.5);
    scale(1-1/(1+tutorial.timer/10));
    translate(-415,-480);
    stroke(0,0,0);
    strokeWeight(5);
    fill(25, 171, 176);
    rect(350,460,130,30,5);
    fill(0,0,0);
    textSize(14);
    textAlign(CENTER,BASELINE);
    text("Freeze Slot",415,480);
    popMatrix();

    tNextButton.draw();
    },
    function(){},
    function(){
    tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,50,250,320,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,50,250,320,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(14);
    var a = '';
    if(tutorial.battleresults === true){
    a += 'Congrats on the win!\nYou got a trophy!';
    }
    if(tutorial.battleresults === 'tie'){
    a += 'Well, a tie is fine.\nYou\'re still in it!';
    }
    if(tutorial.battleresults === false){
    a += 'Nice try,\nYou\'ll get em next time!';
    }
    a +='\n\nOne more thing:\nChickens are divided into\n6 tiers. Higher tier chickens\nare often much better.\nYou will unlock another tier\n(chickens of that tier will\nbegin appearing in the shop)\nevery odd turn number.\nTiers are shown by dice.\nA big part of the game is\nknowing when to switch to\nhigher tier chickens!';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,63);

    pushMatrix();
    translate(380,50);
    scale(2);
    scale(1-1/(1+tutorial.timer/10));
    textSize(12);
    textAlign(CENTER,CENTER);
    for(var i = 0; i < 6; i++){
    dice(0,i*20,i+1);
    fill(0,0,0);
    text('Turn '+((i*2)+1),50,i*20);
    }
    popMatrix();

    tNextButton.draw();
    },
    function(){
tutorial.timer++;
    if(tutorial.clicked){
    tutorial.timer = 1000;
    }
    noStroke();
    fill(89, 89, 89, 150);
    rect(-100,-100,800,800);
    trainerImg();

    stroke(0,0,0);
    strokeWeight(14);
    fill(0, 0, 0);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    noStroke();
    fill(224, 224, 224);
    rect(50,100,250,270,40);
    triangle(250,370,300,320,314,385);
    textAlign(CENTER,TOP);
    fill(0,0,0);
    textSize(15);
    var a = 'Well, that\'s it for\nthe tutorial!\n\nThere\'s still much more\nfor you to learn, but as\nfor the basics, if you\'ve\nbeen listening, that\'s\neverything!\n\nGood luck,\n'+tNames[0]+'!';
    text(a.substring(0,(a.length/200)*(tutorial.timer)),175,120);

    pushMatrix();
    popMatrix();

    tNextButton.draw();
    },
    ],
buttonFunctions:[
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    //xp
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
        tutorial.active = false;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        tutorial.num++;
        tutorial.timer = 0;
    },
    function(){
        //end
        tutorial.active = false;
        tutorial.num = 0;
        tutorial.timer = 0;
        tutorial.on = false;
    },

    ],
};

function charButton(x,y,a,w){
stroke(0,0,0);
strokeWeight(5);
fill(222, 222, 222);
var pop = 1;
var d = dist(msX,msY,x,y);
if(d < 30){
d = 30;
}
pop += (0.24)/(d/30);
if(!w){
w = 40;
}
rect(x-(w*pop)/2,y-(36*pop)/2,w*pop,36*pop,5);
fill(0,0,0);
textAlign(CENTER,CENTER);
textSize(25);
var a2 = a;
if(keyboardCase && keyboardChars.indexOf(a) >= 0){
a2 = a.toUpperCase();
}
text(a2,x,y);
if(msX >= x-(w*pop/2) && msX <= x+(w*pop/2) && msY >= y-22 && msY <= y+22){
cursor(HAND);
if(clicked){
if(a === 'space'){
tNames[0] += ' ';
}else if(a === 'del.'){
if(tNames[0].length > 0){
tNames[0] = tNames[0].substring(0,tNames[0].length-1);
}
}else if(a === 'CASE'){
keyboardCase = !keyboardCase;
}else if(a === '#/a'){
if(keyboardChars === 'qwertyuiopasdfghjklzxcvbnm'){
keyboardChars = '1234567890!@$%^&*()`<>?./;';
}else if(keyboardChars === '1234567890!@$%^&*()`<>?./;'){
keyboardChars = ':"{}[]-=_+';
}else{
keyboardChars = 'qwertyuiopasdfghjklzxcvbnm';
}
}else{
if(tNames[0].length < 20){
tNames[0] += a2;
}
}
}
}
}

var dictAnim = 0;
var dictPops = [];
var logoAnim = 0;
var doThumbnail = false;

var homeChickens = [];


var thingImgDataLogs = {};
function thingImg(type, id){
    var typeData = types[type];
    var data = typeData[0];
    for(var i = 0; i < typeData.length; i++){
        if(typeData[i].name === id){
    data = typeData[i];
            i = typeData.length;
        }
    }
    if(!thingImgDataLogs[id]){
        thingImgDataLogs[id] = {id:20,};
    }
    if(data.loadImgBehind){
    data.loadImgBehind(thingImgDataLogs[id]);
    }
    if(!data.noBase){
    bases[type]();
    }
    if(data.loadImg){
    data.loadImg(thingImgDataLogs[id]);
    }
    if(data.animImg){
    data.animImg(thingImgDataLogs[id]);
    }
}


//newGame();
//record[0]= 9;
//initFight();
// scene = 'settings';
// settingFromGame = true;

//frameRate(1000);
function draw(){
try {
dimMouse();

var interacting = false;
clicked = false;
if(held === true){
clicked = true;
}
notHeldCount++;

if(mouseIsPressed){
// if(held === false){
// mouseMoved = false;
// m.downPos = {x:msX,y:msY};
// }
notHeldCount = 0;
held = true;
}else{
held = false;
}


if(held === false && clicked === true){
clicked = true;
}else{
clicked = false;
}


if(dim.cur){
clicked = false;
held = false;
}

if(tutorial.active && scene === 'game'){
    clicked = false;
    held = false;
}

cursor(ARROW);
pushMatrix();
translate(dimScroll.x,dimScroll.y);

if(didMouseMove()){
    mouseMoved = true;
}


//scene = 'home';
switch(scene){
case 'home':
{
if(clicked && mouseX <=1 && mouseY <=1){
    doThumbnail = true;
    clicked = false;
}
background(102, 255, 212);
if(homeTrans >= 50){
for(var i = 0; i < 8; i++){
noStroke();
fill(102, 255-i*10, 212);
var w = 600-i*77+cos(frameCount*3)*(10-i)*2;
ellipse(300,150,w,w);
}

for(var i = 0; i < 40; i+=10){
noStroke();
fill(255, 38, 38,100);
beginShape();
vertex(-100,30+cos(frameCount*7+180)*6+i);
vertex(-100,90+cos(frameCount*7)*6+i);
vertex(700,90+cos(frameCount*7+90)*6+i);
vertex(700,30+cos(frameCount*7+270)*6+i);
endShape();
}

pushMatrix();
translate(310,180);
rotate(cos(frameCount*1.5)*-5);
scale(0.8);
var rSpeed = 3;
// {
stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(frameCount*rSpeed+n)*30;
if(cos(frameCount*rSpeed+n) <= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}

noStroke();
fill(255, 149, 0);
beginShape();
vertex(-405,180+sin(frameCount*5)*40);
curveVertex(-190,0);
vertex(-290+cos(frameCount*10)*10,0);
endShape(CLOSE);
beginShape();
vertex(-405,-180-sin(frameCount*5)*40);
curveVertex(-190,0);
vertex(-290+cos(frameCount*10)*10,0);
endShape(CLOSE);
stroke(255, 149, 0);
strokeWeight(2);
line(-190,0,-284+cos(frameCount*10)*10,0);

noStroke();
fill(255, 217, 0);
beginShape();
vertex(-405,60+sin(frameCount*5+40)*20);
curveVertex(-190,0);
vertex(-260+cos(frameCount*10+40)*10,0);
endShape(CLOSE);
beginShape();
vertex(-405,-60-sin(frameCount*5+40)*20);
curveVertex(-190,0);
vertex(-260+cos(frameCount*10+40)*10,0);
endShape(CLOSE);
stroke(255, 217, 0);
strokeWeight(2);
line(-190,0,-250+cos(frameCount*10+40)*10,0);

stroke(0,0,0);
fill(235, 235, 235);
strokeWeight(10);
rect(-190,-30,306,60,5);
noStroke();
var h = 30;
for(var i = 0; i < 6; i++){
var n = i*(360/6);
var r = sin(frameCount*rSpeed+n)*30;
if(cos(frameCount*rSpeed+n+h) >= 0){
if(i/2 === round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(14+30,r,25,cos(frameCount*rSpeed+n+h)*h,5);
if(i/2 !== round(i/2)){
fill(255, 255, 255);
}else{
fill(0,0,0);
}
rect(25,r,25,cos(frameCount*rSpeed+n+h)*h,5);
}
}




stroke(0,0,0);
noFill();
strokeWeight(10);
rect(-190,-30,306,60,5);
fill(255, 0, 21);
triangle(200,0,100,-50,100,50);
fill(212, 212, 212,120);
noStroke();
pushMatrix();
translate(135,-19);
rotate(25);
ellipse(0,0,57,9);
popMatrix();

stroke(0,0,0);
strokeWeight(10);
fill(227, 54, 66);
for(var i = 0; i < 3; i++){
var n = i*(360/3);
var r = sin(frameCount*rSpeed+n)*30;
if(abs(r) < 0.0001){
r = 0.0001;
}
if(cos(frameCount*rSpeed+n) >= 0){
triangle(-107,0+r, -170,r*2.3, -170,0+r);
}
}
//triangle(-170, 56, -170, 25,-107, 25);
//noStroke();
strokeWeight(7);
rect(-194,-35,10,70,5);
rect(-22,-35,10,70,5);
// }
stroke(0, 0, 0);
fill(173, 111, 57);
strokeWeight(8);
rect(-90,-40,130,80,4);
strokeWeight(25);
noFill();
stroke(84, 0, 0);
pushMatrix();
translate(-126,-94);
scale(0.55);
// {
pushMatrix();
translate(86,102);
scale(0.4);
beginShape();
    curveVertex(173,158);
    curveVertex(50,64);
    curveVertex(2,100);
    curveVertex(50,142);
    curveVertex(232,145);
endShape();
popMatrix();
pushMatrix();
translate(119,131);
scale(0.4);
line(0,0,2,70);
line(48,0,50,70);
line(0,35,50,40);
popMatrix();
pushMatrix();
translate(150,131);
scale(0.4);
line(50,0,0,2);
line(50,70,0,70);
line(24,0,25,70);
popMatrix();
pushMatrix();
translate(177,105);
scale(0.4);
beginShape();
    curveVertex(173,220);
    curveVertex(50,65);
    curveVertex(4,107);
    curveVertex(53,130);
    curveVertex(288,59);
endShape();
popMatrix();
pushMatrix();
translate(208,131);
scale(0.4);
line(0,0,2,71);
line(0,35,40,4);
line(0,39,40,67);
popMatrix();
pushMatrix();
translate(234,131);
scale(0.4);
line(0,0,2,70);
line(0,35,38,33);
line(0,0,42,-3);
line(0,68,42,68);
popMatrix();
pushMatrix();
translate(261,131);
scale(0.4);
line(0,0,2,70);
line(48,0,50,70);
line(0,0,50,68);
popMatrix();
// }
popMatrix();
pushMatrix();
translate(-123,-44);
scale(0.55);
// {
pushMatrix();
translate(114,98);
strokeWeight(25*(0.4/0.12));
scale(0.13);
beginShape();
    curveVertex(216,125);
    curveVertex(157,-15);
    curveVertex(8,18);
    curveVertex(-16,221);
    curveVertex(172,253);
    curveVertex(222,150);
    curveVertex(95,152);
    curveVertex(242,235);
endShape();
popMatrix();
strokeWeight(25);
pushMatrix();
translate(155,100);
scale(0.4);
line(0,75,28,-5);
line(56,78,28,-5);
line(0,55,56,55);
popMatrix();
pushMatrix();
translate(189,100);
scale(0.4);
line(0,75,14,0);
line(38,75,14,0);
line(38,75,64,0);
line(81,75,64,0);
popMatrix();
pushMatrix();
translate(234,103);
scale(0.4);
line(0,-5,0,70);
line(-4,35,38,33);
line(0,-5,42,-3);
line(0,70,42,68);
popMatrix();
// }

popMatrix();
popMatrix();



pushMatrix();
translate(79,-2);
translate(200,50);
rotate(cos(frameCount*1.5)*5);
translate(-200,-50);
scale(0.8);
// {
stroke(0,0,0);
strokeWeight(25);
fill(255, 64, 64);
pushMatrix();
translate(42,32);
scale(0.4);
beginShape();
    curveVertex(93,61);
    curveVertex(158,-9);
    curveVertex(107,-31);
    curveVertex(63,-21);
    curveVertex(-2,31);
    curveVertex(20,133);
    curveVertex(120,125);
    curveVertex(147,171);
    curveVertex(119,209);
    curveVertex(61,216);
    curveVertex(0,195);
    curveVertex(-5,265);
    curveVertex(77,271);
    curveVertex(159,248);
    curveVertex(204,177);
    curveVertex(168,91);
    curveVertex(119,69);
    curveVertex(65,77);
    curveVertex(84,33);
    curveVertex(154,20);
    curveVertex(159,-8);
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(141,48);
scale(0.4);
beginShape();
    curveVertex(56,-14);
    curveVertex(11,-16);
    curveVertex(-16,68);
    curveVertex(-4,186);
    curveVertex(45,236);
    curveVertex(111,247);
    curveVertex(172,220);
    curveVertex(201,130);
    curveVertex(200,25);
    curveVertex(178,-19);
    curveVertex(145,6);
    curveVertex(145,77);
    curveVertex(132,164);
    curveVertex(99,190);
    curveVertex(64,168);
    curveVertex(52,72);
    curveVertex(52,8);
    curveVertex(46,-14);
    curveVertex(32,-17);
    curveVertex(16,-16);
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(240,59);
scale(0.4);
beginShape();
    curveVertex(45,123);
    curveVertex(9,62);
    curveVertex(27,224);
    curveVertex(70,241);
    curveVertex(96,212);
    curveVertex(81,107);
    curveVertex(172,76);
    curveVertex(184,0);
    curveVertex(121,-49);
    curveVertex(12,-45);
    curveVertex(8,64);
    curveVertex(9,48);
endShape();
popMatrix();
pushMatrix();
translate(332,61);
scale(0.4);
beginShape();
    curveVertex(33,84);
    curveVertex(0,-1);
    curveVertex(15,202);
    curveVertex(147,214);
    curveVertex(150,169);
    curveVertex(76,175);
    curveVertex(66,133);
    curveVertex(144,126);
    curveVertex(141,87);
    curveVertex(61,75);
    curveVertex(55,31);
    curveVertex(163,28);
    curveVertex(153,-24);
    curveVertex(-1,-3);
    curveVertex(-74,162);
endShape();
popMatrix();
pushMatrix();
translate(445,60);
scale(0.4);
beginShape();
    curveVertex(231,48);
    curveVertex(-44,-35);
    curveVertex(-46,208);
    curveVertex(20,234);
    curveVertex(24,135);
    curveVertex(119,216);
    curveVertex(173,192);
    curveVertex(89,99);
    curveVertex(131,44);
    curveVertex(117,-25);
    curveVertex(48,-41);
    curveVertex(-44,-34);
endShape(CLOSE);
popMatrix();

noFill();
strokeWeight(25*0.4);
ellipse(277,68,23,15);
ellipse(455,76,23,20);
// }
popMatrix();

stroke(0,0,0);
strokeWeight(8);
fill(28, 232, 89);
rect(-100,320,800,400);
noStroke();
for(var i = 0; i < 10; i++){
fill(28, 232-i*10, 89,80);
rect(-100,320+i*30+cos(frameCount*1.5)*10,800,400);
}
stroke(0,0,0);
strokeWeight(8);
noFill();
rect(-100,320,800,400);

for(var i = 0; i < 8; i++){
pushMatrix();
var x = (frameCount+100*i)%800+cos(frameCount*6)*6-100;
if(!homeChickens[i]){
homeChickens.push([x,floor(random(0,types.chicken.length))]);
}else{
if(homeChickens[i][0] > x+600){
homeChickens[i][1] = floor(random(0,types.chicken.length));
}
homeChickens[i][0] = x;
}
translate(x,330-abs(cos(frameCount*3)*30));
rotate(cos(frameCount*6+90)*15);
pushMatrix();
var a = types.chicken[homeChickens[i][1]];

        pushMatrix();
            scale(1);
            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();

popMatrix();
popMatrix();
}


noStroke();
fill(0, 255, 208,200);
var w = 185+cos(frameCount*3)*20;
ellipse(300,380,w,w);

playButton.draw();
helpButton.draw();
settingsButton.draw();
dictButton.draw();

pushMatrix();
translate(550,550);
if(dist(msX,msY,570,570)<=20){
logoAnim = lerp(logoAnim,1,0.1);
cursor(HAND);
if(clicked){
homeTrans = 0;
tSet = [];
scene = 'credits';
//println('made by ackvonhey August 2023 - Present\nliterally zero rights reserved but please dont plagiarise');
}
}else{
logoAnim = lerp(logoAnim,0,0.1);
}
translate(30,30);
scale(1+logoAnim*0.1);
translate(-30,-30);
scale(0.1);
// {
stroke(0,0,0);
strokeWeight(20);
//noStroke();
var c = 290;
var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a52 = 1.15;
var a5 = c*a52;//206
if(a5 > 206){
a5 = 206;
}
var a6 = 117;
var a62 = -117+(c*a52)-206;//-117
if(a62 < -117){
    a62 = -117;
}
if(a62 > 0){
    a62 = 0;
}

fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape(CLOSE);
beginShape();
vertex(0-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape(CLOSE);
fill(60,60,60);
var a72 = 0.985;
var a7 = c*a72;//215
if(a7 > 215){
    a7 = 215;
}
beginShape();
vertex(0-37/2, 200);
vertex(0+37/2, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape(CLOSE);
var a8 = 319;
var a82 = 81-(c*a72)+215;
if(a82 > 81){
    a82 = 81;
}
if(a82 < 37/2){
    a82 = 37/2;
}
beginShape();
vertex(400-a82, 200);
var a822 = 400-a82+37;
if(a822 > 400+37/2){
a822 = 400+37/2;
}
vertex(a822, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape(CLOSE);
//rect(0, 200,400, 80);

fill(120,120,120);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
var a22 = c;
var a23 = 240+cos(a+180)*(a22+100);
var a24 = 55+sin(a+180)*(a22+100);
if(a23 >= 400){
    a23 = 400;
    a24 = 400;
}
var a25 = 320+cos(a)*a2+cos(a+180)*a22;
var a26 = 400+sin(a)*a2+sin(a+180)*a22;
if(a25 > 320){
    a25 = 320;
    a26 = 400;
}
vertex(a23,a24);
vertex(a25,a26);
endShape(CLOSE);
//}
popMatrix();

}

if(scene !== 'home'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'name':
{
background(102, 255, 212);
if(homeTrans >= 50){
for(var i = 0; i < 8; i++){
noStroke();
fill(102, 255-i*10, 212);
var w = 600-i*77+cos(frameCount*3)*(10-i)*2;
ellipse(300,150,w,w);
}



stroke(0,0,0);
strokeWeight(8);
fill(28, 232, 89);
rect(-100,320,800,400);
noStroke();
for(var i = 0; i < 10; i++){
fill(28, 232-i*10, 89,80);
rect(-100,320+i*30+cos(frameCount*1.5)*10,800,400);
}
stroke(0,0,0);
strokeWeight(8);
noFill();
rect(-100,320,800,400);




for(var i = 0; i < 10; i++){
var a = 55;
charButton(300-(a*4.5)+i*a,350,keyboardChars[i]);
}
for(var i = 10; i < 19; i++){
if(keyboardChars[i]){
var a = 55;
charButton(300-(a*4)+(i-10)*a,400,keyboardChars[i]);
}
}
for(var i = 19; i < 26; i++){
if(keyboardChars[i]){
var a = 55;
charButton(300-(a*3)+(i-19)*a,450,keyboardChars[i]);
}
}
//if(keyboardChars === 'qwertyuiopasdfghjklzxcvbnm'){
charButton(60,450,'CASE',70);
//}
charButton(250,500,'space',120);
charButton(370,500,'#/a',65);
charButton(540,450,'del.',70);
        if(pushedKey){
           // 65535
          var allowed = ' qwertyuiopasdfghjklzxcvbnm1234567890!@$%^&*()`<>?./;:"{}[]-=_+';
          if(parseInt(pushedKey,1) === 8){
          tNames[0] = tNames[0].substring(0,tNames[0].length-1);
          }else if(allowed.includes(pushedKey.toString())){
          if(tNames[0].length < 20){
          if(keyboardCase === true){
          tNames[0] += (pushedKey.toString()).toUpperCase();
          }else{
          tNames[0] += pushedKey.toString();
          }
          }
          }
      }

      fill(0,0,0);
      textAlign(CENTER,CENTER);
      textSize(25);
      text('Enter Name: '+tNames[0],300,270);


noStroke();

backButton.draw();
playButton2.draw();

}

if(scene !== 'name'){
homeTrans = 0;
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'dict':
{
background(102, 255, 212);
if(homeTrans >= 50){
for(var i = 0; i < 8; i++){
noStroke();
fill(102, 255-i*10, 212);
var w = 850-i*111+cos(frameCount*3)*(10-i)*2;
ellipse(300,300,w,w);
}

var isHover = false;
var dictThing = false;

for(var i = 0; i < 6; i++){
if(!dictPops[i]){
dictPops.push([]);
}

fill(0,0,0);
textSize(20);
textAlign(CENTER,CENTER);
text('Tier '+(i+1),300,i*85+30);
pushMatrix();
translate(370,i*85+30);
scale(1.1+cos(frameCount*3)*0.1);
dice(0,0,i+1);
popMatrix();
pushMatrix();
translate(230,i*85+30,1);
scale(1.1+cos(frameCount*3)*0.1);
clock(0,0,1,i*2+1);
popMatrix();

for(var q = 0; q < 14; q++){

    if(!dictPops[i][q]){
    dictPops[i].push(0);
    }

pushMatrix();
if(dist(msX,msY,40+q*40,i*85+70)<= 15){
    isHover = true;
    cursor(HAND);
    dictPops[i][q] = lerp(dictPops[i][q],1,0.1);
    var t = '';
    //tierStats[i][q]
    for(var i2 in types){
        for(var q2 = 0; q2 < types[i2].length; q2++){
        if(types[i2][q2].name === tierStats[i][q].name){
        t = i2;
        }
        }
    }
    dictThing = makeThing(40+q*40,i*85+70,tierStats[i][q],t);

}else{
dictPops[i][q] = lerp(dictPops[i][q],0,0.1);
}


    translate(40+q*40,i*85+70);
    scale(1+dictPops[i][q]*0.3);

pushMatrix();
var a = tierStats[i][q];

        pushMatrix();
            scale(0.5);
            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();

popMatrix();

popMatrix();



}

}

if(isHover){
    dictAnim = lerp(dictAnim,1,0.1);
}else{
    dictAnim = lerp(dictAnim,0,0.1);
}

if(dictThing){
//dictThing.cardStuff(msX,msY,0.12*dictAnim);
card(1+(0.12*dictAnim),false,dictThing);
dictThing.kill();
}

backButton.draw();

}

if(scene !== 'dict'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'help':
{
if(homeTrans >= 50){

background(255, 30, 10);
pushMatrix();
rotate(15+cos(frameCount*3)*3);
translate(177,-186);
noStroke();
for(var i = 0; i < 20; i++){
    fill(255, (i+5)*6,(i+5)*2);
    rect(-200,0+i*43,800,60);
}
popMatrix();

{
pushMatrix();
stroke(0,0,0);
strokeWeight(8);
fill(74, 176, 217);
scale(1.5);
translate(18,31);

translate(120,140);
rotate(cos(frameCount*3)*2);
translate(-120,-140);

beginShape();
    vertex(128,19);
    vertex(189,38);
    vertex(167,88);
    vertex(197,44);
    vertex(210,54);
    vertex(196,78);
    vertex(210,99);
    vertex(236,83);
    vertex(250,105);
    vertex(257,133);
    vertex(211,163);
    vertex(243,169);
    vertex(228,196);
    vertex(249,205);
    vertex(237,228);
    vertex(182,216);
    vertex(231,242);
    vertex(219,250);
    vertex(197,271);
    vertex(160,254);
    vertex(175,276);
    vertex(129,281);
    vertex(133,294);
    vertex(100,263);
    vertex(91,287);
    vertex(83,261);
    vertex(81,289);
    vertex(47,291);
    vertex(15,277);
    vertex(22,250);
    vertex(-28,250);
    vertex(13,209);
    vertex(-35,225);
    vertex(-48,183);
    vertex(5,169);
    vertex(-41,162);
    vertex(-43,118);
    vertex(15,113);
    vertex(-24,94);
    vertex(27,90);
    vertex(-37,61);
    vertex(-22,50);
    vertex(34,74);
    vertex(2,28);
    vertex(35,7);
    vertex(69,5);
    vertex(81,61);
    vertex(88,8);
    vertex(104,9);
    vertex(101,64);
endShape(CLOSE);
translate(120,150);
rotate(cos(frameCount*4)*-5);
translate(-120,-150);
pushMatrix();
noStroke();
fill(171, 233, 255);
translate(40,94);
scale(0.5);
beginShape();
    vertex(27,148);
    vertex(-9,135);
    vertex(3,83);
    vertex(-16,53);
    vertex(41,89);
    vertex(16,19);
    vertex(44,42);
    vertex(33,-5);
    vertex(68,-15);
    vertex(92,45);
    vertex(100,-12);
    vertex(148,-11);
    vertex(162,60);
    vertex(197,8);
    vertex(236,30);
    vertex(265,27);
    vertex(214,103);
    vertex(272,102);
    vertex(270,127);
    vertex(227,139);
    vertex(264,155);
    vertex(252,190);
    vertex(219,190);
    vertex(229,240);
    vertex(175,227);
    vertex(161,271);
    vertex(119,257);
    vertex(87,283);
    vertex(36,275);
    vertex(53,248);
    vertex(24,266);
    vertex(5,250);
    vertex(18,227);
    vertex(5,204);
    vertex(44,177);
    vertex(-2,181);
    vertex(-2,156);
endShape(CLOSE);
popMatrix();
popMatrix();
}


tutorial.anim = lerp(tutorial.anim,0,0.05);
    pushMatrix();
    translate(190,310);
    scale(2);
    var a = tutorial.anim*2;
    translate(-10,0);
    scale(cos(a),1);
    translate(10,0);
    translate(0,25);
        rotate(-10+cos(frameCount*1.5));
    translate(0,-25);
    if((tutorial.on&&a < 90)||(!tutorial.on&&a > 270)){
    //{

bases.chicken();
pushMatrix();
scale(1.5);
translate(-18,-20);
rotate(-9);
stroke(0,0,0);
strokeWeight(3);


fill(255, 36, 36);
rect(0,0,30,14,4);
arc(15.5,4,30,15,180,360);

fill(247, 247, 247);
strokeWeight(1);
arc(24,11,15,15,162,360);
fill(255, 36, 36);
noStroke();
arc(24,11,8,8,162,360);

stroke(0,0,0);
strokeWeight(2);
fill(247, 247, 247);
rect(18,10.5,25,4,4);

popMatrix();
noStroke();
fill(255, 255, 255);
ellipse(-10,2,15,15);

fill(0,0,0);
ellipse(-2,1,5,10);
fill(245, 245, 245);
//ellipse(-1,-1,1.5,3);

stroke(0,0,0);
strokeWeight(5);
line(-12,-7,1,-4);
strokeWeight(1);
line(-10,9,-14,4);
line(-11,-8,-14,4);
strokeWeight(2);
line(-12,9,1,7);
line(-12,12,1,8);

pushMatrix();
translate(-27,14);
scale(1.2);
rotate(-27);
strokeWeight(2);
stroke(0,0,0);
fill(245, 245, 245);
ellipse(0,0,20,20);
fill(255, 0, 0);
arc(0,0,20,20,180,360);
strokeWeight(2);
line(-9,0,9,0);
fill(209, 209, 209);
ellipse(0,0,6,6);
popMatrix();

    //}
    }else{
    //{


    stroke(0,0,0);
    strokeWeight(5);
    fill(0, 0, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(0, 0, 0);
    ellipse(0,0,50,50);
    fill(0, 0, 0);
    ellipse(22,15,10,15);
    fill(0, 0, 0);
    triangle(15,-6,15,14,35,9);
    pushMatrix();
    scale(1.5);
    translate(-18,-20);
    rotate(-9);
    stroke(0,0,0);
    strokeWeight(3);


    fill(0, 0, 0);
    rect(0,0,30,14,4);
    arc(15.5,4,30,15,180,360);

    stroke(0,0,0);
    strokeWeight(2);
    fill(0, 0, 0);
    rect(18,10.5,25,4,4);
    popMatrix();

    pushMatrix();
    translate(-27,14);
    scale(1.2);
    rotate(-27);
    strokeWeight(2);
    stroke(0,0,0);
    fill(0, 0, 0);
    ellipse(0,0,20,20);
    popMatrix();

    //}
    }
    popMatrix();
pushMatrix();
translate(-230,-30);
scale(1.2);
translate(450,100);
rotate(cos(frameCount*1.5));
translate(-450,-100);

noStroke();
fill(176, 176, 176,200);
pushMatrix();
translate(-9,3);
rotate(cos(frameCount*1.5)*0.3);
{
//U
pushMatrix();
translate(327,64);
scale(0.5);
beginShape();
    vertex(34,21);
    vertex(48,117);
    vertex(89,141);
    vertex(118,146);
    vertex(156,130);
    vertex(178,99);
    vertex(175,16);
    vertex(138,4);
    vertex(135,89);
    vertex(127,103);
    vertex(107,108);
    vertex(88,98);
    vertex(74,12);
endShape(CLOSE);
popMatrix();

//T1
pushMatrix();
translate(274,56);
scale(0.5);
beginShape();
    vertex(39,39);
    vertex(44,81);
    vertex(89,79);
    vertex(95,161);
    vertex(136,146);
    vertex(135,71);
    vertex(175,63);
    vertex(165,22);
endShape(CLOSE);
popMatrix();

//T2
pushMatrix();
translate(382,56);
scale(0.5);
beginShape();
    vertex(39,39);
    vertex(44,81);
    vertex(89,79);
    vertex(95,161);
    vertex(136,146);
    vertex(135,71);
    vertex(175,63);
    vertex(165,22);
endShape(CLOSE);
popMatrix();
//R
pushMatrix();
translate(464,67);
scale(0.5);
beginShape();
    vertex(33,22);
    vertex(36,28);
    vertex(52,26);
    vertex(53,152);
    vertex(89,152);
    vertex(86,89);
    vertex(103,89);
    vertex(124,151);
    vertex(158,140);
    vertex(136,78);
    vertex(152,51);
    vertex(144,9);
    vertex(123,-4);
    vertex(78,-10);
    vertex(48,-3);
    vertex(30,-1);
endShape(CLOSE);
arc(94,37,40,40,-80,120);
popMatrix();
//O
pushMatrix();
translate(427,73);
scale(0.35);
beginShape();
    curveVertex(248,66);
    curveVertex(115,44);
    curveVertex(59,82);
    curveVertex(74,146);
    curveVertex(134,172);
    curveVertex(184,142);
    curveVertex(192,88);
    curveVertex(176,50);
    curveVertex(127,40);
    curveVertex(107,64);
    curveVertex(154,77);
    curveVertex(296,-63);
endShape();
popMatrix();

//I
pushMatrix();
translate(508,67);
scale(0.5);
beginShape();
    vertex(52,14);
    vertex(150,2);
    vertex(149,32);
    vertex(117,36);
    vertex(118,99);
    vertex(149,98);
    vertex(147,128);
    vertex(52,128);
    vertex(52,101);
    vertex(87,94);
    vertex(86,42);
    vertex(52,46);
endShape(CLOSE);
popMatrix();
//L
pushMatrix();
translate(616,62);
scale(0.5);
beginShape();
    vertex(3,33);
    vertex(19,2);
    vertex(61,6);
    vertex(54,117);
    vertex(102,120);
    vertex(108,155);
    vertex(12,153);
    vertex(17,34);
endShape(CLOSE);
popMatrix();
//A
pushMatrix();
translate(554,74);
scale(0.5);
beginShape();
    vertex(54,127);
    vertex(41,104);
    vertex(53,101);
    vertex(74,7);
    vertex(112,7);
    vertex(145,125);
    vertex(115,123);
    vertex(106,106);
    vertex(83,106);
    vertex(74,124);
endShape(CLOSE);
popMatrix();
}
popMatrix();

stroke(20, 40, 255);
strokeWeight(12);
fill(237, 225, 0);
{
//U
pushMatrix();
translate(327,64);
scale(0.5);
beginShape();
    vertex(34,21);
    vertex(48,117);
    vertex(89,141);
    vertex(118,146);
    vertex(156,130);
    vertex(178,99);
    vertex(175,16);
    vertex(138,4);
    vertex(135,89);
    vertex(127,103);
    vertex(107,108);
    vertex(88,98);
    vertex(74,12);
endShape(CLOSE);
popMatrix();

//T1
pushMatrix();
translate(274,56);
scale(0.5);
beginShape();
    vertex(39,39);
    vertex(44,81);
    vertex(89,79);
    vertex(95,161);
    vertex(136,146);
    vertex(135,71);
    vertex(175,63);
    vertex(165,22);
endShape(CLOSE);
popMatrix();

//T2
pushMatrix();
translate(382,56);
scale(0.5);
beginShape();
    vertex(39,39);
    vertex(44,81);
    vertex(89,79);
    vertex(95,161);
    vertex(136,146);
    vertex(135,71);
    vertex(175,63);
    vertex(165,22);
endShape(CLOSE);
popMatrix();
//R
pushMatrix();
translate(464,67);
scale(0.5);
beginShape();
    vertex(33,22);
    vertex(36,28);
    vertex(52,26);
    vertex(53,152);
    vertex(89,152);
    vertex(86,89);
    vertex(103,89);
    vertex(124,151);
    vertex(158,140);
    vertex(136,78);
    vertex(152,51);
    vertex(144,9);
    vertex(123,-4);
    vertex(78,-10);
    vertex(48,-3);
    vertex(30,-1);
endShape(CLOSE);
arc(94,37,40,40,-80,120);
popMatrix();
//O
pushMatrix();
translate(427,73);
scale(0.35);
strokeWeight(12*(0.5/0.35));
beginShape();
    curveVertex(248,66);
    curveVertex(115,44);
    curveVertex(59,82);
    curveVertex(74,146);
    curveVertex(134,172);
    curveVertex(184,142);
    curveVertex(192,88);
    curveVertex(176,50);
    curveVertex(127,40);
    curveVertex(107,64);
    curveVertex(154,77);
    curveVertex(296,-63);
endShape();
popMatrix();
strokeWeight(12);

//I
strokeWeight(12);
pushMatrix();
translate(508,67);
scale(0.5);
beginShape();
    vertex(52,14);
    vertex(150,2);
    vertex(149,32);
    vertex(117,36);
    vertex(118,99);
    vertex(149,98);
    vertex(147,128);
    vertex(52,128);
    vertex(52,101);
    vertex(87,94);
    vertex(86,42);
    vertex(52,46);
endShape(CLOSE);
popMatrix();
//L
pushMatrix();
translate(616,62);
scale(0.5);
beginShape();
    vertex(3,33);
    vertex(19,2);
    vertex(61,6);
    vertex(54,117);
    vertex(102,120);
    vertex(108,155);
    vertex(12,153);
    vertex(17,34);
endShape(CLOSE);
popMatrix();
//A
pushMatrix();
translate(554,74);
scale(0.5);
beginShape();
    vertex(54,127);
    vertex(41,104);
    vertex(53,101);
    vertex(74,7);
    vertex(112,7);
    vertex(145,125);
    vertex(115,123);
    vertex(106,106);
    vertex(83,106);
    vertex(74,124);
endShape(CLOSE);
line(95,57,94,73);
popMatrix();
}
popMatrix();

tutorialToggleButton.draw();
backButton.draw();

}
if(scene !== 'help'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'credits':
{
if(homeTrans >= 50){

background(87, 87, 87);

pushMatrix();
translate((msX-300)*-0.05,(msY-300)*-0.05);
translate(220,300);
scale(10);
// {

stroke(0,0,0);
    strokeWeight(2);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(6,-25);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-19);
    vertex(9,246);
    endShape();
    strokeWeight(5);
    fill(181, 181, 181);
    ellipse(0,0,50,50);
pushMatrix();
translate(-290,-293);
translate(300,300);
scale(0.1);
translate(-300,-300);
noStroke();

var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a5 = 206;
var a6 = 117;
fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape();
beginShape();
vertex(0, 400);
vertex(80, 400);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape();

var a7 = 215;
beginShape();
vertex(0, 200);
vertex(0, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape();
var a8 = 319;
beginShape();
vertex(400, 200);
vertex(400, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape();
//rect(0, 200,400, 80);

fill(50,50,50);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
vertex(400, 400);
vertex(320, 400);
endShape();
popMatrix();

    stroke(0,0,0);
    strokeWeight(5);

    fill(102, 102, 102);
    ellipse(22,15,10,15);
    fill(46, 142, 166);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    //point(-8,-3);
stroke(0,0,0);
strokeWeight(5);

pushMatrix();
translate(-5,-7);

stroke(0,0,0);
strokeWeight(5);
line(17,4,28,3);
line(-6,4,-23,1);

stroke(0,0,0);
strokeWeight(2);
fill(145, 145, 145,200);
fill(100, 217, 125);
ellipse(6,5,20,20);
ellipse(38,3,20,20);
popMatrix();

pushMatrix();
textAlign(CENTER,CENTER);
textSize(2);
fill(0, 0, 0);
rotate(-4);
var a = '';
var a2 = '';
for(var i = 0; i < ackstring.length; i++){
a += ackstring[i]+' ';
if(floor(random(0,10))===1){
a2 += round(random(0,1));
}else{
a2 += ackstring[i];
}
}
ackstring = a2;
text(a,11,-2);
popMatrix();

fill(56, 56, 56);
stroke(0,0,0);
strokeWeight(5);
triangle(15,-6,15,14,35,9);
// }


noStroke();
fill(20, 20, 20, 220);
rect(-100,-150,220,300);

// pushMatrix();
// translate(-5,-7);
// stroke(0,0,0);
// strokeWeight(2);
// fill(0, 255, 13,100);
// ellipse(6,5,20,20);
// ellipse(38,3,20,20);
// popMatrix();
popMatrix();

pushMatrix();
var a = cos(frameCount*4);
var a2 = (abs(a)*0.1+0.1);

translate(300,300);

translate((msX-300)*a2,(msY-300)*a2);

scale(0.3);
scale(1+abs(a*0.1));
rotate(pow(a,3)*13);

translate(-300,-299);
scale(1.5);
// {
stroke(0,0,0);
strokeWeight(20);
//noStroke();
var c = 290;
var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a52 = 1.15;
var a5 = c*a52;//206
if(a5 > 206){
a5 = 206;
}
var a6 = 117;
var a62 = -117+(c*a52)-206;//-117
if(a62 < -117){
    a62 = -117;
}
if(a62 > 0){
    a62 = 0;
}

fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape(CLOSE);
beginShape();
vertex(0-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape(CLOSE);
fill(60,60,60);
var a72 = 0.985;
var a7 = c*a72;//215
if(a7 > 215){
    a7 = 215;
}
beginShape();
vertex(0-37/2, 200);
vertex(0+37/2, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape(CLOSE);
var a8 = 319;
var a82 = 81-(c*a72)+215;
if(a82 > 81){
    a82 = 81;
}
if(a82 < 37/2){
    a82 = 37/2;
}
beginShape();
vertex(400-a82, 200);
var a822 = 400-a82+37;
if(a822 > 400+37/2){
a822 = 400+37/2;
}
vertex(a822, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape(CLOSE);
//rect(0, 200,400, 80);

fill(120,120,120);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
var a22 = c;
var a23 = 240+cos(a+180)*(a22+100);
var a24 = 55+sin(a+180)*(a22+100);
if(a23 >= 400){
    a23 = 400;
    a24 = 400;
}
var a25 = 320+cos(a)*a2+cos(a+180)*a22;
var a26 = 400+sin(a)*a2+sin(a+180)*a22;
if(a25 > 320){
    a25 = 320;
    a26 = 400;
}
vertex(a23,a24);
vertex(a25,a26);
endShape(CLOSE);
//}
popMatrix();

textAlign(CENTER,CENTER);
fill(255, 255, 255);
textSize(35);
text('Made by Ackvonhey',300,75);
textSize(20);
text('August 2023 - 2025',300,120);
textSize(20);
text('Copyright (c) 2025 Ackvonhey (MIT License)',300,485);

backButton.draw();

}
if(scene !== 'credits'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'getCode':
{
background(255, 255, 255);
if(homeTrans >= 50){
for(var i = 1.5; i < 7; i+=1.5){
noStroke();
fill(255,255,255-i*28);
var w = 850-i*111+cos(frameCount*3)*(10-i)*2;
ellipse(300,300,w,w);
}

    pushMatrix();
    translate(300,300);
    scale(2);
    rotate(cos(frameCount*1.5)*5);
    {
    stroke(0,0,0);
    strokeWeight(5);
    fill(255, 255, 0);
    beginShape();
    vertex(-9,-5);
    vertex(6,-21);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    fill(255, 252, 204);
    ellipse(0,0,50,50);
    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(255, 191, 0);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    stroke(255, 225, 0);
    point(-8,-3);

    var num = 4;
    for(var i = 0; i < 160; i += 160/num){
    pushMatrix();
    rotate(i-60);
    translate(0,-34);
    rotate(0);
    scale(0.3);
    stroke(28, 227, 190, 100);
    strokeWeight(5);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(4,-26);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-15);
    vertex(9,246);
    endShape();
    ellipse(0,0,50,50);
    ellipse(22,15,10,15);
    triangle(15,-6,15,14,35,9);
    popMatrix();
    }
    }
    popMatrix();

    fill(0, 0, 0);
    textAlign(CENTER,CENTER);
    textSize(15);
    text('Before you continue...',300,60);
    textSize(32);
    text('Immortalize your chickens?',300,130);
    textSize(18);
    text('This allows other people to encounter your run\nand contributes to the development of the game,\nso it\'s highly recommended!',300,420);
    textSize(12);
    text('(Even if it wasn\'t a good run)',300,485);

    contTo = 'home';
    contButton.x = 110;
    contButton.draw();
    contButton.x = 490;
    codeButton.draw();
}

if(scene !== 'getCode'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'win':
{
background(255, 0, 0);
if(homeTrans >= 50){

for(var i = 0; i < 8; i+=1){
noStroke();
    var a = abs(i*(255/1.5));
    if(a <= 255){
    fill(255, a, 0);
    }else if(a <= 255*2){
    fill(255-(a-255), 255, 0);
    }else if(a <= 255*3){
    fill(0, 255, a-(255*2));
    }else if(a <= 255*4){
    fill(0, 255-(a-(255*3)), 255);
    }else if(a <= 255*5){
    fill(a-(255*4), 0, 255);
    }
var w = 850-i*111+cos(frameCount*3)*(10-i)*2;
ellipse(300,300,w+cos(frameCount*1.5)*10,w);
}

noStroke();
fill(234, 255, 138,30);
rect(-100,-100,800,800);

    pushMatrix();
    translate(300,300);
    scale(2);
    rotate(cos(frameCount*1.5)*5);
    {

    }
    popMatrix();

    fill(255, 255, 255);
    textAlign(CENTER,CENTER);
    textSize(80);
    pushMatrix();
    translate(300,310);
    scale(sin(frameCount*4)*0.1+1);
    rotate(cos(frameCount*6)*5);
    text('Victory!',0,0);
    popMatrix();

    var max = 10;
for(var i = 0; i < max; i++){
var d = 55;
trophy(i*d+(300-(d/2)*(max-1)),450+cos(frameCount+i*90)*20,1.5,255);
}
    if(teamPic){
        pushMatrix();
        translate(300,120);
        rotate(cos(frameCount*1.5)*5);
        image(teamPic,-100,-100,200,200);
        popMatrix();
    }

  contTo = 'getCode';
  contButton.draw();

  // dev chicken
  pushMatrix();
  translate(240,560);
  translate(0,25);
  rotate(cos(frameCount*1.5)*5);
  translate(0,-25);
  {


stroke(0,0,0);
    strokeWeight(2);
    noFill();
    beginShape();
    vertex(-9,-5);
    vertex(6,-25);
    vertex(-9,-53);
    curveVertex(-10,-29);
    vertex(-21,-19);
    vertex(9,246);
    endShape();
    strokeWeight(5);
    fill(181, 181, 181);
    ellipse(0,0,50,50);
pushMatrix();
translate(-290,-293);
translate(300,300);
scale(0.1);
translate(-300,-300);
noStroke();

var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a5 = 206;
var a6 = 117;
fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape();
beginShape();
vertex(0, 400);
vertex(80, 400);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape();

var a7 = 215;
beginShape();
vertex(0, 200);
vertex(0, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape();
var a8 = 319;
beginShape();
vertex(400, 200);
vertex(400, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape();
//rect(0, 200,400, 80);

fill(50,50,50);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
vertex(400, 400);
vertex(320, 400);
endShape();
popMatrix();

    stroke(0,0,0);
    strokeWeight(5);

    fill(227, 0, 0);
    ellipse(22,15,10,15);
    fill(46, 142, 166);
    stroke(0,0,0);
    strokeWeight(5);
    triangle(15,-6,15,14,35,9);
    strokeWeight(7);
    //point(-8,-3);
stroke(0,0,0);
strokeWeight(5);

pushMatrix();
translate(-5,-7);

stroke(0,0,0);
strokeWeight(5);
line(17,4,28,3);
line(-6,4,-23,1);

stroke(0,0,0);
strokeWeight(2);
fill(145, 145, 145,200);
var tilt = 0;
ellipse(6,5,20,20);
ellipse(38,3,20,20);
popMatrix();
fill(255, 149, 0);
stroke(0,0,0);
strokeWeight(5);
triangle(15,-6,15,14,35,9);

  }
  popMatrix();
  infiniteButton.draw();

}

if(scene !== 'win'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'settings':
{
background(186, 160, 160);
if(homeTrans >= 50){
for(var i = 2; i < 8; i+=2){
noStroke();
fill(186-i*10, 160-i*10, 160-i*10);
var w = 653-i*82+cos(frameCount*3)*(10-i)*1.2;
rect(300-w/2,300-w/2,w,w,100);
}



    var settingGears = [
        [300,260,-1.2,1.2],
        [120,100,1.5,1.1],
        [480,100,1,1.25],
        [120,430,1.2,1.2],
        [480,430,-1,1.25],
        ];
    for(var q2 = 0; q2 < settingGears.length; q2++){
    pushMatrix();
    translate(settingGears[q2][0],settingGears[q2][1]);
    scale(settingGears[q2][3]);
    for(var q = 0; q < 2; q++){

    noStroke();
    if(q === 0){
    stroke(0,0,0);
    strokeWeight(14);
    }    
    var num = 6;
    for(var i = 0; i < 360; i+=360/num){
    pushMatrix();
    rotate(i+(frameCount/1.5+abs(cos(((q2*123)+frameCount)/2*5))*15)*settingGears[q2][2]);
    translate(0,-25);
    fill(173, 173, 173);
    rect(-10,-23,20,25);
    popMatrix();
    }

    ellipse(0,0,64,64);
    fill(120, 120, 120);
    stroke(0,0,0);
    strokeWeight(7);
    ellipse(0,0,20,20);
    }
    popMatrix();
    }

    backButton.draw();
    delagButton.draw();
    delag2Button.draw();
    delag3Button.draw();
    delag4Button.draw();

    strokeWeight(7);
    stroke(0,0,0);
    fill(122, 122, 122);
    ellipse(30,30,30,30);
    ellipse(570,30,30,30);
    ellipse(30,570,30,30);
    ellipse(570,570,30,30);
    pushMatrix();
    translate(30,30);
    rotate(14);
    strokeWeight(4);
    line(-5,-5,5,5);
    line(5,-5,-5,5);
    popMatrix();
    pushMatrix();
    translate(570,30);
    rotate(-18);
    strokeWeight(4);
    line(-5,-5,5,5);
    line(5,-5,-5,5);
    popMatrix();
    pushMatrix();
    translate(30,570);
    rotate(-57);
    strokeWeight(4);
    line(-5,-5,5,5);
    line(5,-5,-5,5);
    popMatrix();
    pushMatrix();
    translate(570,570);
    rotate(-4);
    strokeWeight(4);
    line(-5,-5,5,5);
    line(5,-5,-5,5);
    popMatrix();

    if(settingFromGame){
    abandonButton.draw();
    pushMatrix();
    var ax = dictButton.x;
    var ay = dictButton.y;
    dictButton.x = 100;
    dictButton.y = 100;
    dictButton.draw();
    dictButton.x = ax;
    dictButton.y = ay;
    popMatrix();
    }
    if(settingFromGame && tutorial.on){
    abandonButton.draw();
    cancelTutorialButton.draw();
    }

}

if(scene !== 'settings'){
bgImg = get();
}

if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'confirmAbandon':
{
background(0, 0, 0);
fill(255, 255, 255);
textAlign(CENTER,CENTER);
textSize(25);
text('Are you sure that you want to\nabandon your current run?\n\n(You will lose all progress)',300,150);
for(var i = 0; i < 10; i++){
pushMatrix();
translate(0,-i+7);
fill(255,255,255,30);
text('(You will lose all progress)',300,200);
popMatrix();
}

if(msX > 250 && msX < 350 && msY > 500 && msY < 550){
fill(204, 49, 49);
cursor(HAND);
if(clicked){
abandonButton.pop = 1;
abandonButton.offFor = 100;
settingFromGame = false;
chickens = [];
    contraptions = [];
    foods = [];
    myCoops = [];
    myContraptions = [];
    projs = [];
    coops = [];
    todo = [];
    effects = [];
    fightTrans = 1000;
    gFight.start = false;
scene = 'getCode';
}
}else{
fill(255, 56, 56);
}

noStroke();
rect(250,500,100,50,5);

if(msX > 150 && msX < 450 && msY > 300 && msY < 430){
fill(217, 217, 217);
cursor(HAND);
if(clicked){
scene = 'settings';
abandonButton.pop = 1;
abandonButton.offFor = 100;
}
}else{
fill(255, 255, 255);
}
noStroke();
rect(150,300,300,130,5);

fill(255, 255, 255);
textSize(15);
text('Abandon\nRun',300,525);
fill(0, 0, 0);
textSize(60);
text('Go Back',300,365);
}
break;
case 'confirmCancelTutorial':
{
background(99, 99, 99);
fill(255, 255, 255);
textAlign(CENTER,CENTER);
textSize(25);
text('Are you sure that you want to\nturn off the tutorial?\n\n(If you are new, it is recommended)',300,150);

if(msX > 250 && msX < 350 && msY > 500 && msY < 550){
fill(204, 49, 49);
cursor(HAND);
if(clicked){
abandonButton.pop = 1;
abandonButton.offFor = 100;
tutorial.on = false;
tutorial.active = false;
tutorial.num = 0;
scene = 'settings';
}
}else{
fill(255, 56, 56);
}

noStroke();
rect(250,500,100,50,5);

if(msX > 150 && msX < 450 && msY > 300 && msY < 430){
fill(217, 217, 217);
cursor(HAND);
if(clicked){
scene = 'settings';
abandonButton.pop = 1;
abandonButton.offFor = 100;
}
}else{
fill(255, 255, 255);
}
noStroke();
rect(150,300,300,130,5);

fill(255, 255, 255);
textSize(15);
text('Cancel\nTutorial',300,525);
fill(0, 0, 0);
textSize(60);
text('Go Back',300,365);
}
break;
case 'game':
{
background(64, 201, 6);
if(homeTrans >= 50){
pushMatrix();
translate(-140,-500);
scale(1/0.27);
image(bg1,0,0);
popMatrix();
var num = 10;
for(var i = 0; i < num; i++){
var odd = 1;
if(round(i/2) === i/2){
odd = 2;
}
mGrass(300+sin(i*144)*267,300+cos(i*107)*234,1,'grass'+odd);
}
    if(introTurn){
    if(held){
        held = false;
        clicked = false;
        introTurn = false;
    }
    }

// prevent interaction while abilities qued
if(todo.length > 0){
    if(held){
        gFight.timer = 60;
    }
    clicked = false;
    held = false;
}

gold = round(gold);

var foodHighlight = false;
if(m.hold){
    if(m.hold.IDENTIFIER === 'food'){
        var options = m.hold.stats.targets();
        for(var i = 0; i < options.length; i++){
        if(dist(msX,msY,options[i].x,options[i].y)<=options[i].radius){
            foodHighlight = options[i];
        }
        }
        if(foodHighlight){
            foodHighlight.foodHighlight = true;
        }
        if(clicked){
            if(foodHighlight){
            var ob = m.hold;
            if(canPurchase(ob)){
                //println(ob.stats.applied);
            spend(ob.price);
            shop[m.hold.shopPos[0]].data[m.hold.shopPos[1]] = false;
            if(ob.stats.applied){
            ob.stats.applied(ob,foodHighlight);
            }
            lastFoodFunc = ob.stats.applied;
            lastFed = foodHighlight;
            if(foodHighlight.IDENTIFIER === 'chicken'){
            if(tutorial.on && tutorial.num === 10){
            tutorial.active = true;
            tutorial.num++;
            }
            doAbilitiesTurn('chickenFriendEatsFood');
            }
            doAbilityTurnSingle('eatFood',foodHighlight);
            doAbilitiesTurn('friendEatsFood');

            ob.kill();
            m.hold = false;
            clicked = false;
    }else{
    clicked = false;
    ob.bad = 30;
    ob.badMessage = 'not enough moneyz';
    ob.temporaryScale = 0.5;
    coinAnim = {s:1.4,r:0,rs:50};
    }
            }
        }
    }
}

// trash
{

if(msX > 10 && msX < 60 && msY > 25 && msY < 100){
    interacting = true;
    trashAnim = lerp(trashAnim,20,0.1);
    noStroke();
    // fill(255, 255, 255);
    // triangle(50,33,80,35,80,15);
    // rect(78,15,100,50,5);
    // fill(0,0,0);
    // textSize(12);
    // textAlign(CENTER,BASELINE);
    // text("I will send\nyou to "+strikeThrough("jesus"),128,30);
    // textSize(20);
    // pushMatrix();
    // translate(153,57);
    // rotate(-20);
    // translate(-153,-57);
    // fill(140, 140, 140, 200);
    // rect(140,37,36,24,5);
    // fill(255, 0, 0);
    // text("KFC",158,57);
    // popMatrix();
    if(m.hold && (m.hold.IDENTIFIER === 'chicken'||m.hold.IDENTIFIER ==='contraption')){
        if(m.hold.origin){
        m.hold.shakeIntensity = 0;
        m.hold.dir = sin(frameCount*10)*1;
        fill(0,0,0);
    textSize(12);
    textAlign(CENTER,BASELINE);
    text(m.hold.begText,m.hold.x+30,m.hold.y+60);
        }else if(myContraptions.indexOf(m.hold)>=0){

        }else{
        fill(0,0,0);
    textSize(12);
    textAlign(CENTER,BASELINE);
    text("you don't own\nthis "+m.hold.IDENTIFIER,m.hold.x+30,m.hold.y+60);
        }
        if(clicked){
            if(m.hold.origin||myContraptions.indexOf(m.hold)>=0){
                clicked = false;
                scene = 'confirm trash';
            }else{
                m.hold = false;
                clicked = false;
            }
            //m.hold = false;
        }
    }
}else{
    trashAnim = lerp(trashAnim,0,0.1);
}

}

for(var i = 0; i < myCoops.length; i++){
var tc = myCoops[i];
// quad(-130,-70,130,-70,105,-105,-105,-110);
if(msX > tc.x-110 && msX < tc.x + 110 && msY > tc.y-105 && msY < tc.y -70){
tc.highlighted = true;
cursor(HAND);
if(((clicked && m.hold !== tc)||(held && m.hold === false))){
tc.grabPointY = tc.y-msY;
tc.grabPointX = tc.x-msX;
m.hold = tc;
m.hold.type = 'coop';
clicked = false;
m.downPos = {x:msX,y:msY};
}
}else if(m.hold !== tc){
tc.highlighted = false;
}
borderCheckCoop(tc);
}

for(var i = 0; i < myContraptions.length; i++){
for(var q = 0; q < myContraptions.length; q++){
if(myContraptions[i] !== myContraptions[q]){
    pushFrom(myContraptions[i],myContraptions[q],myContraptions[q].radius+myContraptions[i].radius,1);
    borderCheckContraption(myContraptions[q]);
}
}
for(var q = 0; q < myCoops.length; q++){
if(myCoops[q] !== myContraptions[i]){
    pushFrom(myContraptions[i],myCoops[q],100+myContraptions[i].radius,0);
    //borderCheckContraption(myCoops[i]);
}
}
var ob = myContraptions[i];
borderCheckContraption(ob);

}

for(var q = 0; q < myCoops.length; q++){
for(var i = 0; i < myCoops.length; i++){
if(i !== q){
pushFrom(myCoops[i],myCoops[q],200,1);
}
borderCheckCoop(myCoops[i]);
}
}

//drawMyContraptions();
//drawMyCoops();
drawMyStuff();


// shop

fill(0,0,0,100);
noStroke();
rect(10,450,580,140,10);
shopUi.scroll = lerp(shopUi.scroll,shopPage*600,0.2);
var nums = [shopPage,shopPage+1];
if(abs(shopUi.scroll-shopPage*600)>1.5 || rollCount < 100){
    nums = [0,shop.length];
}
for(var q = nums[0]; q < nums[1]; q++){
for(var i = 0; i < shop[q].data.length; i++){
if(shop[q].data[i] || shop[q].data[i] === false){
var item = shop[q].data[i];
var x = 50+i*70+q*600-shopUi.scroll;
if(item){
item.owned = false;
if(m.hold !== item){
//var x = 50+i*70+q*600-shopUi.scroll;
item.tx = x;
item.ty = 550;
try{
item.shopPos = [q,i];
item.draw('shop');
}catch(e){

}
}
}
nest(x,550);

if(item){
if(shop[q].frozens[i]){
noStroke();
fill(0, 230, 255, 100);
rect(x-30,520,60,60,5);
}
var d = 1;
if(item.price || item.price === 0){
d = item.price;
}
coin(x-20,570,0.8,d);
d = 1;
if(item.stats){
d = item.stats.tier;
}
pushMatrix();
dice(x-5,577,d);
popMatrix();
}
}
}
}
for(var i = effects.length-1; i > -1; i--){
    effects[i].draw();
}

// roll
{

stroke(0,0,0);
strokeWeight(5);
if(msX > 20 && msX < 120 && msY > 460 && msY < 490 && !m.hold){
    interacting = true;
cursor(HAND);
    if(clicked && rollCount >= 100){
        if(gold >= 1){
        roll(shopPage,false);
        spend(1);
        }else{
        coinAnim = {s:1.4,r:0,rs:50};
        }
        rollCount = 0;
    }
rollAnim = lerp(rollAnim,10,0.1);
}else{
rollAnim = lerp(rollAnim,0,0.1);
}
if(rollCount < 100){
    rollCount += 4;
    if(rollCount > 100){
        rollCount = 100;
    }
}else{
    rollCount = 100;
}

fill(207-rollAnim*3, 183-rollAnim*3, 0-rollAnim*3);
rect(20-rollAnim/4,460-rollAnim/4,100+rollAnim/2,30+rollAnim/2,5);
noStroke();
fill(0, 0, 0, 100);
rect(20-rollAnim/4,460-rollAnim/4,(100-rollCount)+rollAnim/2,30+rollAnim/2,5);
fill(0,0,0);
textSize(14);
textAlign(CENTER,BASELINE);
text("Roll ($1)",70,480);
dice(20-rollAnim/4,477,tier);
dice(120+rollAnim/4,477,tier);
}

// gold counter
{
pushMatrix();
translate(150,475);
scale(coinAnim.s);
rotate(coinAnim.r+random(-coinAnim.rs,coinAnim.rs));
coinAnim.r = lerp(coinAnim.r,0,0.03);
coinAnim.s = lerp(coinAnim.s,1,0.05);
coinAnim.rs = lerp(coinAnim.rs,0,0.03);
coin(0,0,1+abs(cos(frameCount*0.5345)*0.3),gold);
popMatrix();
}

// life trackers
{
pushMatrix();
translate(193,477);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
heart(0,0,0.12);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(5-record[1]),0,1.5);
popMatrix();

pushMatrix();
translate(236,473);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
trophy(0,0,1);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(record[0]),0,1.5);
popMatrix();

pushMatrix();
translate(278,475);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
clock(0,0,1,round(record[2]));
popMatrix();
}

// power thingy
{
pushMatrix();
translate(350,30);
if(power >= neededPower){
if(myCoops.length < 3){
translate(random(-1,1),random(-1,1));
cursor(HAND);
interacting = true;
if(clicked){
m.hold = false;
clicked = false;
var co = new coop(msX,msY,[]);
myCoops.push(co);
m.hold = co;
co.grabPointY = 100;
co.grabPointX = 0;
power -= neededPower;
neededPower+=25;
}
}
}
powerAnim = lerp(powerAnim,power,0.05);
if(powerAnim > neededPower){
powerAnim = neededPower;
}
scale(1.4+abs(cos(frameCount*0.5345)*0.1));
noStroke();
fill(79, 79, 79,150);
rect(-10,-10,80,23,5);
noStroke();
if(myCoops.length < 3){
fill(0, 217, 18,150);
rect(-10,-10,powerAnim*(80/neededPower),23,5);

for(var i = 1; i < neededPower; i++){
strokeWeight(1);
stroke(0,0,0,50);
line(-10+i*(80/(neededPower)),-9,-10+i*(80/(neededPower)),12);
}
}
noFill();
strokeWeight(3);
stroke(0,0,0);
rect(-10,-10,80,23,5);
fill(0,0,0);
textSize(8);
textAlign(CENTER,BASELINE);
if(myCoops.length < 3){
text('Merge Power:\n'+power+'/'+neededPower,30,-1);
}else{
text('Out of order',30,4);
}
popMatrix();
}

// shop page scroller
{
stroke(0,0,0);
strokeWeight(5);


pushMatrix();
translate(535,475);
scale(1+pageAnim*0.1);
fill(194, 194, 194);
rect(-45,-15,90,30,5);

noStroke();
if(msX > 490 && msX < 580 && msY > 460 && msY < 490){
pageAnim = lerp(pageAnim,1,0.09);
    interacting = true;
cursor(HAND);
if(msX < 535){
fill(219, 219, 219,255*pageAnim);
rect(-45,-15,45,30,5);
if(clicked){
shopPage--;
shopPage = round(shopPage);
if(shopPage < 0){
    shopPage = 0;
}
}
}
if(msX >= 535){
fill(219, 219, 219,255*pageAnim);
rect(0,-15,45,30,5);
if(clicked){
shopPage++;
shopPage = round(shopPage);
if(shopPage >= shop.length){
    shopPage = shop.length-1;
}
}
}
}else{
pageAnim = lerp(pageAnim,0,0.09);
}

stroke(92, 92, 92, 150*pageAnim);
line(0,-12,0,12);

noFill();
stroke(0,0,0);
strokeWeight(5);
rect(-45,-15,90,30,5);

popMatrix();

textSize(14);
fill(0,0,0);
textAlign(CENTER,BASELINE);
text("Page: "+(shopPage+1)+"/"+shop.length,535,480);

}

// freeze
{
if(m.hold){
if(!m.hold.origin&&m.hold.shopPos&&shop[m.hold.shopPos[0]].data[m.hold.shopPos[1]]===m.hold){
stroke(0,0,0);
strokeWeight(5);
var toFreeze = true;
if(shop[m.hold.shopPos[0]].frozens[m.hold.shopPos[1]]){
toFreeze = false;
}
if(msX > 350 && msX < 480 && msY > 460 && msY < 490){
cursor(HAND);
    interacting = true;
    if(clicked){
    shop[m.hold.shopPos[0]].frozens[m.hold.shopPos[1]] = toFreeze;
    }
freezeAnim = lerp(freezeAnim,10,0.1);
}else{
freezeAnim = lerp(freezeAnim,0,0.1);
}

fill(25-freezeAnim*3, 171-freezeAnim*3, 176-freezeAnim*3);
rect(350-freezeAnim/4,460-freezeAnim/4,130+freezeAnim/2,30+freezeAnim/2,5);

fill(0,0,0);
textSize(14);
textAlign(CENTER,BASELINE);
if(toFreeze){
text("Freeze Slot",415,480);
}else{
text("Unfreeze Slot",415,480);
}

}
}
}

// merging toggle
{
noStroke();
fill(171, 171, 171,200);
if(gFight.start !== true){
rect(465,80,130,40,5);
fill(0,0,0);
textSize(13);
textAlign(CENTER,BASELINE);
var a = 'No';
if(merging){
a = 'Yes';
}
text('Merge Chickens:\n'+a,530,95);
}
noStroke();
if(msX > 510 && msX < 550 && msY > 130 && msY < 150){
interacting = true;
cursor(HAND);
mergeAnim[1] = lerp(mergeAnim[1],6,0.25);
if(clicked){
if(merging){
merging = false;
}else{
merging = true;
}
clicked = false;
}
}else{
mergeAnim[1] = lerp(mergeAnim[1],0,0.25);
}
fill(222, 222, 222);
rect(510-mergeAnim[1]/2,130-mergeAnim[1]/4,40+mergeAnim[1],20+mergeAnim[1]/2,8);
if(merging){
noStroke();
fill(0, 255, 21);
mergeAnim[0] = lerp(mergeAnim[0],20,0.2);
}else{
noStroke();
fill(227, 0, 0);
mergeAnim[0] = lerp(mergeAnim[0],0,0.2);
}
rect(513+mergeAnim[0],133,14,14,8);
}

// trash graphics (literally)
{
stroke(0,0,0);
strokeWeight(5);
fill(135, 135, 135);
pushMatrix();
//point(0,0);
translate(0,40);
rotate(-trashAnim);
translate(0,-40);
arc(35,40,50,30,180,360);
line(10,40,60,40);
ellipse(35,25,12,10);
popMatrix();
rect(10,40,50,60,5);
stroke(0,0,0,50);
for(var i = 1; i < 3; i++){
    line(10+i*(50/3),55,10+i*(50/3),85);
}
fill(0,0,0);
textAlign(CENTER,CENTER);
textSize(12);
text('Trash',35,65);
}

// tutorial guide
if(tutorial.on){
stroke(0,0,0);
strokeWeight(5);
fill(97, 213, 255,160);
rect(150,25,150,80,10);
textAlign(CENTER,CENTER);
fill(0,0,0);
textSize(15);
switch(tutorial.num){
case 4:
text('Task:\nBuy a chicken',225,55);
break;
case 10:
text('Task:\nBuy a food',225,55);
break;
case 12:
text('Task:\nFinish the turn',225,55);
break;
case 15:
text('Task: Buy\na contraption',225,55);
break;
case 17:
text('Task:\nTrash something',225,55);
break;
case 19:
text('Task:\nFinish the turn',225,55);
break;
default:
text('Tutorial tasks\nwill be here',225,55);
break;
}
stroke(0,0,0);
strokeWeight(3);
fill(226, 255, 5);
ellipse(225,92,25,25);
fill(0,0,0);
text('?',225,92);
if(dist(msX,msY,225,92)<13){
cursor(HAND);
if(clicked){
tutorial.active = true;
tutorial.num--;
clicked = false;
}
}
}

// settings button
settingsButtonGame.draw();
if(dist(msX,msY,100,60)<=18){
interacting = true;
}

for(var i = chickens.length-1; i > -1; i--){
    if(chickens[i].stats.animImgStatic){
        chickens[i].stats.animImgStatic(chickens[i]);
    }
}
for(var i = 0; i < projs.length; i++){
    projs[i].update();
}
for(var i = chickens.length-1; i > -1; i--){
    if(chickens[i]){
    if(chickens[i].displayed){
    chickens[i].behavior();
    }
    chickens[i].checkStatUp();

    chickens[i].displayed = false;
    }else{
    chickens.splice(i,1);
    }
}

allPrompts(false);

for(var i = foods.length-1; i > -1; i--){
    if(foods[i].shopPos && shop[foods[i].shopPos[0]].data[foods[i].shopPos[1]] === foods[i]){
    foods[i].behavior();
    }
    }

action = function(to){
            to.push(ob);
            shop[ob.shopPos[0]].data[ob.shopPos[1]] = false;
            m.hold = false;
            };

for(var i = contraptions.length-1; i > -1; i--){
    if(contraptions[i]){
    if(contraptions[i].displayed){
    contraptions[i].behavior();
    }
    var ob = contraptions[i];
    if(m.hold === ob){
        if(clicked){
        if(ob.shopPos && shop[ob.shopPos[0]].data[ob.shopPos[1]]===ob){
            if(msY < 450){

            if(canPurchase(ob)){
            purchase(ob,myContraptions,action,ob);
            clicked = false;
            }else{
            ob.bad = 30;
            ob.badMessage = 'not enough moneyz';
            ob.temporaryScale = 0.5;
            coinAnim = {s:1.4,r:0,rs:50};
            }

            }
        }
        }
    }
    if(contraptions[i]){
    contraptions[i].displayed = false;
    }else{
        //println('e');
    }
    }else{
        contraptions.splice(i,1);
    }
}

var takePic = false;
// fight button
{
stroke(0,0,0);
strokeWeight(5);
if(confirmFight === true){
    confirmFight = false;
    gFight.start = true;
    gFight.timer = 0;
    doAbilitiesTurn("endTurn");
    takePic = true;
}
if(msX > 500 && msX < 580 && msY > 20 && msY < 60 && !dim.cur){
cursor(HAND);
    interacting = true;

fightAnim = lerp(fightAnim, 100, 0.05);
if(clicked && !m.hold){
    scene = 'confirm fight';
}
}else{
fightAnim = lerp(fightAnim, 0, 0.05);
}
fill(252, 0, 0,100+fightAnim);
rect(500-fightAnim/12,20-fightAnim/12,80+fightAnim/6,40+fightAnim/6,6);
textSize(20);
fill(0,0,0);
textAlign(CENTER,BASELINE);
text("Fight",540,47);
if(gFight.start === true){
textSize(10);
fill(0, 0, 0);
text("Checking end of\nturn abilities",540+cos(frameCount*4)*6,85);
}
}




if(m.hold){
if(!m.holdTimer){
m.holdTimer = 0;
}
m.holdTimer++;
try{
m.hold.highlighted = true;
cursor('grab');
// if(!m.hold.origin){
if(m.hold.IDENTIFIER === 'chicken'){
m.hold.ty = msY;
m.hold.tx = msX;
m.hold.draw(m.hold.pos);
}else if(m.hold.IDENTIFIER === 'coop'){
m.hold.ty = msY+m.hold.grabPointY;
m.hold.tx = msX+m.hold.grabPointX;
m.hold.highlighted = true;
for(var i = 0; i < myCoops.length; i++){
if(myCoops[i] !== m.hold){
    pushFrom(m.hold,myCoops[i],200,1);
    borderCheckCoop(myCoops[i]);
}
}
for(var q = 0; q < myCoops.length; q++){
for(var i = 0; i < myContraptions.length; i++){
    pushFrom(myContraptions[i],myCoops[q],100+myContraptions[i].radius,0);
    borderCheckContraption(myContraptions[i]);
}
}

borderCheckCoop(m.hold);
}else if(m.hold.IDENTIFIER==='contraption'){
m.hold.ty = msY+m.hold.grabPointY;
m.hold.tx = msX+m.hold.grabPointX;
if(myContraptions.indexOf(m.hold)<=-1){
m.hold.draw(m.hold.pos);
}
for(var i = 0; i < myContraptions.length; i++){
if(myContraptions[i] !== m.hold){
    pushFrom(m.hold,myContraptions[i],myContraptions[i].radius+m.hold.radius,1);
    borderCheckContraption(myContraptions[i]);
}
}
for(var i = 0; i < myCoops.length; i++){
if(myCoops[i] !== m.hold){
    pushFrom(m.hold,myCoops[i],100+m.hold.radius,0);
    //borderCheckContraption(myCoops[i]);
}
}
borderCheckContraption(m.hold);
}else if(m.hold.IDENTIFIER==='food'){
m.hold.ty = msY+m.hold.grabPointY;
m.hold.tx = msX+m.hold.grabPointX;
m.hold.draw(m.hold.pos);
}
// }
}catch(e){

}
}else{
m.holdTimer = 0;
}

if(didMouseMove()){

    mouseMoved = true;
}else{
    mouseMoved = false;
}
if((clicked)&&mouseMoved){
if(m.hold.IDENTIFIER === 'coop'){
    m.hold.tx = m.hold.x;
    m.hold.ty = m.hold.y;
}
m.hold = false;
}

if(clicked === true){
    stopHold = false;
}
if(gFight.clearTimer > 60){
clearPrompts();
gFight.clearTimer = -1;
}else if(gFight.clearTimer >= 0){
gFight.clearTimer++;
}

if(todo.length > 0){
if(gFight.timer > 60){
turn();
gFight.timer = 0;
gFight.clearTimer = 0;
}else{
gFight.timer++;
}
}

fightTrans++;
if(gFight.start === true && todo.length <= 0){
if(gFight.timer > 60){
initFight(); 
gFight.start = false;
gFight.timer = 0;
}else{
gFight.timer++;
}
}

if(takePic){
teamPic = get();
}

if(introTurn){

}else{

    if(introAnim < 800){
    introAnim = pow(introAnim+2,1.05);
    }
}

if(introAnim < 800){
    pushMatrix();
    translate(introAnim,0);
    noStroke();
    fill(128, 128, 128,180);
    rect(-5,-5,610,610);
    fill(128, 128, 128,200);
    rect(100,110,400,70,4);
    fill(255, 255, 255);
    textAlign(CENTER,CENTER);
    textSize(30);
    text('Turn '+record[2]+'!',300,140);
    textSize(15);
    text('Click to continue',300,170);
    if(record[2] <= 11 && record[2]/2 !== round(record[2]/2)){
    fill(128, 128, 128,200);
    rect(100,180,400,60,4);
    fill(255, 255, 255);
    textAlign(CENTER,CENTER);
    textSize(25);
    text('Tier    Unlocked',300,210);
    pushMatrix();
    translate(270,210);
    scale(1.9);
    dice(0,0,tier);
    popMatrix();

    for(var i = 0; i < tierStats[tier-1].length; i++){
        var a = tierStats[tier-1][i];
        var r = (360/tierStats[tier-1].length)*i+frameCount/4;
        if(a.img){
            pushMatrix();
            translate(300+cos(r)*130,400+sin(r)*130);
            scale(0.8);

            if(a.animImgBehind){
                a.animImgBehind(a);
            }
        pushMatrix();
        scale(1/2);
        translate(-300,-300);
        image(a.img,0,0);
         popMatrix();
            if(a.animImg){
                a.animImg(a);
            }
            popMatrix();
        }
    }

    }
    popMatrix();
}
}

if(scene !== 'game'){
bgImg = get();
}else{
image(bgImg,0-pow(fightTrans,2),0);
}


if(homeTrans < 50){
background(255, 255, 255);
image(bgImg,0,0);
}
if(homeTrans < 100){
doTransition(homeTrans);
}
homeTrans++;

}
break;
case 'confirm trash':
{
background(0,0,0);
noStroke();
image(bgImg,0,0);
fill(0,0,0,200);
rect(-10,-10,width+20,height+20);
textAlign(CENTER,BASELINE);
fill(255, 255, 255);
textSize(25);
text("Send this "+m.hold.IDENTIFIER+" to "+(m.hold.deathLocationText||strikeThrough("Jesus")+" KFC")+"?",300,150);
m.hold.px = 300;
m.hold.py = 300;
m.hold.x = 300;
m.hold.y = 300;
m.hold.noStatsShow = true;
m.hold.draw(m.hold.pos);
m.hold.sellValue = m.hold.lvl;
if(dist(msX,msY,m.hold.x,m.hold.y)<= m.hold.stats.size*25){
                if(!m.hold.inTrashMouseAnim){
               m.hold.inTrashMouseAnim = 1;
                }
                m.hold.inTrashMouseAnim = lerp(m.hold.inTrashMouseAnim,1.12,0.15);
                card(m.hold.inTrashMouseAnim,true,m.hold);
            }else{
             m.hold.inTrashMouseAnim = 1;   
            }
stroke(0,0,0);
strokeWeight(5);
m.hold.dir = 1;
if(msX > 100 && msX < 250 && msY > 480 && msY < 560){
cursor(HAND);
fill(166, 166, 166);
m.hold.shakeIntensity = 0;
m.hold.dir = sin(frameCount*20)*1.3;
if(clicked){
    doAbilityTurnSingle('trashed',m.hold);
    if(m.hold.sellValue){
    gold += m.hold.sellValue;
    coinAnim = {s:1.4,r:-360,rs:0};
    }
    m.hold.x = 0;
    m.hold.y = 0;
    switch(m.hold.IDENTIFIER){
    case 'chicken':
    killChicken(m.hold);
    break;
    case 'contraption':
    killContraption(m.hold);
    break;
    }
    m.hold = false;
    scene = 'game';
    clicked = false;
    if(tutorial.on && tutorial.num === 17){
    tutorial.active = true;
    tutorial.num++;
    }
}
}else{
fill(230, 230, 230);
}
rect(100,480,150,80,10);
if(msX > 350 && msX < 500 && msY > 480 && msY < 560){
cursor(HAND);
fill(166, 166, 166);
m.hold.shakeIntensity = 20;
m.hold.shakeRad = 15;
if(clicked){
    scene = 'game';
    clicked = false;
}
}else{
fill(230, 230, 230);
}
rect(350,480,150,80,10);

fill(0,0,0);
textSize(16);
textAlign(CENTER,BASELINE);
text("¡Sí! (yeah)\n(+"+m.hold.sellValue+" gold)",175,520);
text("¡No!",425,520);
}
break;
case 'confirm fight':
{
background(0,0,0);
noStroke();
image(bgImg,0,0);
fill(0,0,0,200);
rect(-10,-10,width+20,height+20);
textAlign(CENTER,BASELINE);
fill(255, 255, 255);
textSize(25);
if(gold > 0){
text("End the turn with\n\n"+''+"\n\nremaining gold?\n\nGold will be reset next turn\n(You will lose this gold)",300,150);
coin(300,200,2.4,gold);
}else{
text("End the turn?",300,250);
}

stroke(0,0,0);
strokeWeight(5);
if(msX > 100 && msX < 250 && msY > 480 && msY < 560){
cursor(HAND);
fill(166, 166, 166);
if(clicked){
    scene = 'game';
    clicked = false;
    confirmFight = true;
}
}else{
fill(230, 230, 230);
}
rect(100,480,150,80,10);
if(msX > 350 && msX < 500 && msY > 480 && msY < 560){
cursor(HAND);
fill(166, 166, 166);
if(clicked){
    scene = 'game';
    clicked = false;
}
}else{
fill(230, 230, 230);
}
rect(350,480,150,80,10);

fill(0,0,0);
textSize(16);
textAlign(CENTER,BASELINE);
text("Yes",175,525);
text("No",425,525);
}
break;
case 'loadAssets':
{
    var catcher = 0;
    try {
    //chickensLoaded = 0;
    //curTypeLoadNum = 0;
    var initiated = false;
    var toRepeat = loadPerFrameGrass;
    if(curTypeLoadNum < sTypes.length){
    toRepeat = loadPerFrameChicken;
    }
    for(var repeat = 0; repeat < toRepeat; repeat++){
    if(curTypeLoadNum < sTypes.length){

        // load chickens
        // chicken images loading
        var i = chickensLoaded;
        var q = curTypeLoadNum;
    /*
for(var q = 0; q < sTypes.length; q++){
for(var i = -1; i < types[sTypes[q]].length; i++){
*/
pushMatrix();

translate(300,300);
if(types[sTypes[q]][i]){
scale(types[sTypes[q]][i].size);
}
scale(2);
background(255,255,255);
background(255,255,255,0);

    // base IMG

    if(i > -1){
    if(types[sTypes[q]][i].loadImgBehind){
    types[sTypes[q]][i].loadImgBehind();
    }
    }
    if(!(i > -1 && types[sTypes[q]][i].noBase)){
    bases[sTypes[q]]();
    }

    if(i > -1){
    types[sTypes[q]][i].loadImg();
    types[sTypes[q]][i].img = get();
    }else{
    stats[sTypes[q]]["Boring "+[sTypes[q]]] = {};
    stats[sTypes[q]]["Boring "+[sTypes[q]]].img = get();
    }

popMatrix();
/*
}
}
*/
        chickensLoaded++;
        if(chickensLoaded >= types[sTypes[curTypeLoadNum]].length){      
        chickensLoaded = -1;
        curTypeLoadNum++;

        }
        }else{
    if(grassLoads[0].length < numGrassFrames && !delag){
       grassLoad1(grassLoads[0].length);
    }else{
         if(grassLoads[1].length < numGrassFrames && !delag){
       grassLoad2(grassLoads[1].length);
    }else{
        if(!initiated){


        initiated = true;
        repeat = Infinity;
        }
        }
    } 
    }
    }
    var progress = 0+grassLoads[0].length+grassLoads[1].length;
    for(var q = 0; q < sTypes.length; q++){
    if(curTypeLoadNum > q){
    progress += types[sTypes[q]].length;
    }
    }
    progress += chickensLoaded;
    var totalLoads = 0;
    if(!delag){
    totalLoads += (numGrassFrames*2);
    }
    for(var q = 0; q < sTypes.length; q++){
    totalLoads += types[sTypes[q]].length;
    }
    fill(54, 54, 54,100);
    noStroke();
    rect(-100,-100,width+200,height+200);
    fill(0, 0, 0,150);
    noStroke();
    rect(-100,85,width+200,100);
    textAlign(CENTER,BASELINE);
    fill(255, 255, 255);
    textSize(40);
    text('LOADING ('+(progress+1)+'/'+totalLoads+')',300,150);

    noStroke();
    fill(61, 61, 61);
    rect(50,460,500,60,10);
    fill(255, 255, 255);
    rect(50,460,500*(progress/totalLoads),60,10);
    noFill();
    stroke(0,0,0);
    strokeWeight(5);
    rect(50,460,500,60,10);
    if(initiated){
        goHome();
    }
    } catch(e){
    println('Error with loading: '+e+'\nPlease restart program');

    }
}
break;
case 'fight':
{
background(0,0,0);

// background

background(64, 201, 6);


// buttons
if(fightTrans > 130){
if(msX > 240 && msX < 360 && msY > 60 && msY < 76){
    interacting = true;
    cursor(HAND);
if(clicked){
clicked = false;
if(aCam.on === false){
    aCam.on = true;
}else{
    aCam.on = false;
}
}
}
if(msX > 240-180 && msX < 360-180 && msY > 60 && msY < 76){
    interacting = true;
    cursor(HAND);
if(clicked){
clicked = false;
if(doAuto === false){
    doAuto = true;
}else{
    doAuto = false;
}
}
}
if(msX > 230+180 && msX < 370+180 && msY > 60 && msY < 76){
    interacting = true;
    cursor(HAND);
if(clicked){
clicked = false;
if(msX > 300+180){
if(speed < 4){
    speed++;
}else{
    speed = 0;
}
}else{
if(speed > 0){
    speed--;
}else{
    speed = 4;
}
}
}
}
}
pushMatrix();
scale(cam.zoom);
translate(cam.x,cam.y);
var rm = {x:-10000,y:-10000};
//translate(-msX,-300);
if(fightTrans > 130){
if(!cam.zoom || !cam.y || !cam.x){
    cam.zoom = 1;
    cam.y = 0;
    cam.x = 0;
}
if(aCam.on){
cam.zoom = lerp(cam.zoom, aCam.zoom, 0.2);
cam.x = lerp(cam.x, aCam.x, 0.5);
cam.y = lerp(cam.y, aCam.y, 0.2);
}else{
cam.zoom = lerp(cam.zoom, cam.toZoom, 0.1);
cam.x = lerp(cam.x, -msX+(cam.zoom-1)*-(600), 0.3);
cam.y = lerp(cam.y, -(380)+(cam.zoom-1)*-(600), 0.06);
}
rm = aMouse();
}else{
cam.zoom = lerp(cam.zoom, 0.5, 0.04);
cam.x = lerp(cam.x, 0, 0.06);
cam.y = lerp(cam.y, 0, 0.06);
}

//println(rm.x+' , '+rm.y);

// background
pushMatrix();
translate(-450,-450);
scale(1/0.27);
image(bg1,0,0);
popMatrix();
var num = 10;
for(var i = 0; i < num; i++){
var odd = 1;
if(round(i/2) === i/2){
odd = 2;
}
mGrass(600+sin(i*209)*600,600+cos(i*43)*300,1,'grass'+odd);

}
// {
pushMatrix();
scale(7/6);
scale(2);
translate(-43,0);
image(bFence1,0,0,300,300);
image(bFence2,300,0,300,300);
image(bFence3,300,300,300,300);
image(bFence4,0,300,300,300);
popMatrix();
// }

stroke(171, 120, 38,200);
strokeWeight(12);
line(600,400,600,950);

// stroke(255, 0, 0);
// strokeWeight(5);
// noFill();
// rect(0,375,1200,600);

// background

if(clicked){
    if(fightTrans > 130){
        turn();
        lastWent = 0;
    }else{
        fightTrans = 140;
    }
}else{
    if(doAuto){
    if(fightTrans > 130 && projs.length <= 0 && !mouseIsPressed){
        lastWent+=speed;
        if(lastWent >= 60){
        lastWent = 0;
        turn();
        }
    }
    }
}
for(var i = 0; i < 2; i++){
    var left = [];
    var down = [];
    for(var q = 0; q < teams[i].length; q++){
    left.push(teams[i][q]);
    }
    while(left.length > 0){
    var index = 0;
    for(var q = 0; q < left.length; q++){
    if(left[q].id.y < left[index].id.y){
    index = q;
    }
    }
    down.push(left[index]);
    left.splice(index,1);
    }
    for(var q = 0; q < down.length; q++){
    if(down[q].id.IDENTIFIER === 'coop'){
    down[q].id.dir = 1-(2*i);
    down[q].id.draw();
    }else{

    down[q].id.draw();
    }
    }
}

var topCard = false;
for(var i = 0; i < 2; i++){
    if(teams[i]){

    for(var q = 0; q < teams[i].length; q++){

        switch(teams[i][q].id.IDENTIFIER){
        case 'coop':
        var theCoop = teams[i][q].id;
        theCoop.dir = 1-(2*i);
        //theCoop.draw();

        for(var q2 = 0; q2 < theCoop.c.length; q2++){
            if(theCoop.c[q2]){
            physics(theCoop.c[q2]);
            theCoop.c[q2].pos = 'battle';
            }
            if(dist(rm.x,rm.y,theCoop.c[q2].x,theCoop.c[q2].y)<= 25){
                if(!theCoop.c[q2].inBattleMouseAnim){
                theCoop.c[q2].inBattleMouseAnim = 1;
                }
                theCoop.c[q2].inBattleMouseAnim = lerp(theCoop.c[q2].inBattleMouseAnim,1.12,0.15);
                card(theCoop.c[q2].inBattleMouseAnim,true,theCoop.c[q2]);
                topCard = theCoop.c[q2];
            }else{
             theCoop.c[q2].inBattleMouseAnim = 1;   
            }
        }
        break;
        case 'contraption':
        var theCon = teams[i][q].id;

        theCon.dir = 1-(2*i);

        //theCon.draw();
            physics(theCon);
            theCon.pos = 'battle';

            if(dist(rm.x,rm.y,theCon.x,theCon.y)<=(25*theCon.stats.size)*theCon.nScale){
                if(!theCon.inBattleMouseAnim){
                theCon.inBattleMouseAnim = 1;
                }
                theCon.inBattleMouseAnim = lerp(theCon.inBattleMouseAnim,1.12,0.15);
                card(theCon.inBattleMouseAnim,true,theCon);
                topCard = theCon;
            }else{
             theCon.inBattleMouseAnim = 1;   
            }

        break;
        }

    }
    }
}

var n = 20;
    var n2  = 10;
for(var i = 0; i < attackPaths.length; i++){
    strokeWeight(5);

    stroke(255+sin(frameCount*n2)*n - n, n+sin(frameCount*n2)*n, n+sin(frameCount*n2)*n);
    noFill();
    line(attackPaths[i][0],attackPaths[i][1],attackPaths[i][2],attackPaths[i][3]);
    line(attackPaths[i][2],attackPaths[i][3],attackPaths[i][2]+cos(attackPaths[i][4]+135)*15,attackPaths[i][3]+sin(attackPaths[i][4]+135)*15);
    line(attackPaths[i][2],attackPaths[i][3],attackPaths[i][2]+cos(attackPaths[i][4]-135)*15,attackPaths[i][3]+sin(attackPaths[i][4]-135)*15);
}

attackPaths = [];
for(var i = 0; i < projs.length; i++){
    projs[i].update();
}
for(var i = effects.length-1; i > -1; i--){
    effects[i].draw();
}

var autoTarg = false;
// trigger explanations
autoTarg = allPrompts(true);


if(fightTrans > 130){
}else{
for(var i = 0; i < 10; i++){
var w = random(15,30);
stroke(205+R(50),0+R(50),0+R(50));
strokeWeight(w);
line(600+R(40),-620*(0.5/cam.zoom),600+R(40),620/cam.zoom);
}
noStroke();
fill(0,0,0,200);
rect(450,600,280,150);
fill(255, 0, 0);
textSize(80);
textAlign(CENTER,BASELINE);
text("V.S.",600,700);
}


popMatrix();


if(autoTarg){
aCam.x = -autoTarg.x+300;
aCam.y = -autoTarg.y+300;
aCam.zoom = 1;
}else{
aCam.x = 0;
aCam.y = 0;
aCam.zoom = 0.5; 
}

if(fightTrans > 130){

tNameAnim = lerp(tNameAnim,1,0.1);

fill(200, 0, 0);
textSize(30);
textAlign(CENTER,BASELINE);
if(fightTrans > 130){
if(todo.length > 0){
text('Next step: ability',300,40);
}else{
if(fightStage !== 'summary'){
text('Next step: '+resumeFightStage,300,40);
}else{
text('Next step: '+fightStage,300,40);
}
}
}

stroke(0,0,0);
strokeWeight(2);
fill(255, 132, 0);
rect(230,57,140,20,5);
rect(50,57,140,20,5);
rect(410,57,140,20,5);
fill(0, 0, 0);
textAlign(CENTER,BASELINE);
if(tutorial.on){
textSize(15);
text('Move mouse and scroll to operate camera\nClick to do a combat step (automatic)',300,495-abs(cos(frameCount*3))*14);
}

textSize(10);
if(msX > 240 && msX < 360 && msY > 60 && msY < 76){
cursor(HAND);
textSize(11);
}
text('Auto camera: '+boolToEnglish(aCam.on),300,70);

textSize(10);
if(msX > 240-180 && msX < 360-180 && msY > 60 && msY < 76){
cursor(HAND);
textSize(11);
}
text('Auto play: '+boolToEnglish(doAuto),120,70);

textSize(10);
if(msX > 410 && msX < 370+180 && msY > 60 && msY < 76){
cursor(HAND);
textSize(11);
}
text('Speed: '+speed,480,70);
if(msX > 410 && msX < 370+180 && msY > 60 && msY < 76){
noStroke();
fill(128, 128, 128,100);
if(msX > 300+180){

rect(300+180,57,70,20,5);
}else{
rect(230+180,57,70,20,5);
}
}

// textSize(10);
// text('Click here to change it',300,83);

if(topCard && topCard.inBattleMouseAnim > 1.11){
    topCard.cardStuff(10,10,0.12*((topCard.inBattleMouseAnim-1.11)/0.01));
}

}

var sums = [0,0];
forEachChickenInTeam(0,function(e){
if(e.dHealth > 0){
sums[0] += e.dHealth;
}
});
forEachChickenInTeam(1,function(e){
if(e.dHealth > 0){
sums[1] += e.dHealth;
}
});

for(var i = 0; i < 2; i++){
if(sums[i] > teamTotals[i]){
teamTotals[i] = sums[i];
}
sums[i] = round(sums[i]);
teamTotals[i] = round(teamTotals[i]);
}

noStroke();
fill(255, 0, 0);
rect(10,565,285,25,5);
rect(305,565,285,25,5);
fill(11, 224, 0);
rect(10,565,(285/teamTotals[0])*sums[0],25,5);
rect(305,565,(285/teamTotals[1])*sums[1],25,5);
stroke(0,0,0);
strokeWeight(5);
noFill();
rect(10,565,285,25,5);
rect(305,565,285,25,5);

pushMatrix();
translate(0,(1-tNameAnim)*-480);
noStroke();
fill(207, 207, 207,200);
rect(10,530,285,25,5);
rect(305,530,285,25,5);
fill(0,0,0);
textAlign(LEFT,CENTER);
textSize(15);
text(tNames[0],20,530+25/2);
text(tNames[1],315,530+25/2);

pushMatrix();
translate(73,200);
scale(0.72);
pushMatrix();
translate(193,477);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
heart(0,0,0.12);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(5-record[1]),0,1.5);
popMatrix();
pushMatrix();
translate(236,473);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
trophy(0,0,1);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(record[0]),0,1.5);
popMatrix();
pushMatrix();
translate(278,475);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
clock(0,0,1,round(record[2]));
popMatrix();
popMatrix();

pushMatrix();
translate(73+295,200);
scale(0.72);
pushMatrix();
translate(193,477);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
heart(0,0,0.12);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(5-tRecord[1]),0,1.5);
popMatrix();
pushMatrix();
translate(236,473);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
trophy(0,0,1);
textAlign(CENTER,BASELINE);
fill(0,0,0);
textSize(12);
text(round(tRecord[0]),0,1.5);
popMatrix();
pushMatrix();
translate(278,475);
scale(1.2+abs(cos(frameCount*0.5345)*0.3));
clock(0,0,1,round(tRecord[2]));
popMatrix();
popMatrix();

popMatrix();


fill(0,0,0);
textAlign(CENTER,CENTER);
textSize(15);
text(sums[0]+' / '+teamTotals[0],10+285/2,565+25/2);
text(sums[1]+' / '+teamTotals[1],305+285/2,565+25/2);

fightTrans++;

if(scene !== 'fight'){
bgImg = get();
//initGame();
sumTrans = 0;
}else{
image(bgImg,0-pow(fightTrans,2),0);
}
}
break;
case 'loss':
{
background(255, 255, 255);
image(bgImg,0,0);
noStroke();
fill(0,0,0,180+sumTrans*(40/180));
rect(-100,-100,1000,1000);
textAlign(CENTER,BASELINE);
fill(240, 0, 0);
textSize(50);
text('Game Over...'.substring(0,round(12*(sumTrans/180))),300,200);
sumTrans = lerp(sumTrans,180,0.05);

// stuff
{

var max = 5;
for(var i = 0; i < max; i++){
var d = 50;
var a = 100;
heart(i*d+(300-(d/2)*(max-1)),470,0.2,a);
}
var max = 10;
for(var i = 0; i < max; i++){
var d = 55;
var a = 100;
if(record[0] > i){
a = 255;
}
trophy(i*d+(300-(d/2)*(max-1)),380,1.5,a);
}

clock(300,550,2,record[2]);
}

if(clicked){
sumTrans = 180;
contTo = 'getCode';
}

pushMatrix();
translate(contButton.x,contButton.y);
scale(sumTrans/180);
translate(-contButton.x,-contButton.y);
contButton.draw();
popMatrix();
}
break;
case 'summary':
{
background(255, 255, 255);
image(bgImg,0,0);
noStroke();
fill(0,0,0,sumTrans);
rect(-100,-100,1000,1000);
textAlign(CENTER,BASELINE);
fill(255, 255, 255);
textSize(40);
text('Summary'.substring(0,round(7*(sumTrans/180))),300,120);
if(sumTrans >= 178){
sumTrans2 = lerp(sumTrans2, 100, 0.08);
}else{
sumTrans2 = 0;
}
if(sumTrans2 >= 98){
sumTrans3 = lerp(sumTrans3, 255, 0.08);
}else{
sumTrans3 = 0;
}
pushMatrix();
if(sumTrans2){
var n = 255*(sumTrans2/100);
var n2 = 'HUH';
if(battleResults.win === true){
fill(255, 217, 0, n);
n2 = 'WIN';
}
if(battleResults.win === 'tie'){
fill(74, 231, 255, n);
n2 = 'DRAW';
}
if(battleResults.win === false){
fill(217, 0, 0, n);
n2 = 'LOSS';
}
translate(300,280);
scale(((1-(sumTrans2/100))*5)+1);
textSize(80);
text(n2,0,0);
}
popMatrix();

var max = round(10*(sumTrans/180))-5;
for(var i = 0; i < max; i++){
var d = 50;
var a = 100;
if(5-(record[1]) > i){
a = 255;
}
if(5-(record[1]) === i+1){
if(battleResults.win === false){
a = 255-sumTrans3;
if(a < 100){
a = 100;
}
}
}
heart(i*d+(300-(d/2)*(max-1)),470,0.2,a);
}
var max = round(20*(sumTrans/180))-10;
for(var i = 0; i < max; i++){
var d = 55;
var a = 100;
if(record[0] > i){
a = 255;
}
if(record[0] === i){
if(battleResults.win === true){
a = sumTrans3;
if(a < 100){
a = 100;
}
}
}
trophy(i*d+(300-(d/2)*(max-1)),380,1.5,a);
}

clock(300,550,2*(sumTrans/180),record[2]);

sumTrans = lerp(sumTrans, 180, 0.05);

if(clicked){
if(sumTrans < 178){
sumTrans = 178;
}else if(sumTrans2 < 98){
sumTrans2 = 98;
}else if(sumTrans3 < 250){
sumTrans3 = 255;
}else{
switch(battleResults.win){
case true:
record[0]++;
record[0] = round(record[0]);
break;
case false:
record[1]++;
record[1] = round(record[1]);
break;
default:
break;
}
record[2]++;
record[2] = round(record[2]);
if(record[1] >= 5){
// loss
scene = 'loss';
sumTrans = 0;
}else if(record[0] >= 10 && !infiniteRun){
// win
bgImg = get();
scene = 'win';
homeTrans = 0;
}else{
bgImg = get();
initGame();
}

}
}
}
break;
}



if(tutorial.on && tutorial.active && (scene === 'game' || scene === 'fight')){
if(tutorial.scenes[tutorial.num]){
tutorial.scenes[tutorial.num]();
}
}
tutorial.clicked = false;


// thumbnail
if(doThumbnail){
if(clicked){
    doThumbnail = false;
}

//{

background(102, 255, 212);
for(var i = 0; i < 8; i++){
noStroke();
fill(102, 255-i*10, 212);
var w = 600-i*77+(10-i)*2;
ellipse(300,400,w,w);
}
pushMatrix();
translate(0,4);
rotate(-2);
for(var i = 0; i < 40; i+=10){
noStroke();
var a = 84;
fill(255, 38, 38,100);
beginShape();
vertex(-100,10+cos(a*7+180)*6+i);
vertex(-100,110+cos(a*7)*6+i);
vertex(700,110+cos(a*7+90)*6+i);
vertex(700,10+cos(a*7+270)*6+i);
endShape();
}
popMatrix();

pushMatrix();
translate(79,-2);
translate(200,50);
rotate(-5);
translate(-200,-50);
scale(0.8);
//SUPER
// {
stroke(0,0,0);
strokeWeight(25);
fill(255, 64, 64);
pushMatrix();
translate(42,32);
scale(0.4);
beginShape();
    curveVertex(93,61);
    curveVertex(158,-9);
    curveVertex(107,-31);
    curveVertex(63,-21);
    curveVertex(-2,31);
    curveVertex(20,133);
    curveVertex(120,125);
    curveVertex(147,171);
    curveVertex(119,209);
    curveVertex(61,216);
    curveVertex(0,195);
    curveVertex(-5,265);
    curveVertex(77,271);
    curveVertex(159,248);
    curveVertex(204,177);
    curveVertex(168,91);
    curveVertex(119,69);
    curveVertex(65,77);
    curveVertex(84,33);
    curveVertex(154,20);
    curveVertex(159,-8);
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(141,48);
scale(0.4);
beginShape();
    curveVertex(56,-14);
    curveVertex(11,-16);
    curveVertex(-16,68);
    curveVertex(-4,186);
    curveVertex(45,236);
    curveVertex(111,247);
    curveVertex(172,220);
    curveVertex(201,130);
    curveVertex(200,25);
    curveVertex(178,-19);
    curveVertex(145,6);
    curveVertex(145,77);
    curveVertex(132,164);
    curveVertex(99,190);
    curveVertex(64,168);
    curveVertex(52,72);
    curveVertex(52,8);
    curveVertex(46,-14);
    curveVertex(32,-17);
    curveVertex(16,-16);
endShape(CLOSE);
popMatrix();
pushMatrix();
translate(240,59);
scale(0.4);
beginShape();
    curveVertex(45,123);
    curveVertex(9,62);
    curveVertex(27,224);
    curveVertex(70,241);
    curveVertex(96,212);
    curveVertex(81,107);
    curveVertex(172,76);
    curveVertex(184,0);
    curveVertex(121,-49);
    curveVertex(12,-45);
    curveVertex(8,64);
    curveVertex(9,48);
endShape();
popMatrix();
pushMatrix();
translate(332,61);
scale(0.4);
beginShape();
    curveVertex(33,84);
    curveVertex(0,-1);
    curveVertex(15,202);
    curveVertex(147,214);
    curveVertex(150,169);
    curveVertex(76,175);
    curveVertex(66,133);
    curveVertex(144,126);
    curveVertex(141,87);
    curveVertex(61,75);
    curveVertex(55,31);
    curveVertex(163,28);
    curveVertex(153,-24);
    curveVertex(-1,-3);
    curveVertex(-74,162);
endShape();
popMatrix();
pushMatrix();
translate(445,60);
scale(0.4);
beginShape();
    curveVertex(231,48);
    curveVertex(-44,-35);
    curveVertex(-46,208);
    curveVertex(20,234);
    curveVertex(24,135);
    curveVertex(119,216);
    curveVertex(173,192);
    curveVertex(89,99);
    curveVertex(131,44);
    curveVertex(117,-25);
    curveVertex(48,-41);
    curveVertex(-44,-34);
endShape(CLOSE);
popMatrix();

noFill();
strokeWeight(25*0.4);
ellipse(277,68,23,15);
ellipse(455,76,23,20);
// }
popMatrix();
strokeWeight(23);
noFill();
stroke(84, 0, 0);
pushMatrix();
translate(-77,-40);
rotate(3);
scale(1.4);
//CHICKEN
// {
pushMatrix();
translate(86,102);
scale(0.4);
beginShape();
    curveVertex(173,158);
    curveVertex(50,64);
    curveVertex(2,100);
    curveVertex(50,142);
    curveVertex(232,145);
endShape();
popMatrix();
pushMatrix();
translate(119,131);
scale(0.4);
line(0,0,2,70);
line(48,0,50,70);
line(0,35,50,40);
popMatrix();
pushMatrix();
translate(150,131);
scale(0.4);
line(50,0,0,2);
line(50,70,0,70);
line(24,0,25,70);
popMatrix();
pushMatrix();
translate(177,105);
scale(0.4);
beginShape();
    curveVertex(173,220);
    curveVertex(50,65);
    curveVertex(4,107);
    curveVertex(53,130);
    curveVertex(288,59);
endShape();
popMatrix();
pushMatrix();
translate(208,131);
scale(0.4);
line(0,0,2,71);
line(0,35,40,4);
line(0,39,40,67);
popMatrix();
pushMatrix();
translate(234,131);
scale(0.4);
line(0,0,2,70);
line(0,35,38,33);
line(0,0,42,-3);
line(0,68,42,68);
popMatrix();
pushMatrix();
translate(261,131);
scale(0.4);
line(0,0,2,70);
line(48,0,50,70);
line(0,0,50,68);
popMatrix();
// }
popMatrix();
pushMatrix();
rotate(-3);
translate(194,35);
scale(1.43);
// {
pushMatrix();
translate(114,98);
strokeWeight(25*(0.4/0.12));
scale(0.13);
beginShape();
    curveVertex(216,125);
    curveVertex(157,-15);
    curveVertex(8,18);
    curveVertex(-16,221);
    curveVertex(172,253);
    curveVertex(222,150);
    curveVertex(95,152);
    curveVertex(242,235);
endShape();
popMatrix();
strokeWeight(25);
pushMatrix();
translate(155,100);
scale(0.4);
line(0,75,28,-5);
line(56,78,28,-5);
line(0,55,56,55);
popMatrix();
pushMatrix();
translate(189,100);
scale(0.4);
line(0,75,14,0);
line(38,75,14,0);
line(38,75,64,0);
line(81,75,64,0);
popMatrix();
pushMatrix();
translate(234,103);
scale(0.4);
line(0,-5,0,70);
line(-4,35,38,33);
line(0,-5,42,-3);
line(0,70,42,68);
popMatrix();
// }
// GAME
popMatrix();

stroke(0,0,0);
fill(28, 232, 89);
strokeWeight(8);
arc(300,620,800,200,180,360);

for(var i = 0; i < 2; i++){
pushMatrix();
translate(-65,280);
switch(i){
case 0:
stroke(0,0,0);
strokeWeight(5);
fill(255, 140, 0);
break;
case 1:
//noStroke();
scale(0.5);
translate(100,100);
fill(255, 183, 0);
break;
}
beginShape();
    vertex(-20,141);
    vertex(74,54);
    vertex(92,69);
    vertex(172,30);
    vertex(180,38);
    vertex(109,122);
    vertex(82,112);
    vertex(16,202);
endShape(CLOSE);
popMatrix();
}
pushMatrix();
translate(100,300);
scale(1.2);
rotate(-20);
thingImg('chicken','Fire chicken');
popMatrix();


pushMatrix();
translate(120,480);
scale(2);
rotate(-8);
thingImg('contraption','Windmill');
popMatrix();
pushMatrix();
translate(100,530);
scale(1.2);
rotate(-6);
thingImg('chicken','Pope chicken');
popMatrix();
pushMatrix();
translate(200,510);
scale(1.2);
rotate(6);
thingImg('chicken','Mage chicken');
popMatrix();
pushMatrix();
translate(50,560);
scale(1.2);
rotate(-10);
thingImg('chicken','General chicken');
popMatrix();
pushMatrix();
translate(200,550);
scale(1);
rotate(-10);
thingImg('food','Popcorn');
popMatrix();
pushMatrix();
translate(150,540);
scale(1.2);
rotate(3);
thingImg('chicken','Influencer chicken');
popMatrix();
pushMatrix();
translate(170,590);
scale(1);
rotate(-3);
thingImg('contraption','Egg tumbler');
popMatrix();
pushMatrix();
translate(110,590);
scale(0.6);
rotate(-25);
thingImg('food','Melon');
popMatrix();
pushMatrix();
translate(200,560);
rotate(4);
scale(0.1);
// {
stroke(0,0,0);
strokeWeight(20);
//noStroke();
var c = 290;
var a = atan2(55-400,240-400);
var a3 = atan2(0-400,250-80);
var a2 = 281.0748;
// atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2)) = atan2(0-400,250-80)
var a4 = atan2(55-(400+sin(a)*a2),240-(320+cos(a)*a2));
var a52 = 1.15;
var a5 = c*a52;//206
if(a5 > 206){
a5 = 206;
}
var a6 = 117;
var a62 = -117+(c*a52)-206;//-117
if(a62 < -117){
    a62 = -117;
}
if(a62 > 0){
    a62 = 0;
}

fill(0,0,0);
beginShape();
vertex(250, 0);
vertex(170, 0);
vertex(170+cos(a3+180)*a5, 0+sin(a3+180)*a5);
vertex(250+cos(a3+180)*a5, 0+sin(a3+180)*a5);
endShape(CLOSE);
beginShape();
vertex(0-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80-cos(a3)*a62, 400-sin(a3)*a62);
vertex(80+cos(a3)*a6, 400+sin(a3)*a6);
vertex(0+cos(a3)*a6, 400+sin(a3)*a6);
endShape(CLOSE);
fill(60,60,60);
var a72 = 0.985;
var a7 = c*a72;//215
if(a7 > 215){
    a7 = 215;
}
beginShape();
vertex(0-37/2, 200);
vertex(0+37/2, 280);
vertex(a7+37, 280);
vertex(a7, 200);
endShape(CLOSE);
var a8 = 319;
var a82 = 81-(c*a72)+215;
if(a82 > 81){
    a82 = 81;
}
if(a82 < 37/2){
    a82 = 37/2;
}
beginShape();
vertex(400-a82, 200);
var a822 = 400-a82+37;
if(a822 > 400+37/2){
a822 = 400+37/2;
}
vertex(a822, 280);
vertex(a8+37, 280);
vertex(a8, 200);
endShape(CLOSE);
//rect(0, 200,400, 80);

fill(120,120,120);
beginShape();
vertex(320+cos(a)*a2,400+sin(a)*a2);
vertex(240, 55);
var a22 = c;
var a23 = 240+cos(a+180)*(a22+100);
var a24 = 55+sin(a+180)*(a22+100);
if(a23 >= 400){
    a23 = 400;
    a24 = 400;
}
var a25 = 320+cos(a)*a2+cos(a+180)*a22;
var a26 = 400+sin(a)*a2+sin(a+180)*a22;
if(a25 > 320){
    a25 = 320;
    a26 = 400;
}
vertex(a23,a24);
vertex(a25,a26);
endShape(CLOSE);
//}
popMatrix();




pushMatrix();
translate(600,0);
scale(-1,1);

for(var i = 0; i < 2; i++){
pushMatrix();
translate(-60,255);
rotate(10);
switch(i){
case 0:
stroke(0,0,0);
strokeWeight(5);
fill(0, 191, 255);
break;
case 1:
//noStroke();
scale(0.5);
translate(100,100);
fill(133, 214, 255);
break;
}

beginShape();
    vertex(-20,141);
    vertex(74,54);
    vertex(92,69);
    vertex(172,30);
    vertex(180,38);
    vertex(109,122);
    vertex(82,112);
    vertex(16,202);
endShape(CLOSE);
popMatrix();
}
pushMatrix();
translate(100,300);
scale(1.2);
rotate(-20);
thingImg('chicken','Ice chicken');
popMatrix();

pushMatrix();
translate(50,500);
scale(2);
rotate(-6);
thingImg('contraption','Rocket launcher');
popMatrix();
pushMatrix();
translate(100,530);
scale(1.2);
rotate(-6);
thingImg('chicken','Chef chicken');
popMatrix();
pushMatrix();
translate(200,510);
scale(1.2);
rotate(6);
thingImg('chicken','Diver chicken');
popMatrix();
pushMatrix();
translate(50,560);
scale(1.2);
rotate(-10);
thingImg('chicken','Cool chicken');
popMatrix();
pushMatrix();
translate(150,540);
scale(1.2);
rotate(3);
thingImg('chicken','Nurse chicken');
popMatrix();
pushMatrix();
translate(110,575);
scale(0.6);
rotate(20);
thingImg('food','Apple');
popMatrix();
pushMatrix();
translate(210,550);
scale(1.4);
rotate(10);
thingImg('contraption','Smoothie machine');
popMatrix();
pushMatrix();
translate(160,590);
scale(1.4);
rotate(-2);
thingImg('contraption','Hot sauce pump');
popMatrix();

popMatrix();

pushMatrix();
translate(380,330);
scale(2);
rotate(10);
thingImg('food','Pineapple');
popMatrix();
pushMatrix();
translate(300,400);
scale(3);
rotate(-15);
thingImg('chicken','Basic chicken');
popMatrix();
//}
}

manageKeys();
pushedKey = false;
//shiftKey = false;


fill(255, 0, 0);
textSize(10);
textAlign(LEFT,BASELINE);
text('FrameRate: '+round(this.__frameRate*10)/10,500,12);
if(width > 605){
frameRecord.push(this.__frameRate);

if(frameRecord.length > 180){
frameRecord.splice(0,1);
}

noStroke();
fill(217, 217, 217);
rect(605,0,200,600);
stroke(255, 0, 0);
strokeWeight(2);
var last = frameRecord[0];
var amt = 200/frameRecord.length;
for(var i = 0; i < frameRecord.length; i++){
line(605+i*amt,300-last,605+(i+1)*amt,300-frameRecord[i]);
last = frameRecord[i];
}
}
popMatrix();
if(dim.x < 600 || dim.y < 600){
noStroke();
fill(0,0,0,dimScroll.appY);
rect(dim.x-50,0,50,dim.y,10);
fill(0,0,0,dimScroll.appX);
rect(0,0,dim.x,50,10);
// y scroll
if(!m.hold && !clicked&&mouseX > dim.x-50 && mouseIsPressed && dim.cur !== 'x'&&interacting === false){
dimScroll.appY = lerp(dimScroll.appY,100,0.05);
dimScroll.ty = -mouseY*(600/dim.y-1);

held = false;
clicked = false;

dim.cur = 'y';
}else{
dimScroll.appY = lerp(dimScroll.appY,-10,0.05);
}
dimScroll.y = lerp(dimScroll.y,dimScroll.ty,0.1);
// x scroll
if(!m.hold && !clicked&&mouseY < 50 && mouseIsPressed && dim.cur !== 'y'&&interacting === false){
dimScroll.appX = lerp(dimScroll.appX,100,0.05);
dimScroll.tx = -mouseX*(600/dim.x-1);
dim.cur = 'x';
}else{
dimScroll.appX = lerp(dimScroll.appX,-10,0.05);
}
dimScroll.x = lerp(dimScroll.x,dimScroll.tx,0.1);
}
if(!mouseIsPressed){
dim.cur = false;
}

// bob lyon's work around for moving the entire screen with scrolling
if (true) {
        var window = (function(what) { return this[what]; })("window");
        var canvas = window.Processing.instances[0].externals.canvas;

        canvas.onwheel = function(event){
            event.preventDefault();

        };
    }    

} catch(error){
    var giveCode = '[';
    for(var i = 0; i < saveCode.length; i++){
        giveCode += '"'+saveCode[i]+'",';
    }
    giveCode += '],';
    println('Here is your savecode: ');
    println(giveCode);
    println(error);
    println('Whoops, error with program. Resetting turn');
    println('Either something took too long for your computer to run, or I missed a bug in the code');
    initGame();
    gold = 0;
}




}

mouseClicked = function(){
    if(tutorial.active){
    tutorial.clicked = true;
    }
};

mouseScrolled = function(){
    if(scene === 'fight'){
        var ms = mouseScroll/25;
        if(ms > 0){
            if(cam.toZoom+ms<= 1){
                cam.toZoom += ms;
            }else{
                cam.toZoom = 1;
            }
        }
        if(ms < 0){
            if(cam.toZoom+ms>= 0.4/(600/dim.x)){
                cam.toZoom += ms;
            }else{
                cam.toZoom = 0.4/(600/dim.x);
            }
        }
    }
};

      </script>

    <script src="https://cdn.jsdelivr.net/gh/ackvonhuelio/chickenGameCodes/runPJS_onKA.js"></script>
        
   <script>
            function resizeCanvas() {
                let canvas = document.querySelector("canvas");
                if (!canvas) return;

                let scale = Math.min(window.innerWidth / 600, window.innerHeight / 700);
                canvas.style.transform = `scale(${scale})`;
            }
            // setTimeout(() => {
            // resizeCanvas();
            // }, 50);
            window.addEventListener("resize", resizeCanvas);
            window.addEventListener("load", resizeCanvas);
            window.addEventListener("orientationchange", resizeCanvas);

            // Handle weird mobile resizing when tapping
            if (window.visualViewport) {
                window.visualViewport.addEventListener("resize", resizeCanvas);
            }
        </script>
        
</body>

</html>
